window.Handsontable={version:"0.15.0",buildDate:"Fri Jun 19 2015 09:15:37 GMT+0200 (CEST)"},function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Handsontable=e()}(function(){return function i(s,a,l){var u="function"==typeof require&&require,d=JSON.parse('{"zeroclipboard":"ZeroClipboard","copyPaste":"copyPaste","SheetClip":"SheetClip","jsonpatch":"jsonpatch","moment":"moment","numeral":"numeral","pikaday":"Pikaday","autoResize":"autoResize"}')||{};function c(n,e){if(!a[n]){if(!s[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(u)return u(n,!0);if(d[n]&&void 0!==window[d[n]])return window[d[n]];var o=new Error("Cannot find module '"+n+"'");throw o.code="MODULE_NOT_FOUND",o}var r=a[n]={exports:{}};s[n][0].call(r.exports,function(e){var t=s[n][1][e];return c(t||e)},r,r.exports,i,s,a,l)}return a[n].exports}for(var e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,t,n){"use strict";var o,l;window.jQuery&&(window,o=jQuery,l=Handsontable,o.fn.handsontable=function(e){var t,n,o,r,i,s=this.first(),a=s.data("handsontable");if("string"!=typeof e)return i=e||{},a?a.updateSettings(i):(a=new l.Core(s[0],i),s.data("handsontable",a),a.init()),s;if(o=[],1<arguments.length)for(t=1,n=arguments.length;t<n;t++)o.push(arguments[t]);if(a){if(void 0===a[e])throw new Error("Handsontable do not provide action: "+e);r=a[e].apply(a,o),"destroy"===e&&s.removeData()}return r})},{}],2:[function(e,t,n){"use strict";var o,r,i;Object.defineProperties(n,{WalkontableBorder:{get:function(){return s}},__esModule:{value:!0}});var T=(o=e("./../../../dom.js"))&&o.__esModule&&o||{default:o},c=((r=e("./../../../eventManager.js"))&&r.__esModule&&r||{default:r}).eventManager,_=((i=e("./cell/coords.js"))&&i.__esModule&&i||{default:i}).WalkontableCellCoords;function s(t,e){var n;if(e){var r=c(t);this.instance=t,this.settings=e,this.main=document.createElement("div"),(n=this.main.style).position="absolute",n.top=0;for(var o=["top","left","bottom","right","corner"],i=n.left=0;i<5;i++){var s=o[i],a=document.createElement("DIV");a.className="wtBorder "+(this.settings.className||""),this.settings[s]&&this.settings[s].hide&&(a.className+=" hidden"),(n=a.style).backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:e.border.color,n.height=this.settings[s]&&this.settings[s].width?this.settings[s].width+"px":e.border.width+"px",n.width=this.settings[s]&&this.settings[s].width?this.settings[s].width+"px":e.border.width+"px",this.main.appendChild(a)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Handsontable.mobileBrowser&&function(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var e={position:"absolute",height:"40px",width:"40px","border-radius":parseInt(40/1.5,10)+"px"};for(var t in e)e.hasOwnProperty(t)&&(this.selectionHandles.styles.bottomRightHitArea[t]=e[t],this.selectionHandles.styles.topLeftHitArea[t]=e[t]);var n={position:"absolute",height:"10px",width:"10px","border-radius":parseInt(10/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(var t in n)n.hasOwnProperty(t)&&(this.selectionHandles.styles.bottomRight[t]=n[t],this.selectionHandles.styles.topLeft[t]=n[t]);this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}.call(this),this.disappear(),t.wtTable.bordersHolder||(t.wtTable.bordersHolder=document.createElement("div"),t.wtTable.bordersHolder.className="htBorders",t.wtTable.spreader.appendChild(t.wtTable.bordersHolder)),t.wtTable.bordersHolder.insertBefore(this.main,t.wtTable.bordersHolder.firstChild);var l=!1;r.addEventListener(document.body,"mousedown",function(){l=!0}),r.addEventListener(document.body,"mouseup",function(){l=!1});for(var u=0,d=this.main.childNodes.length;u<d;u++)r.addEventListener(this.main.childNodes[u],"mouseenter",function(e){var n,o;l&&t.getSetting("hideBorderOnMouseDownOver")&&(e.preventDefault(),e.stopImmediatePropagation(),n=this.getBoundingClientRect(),this.style.display="none",o=function(e){var t;((t=e).clientY<Math.floor(n.top)||t.clientY>Math.ceil(n.top+n.height)||t.clientX<Math.floor(n.left)||t.clientX>Math.ceil(n.left+n.width))&&(r.removeEventListener(document.body,"mousemove",o),this.style.display="block")},r.addEventListener(document.body,"mousemove",o))})}}s.prototype.appear=function(e){if(!this.disabled){for(var t,n,o,r,i,s,a,l,u,d,c,h,f,p,g,m,w,v,y,b,C=this.instance,R=function(){return!(!this.instance.selections.area.cellRange||g==this.instance.selections.area.cellRange.to.row&&m==this.instance.selections.area.cellRange.to.col)},S=C.cloneOverlay instanceof WalkontableTopOverlay||C.cloneOverlay instanceof WalkontableCornerOverlay?C.getSetting("fixedRowsTop"):C.wtTable.getRenderedRowsCount(),E=0;E<S;E++)if((w=C.wtTable.rowFilter.renderedToSource(E))>=e[0]&&w<=e[2]){f=w;break}for(E=S-1;0<=E;E--)if((w=C.wtTable.rowFilter.renderedToSource(E))>=e[0]&&w<=e[2]){g=w;break}for(S=C.wtTable.getRenderedColumnsCount(),E=0;E<S;E++)if((w=C.wtTable.columnFilter.renderedToSource(E))>=e[1]&&w<=e[3]){p=w;break}for(E=S-1;0<=E;E--)if((w=C.wtTable.columnFilter.renderedToSource(E))>=e[1]&&w<=e[3]){m=w;break}void 0!==f&&void 0!==p?(t=f!==g||p!==m,n=C.wtTable.getCell(new _(f,p)),o=t?C.wtTable.getCell(new _(g,m)):n,r=T.offset(n),i=t?T.offset(o):r,s=T.offset(C.wtTable.TABLE),l=r.top,c=i.top+T.outerHeight(o)-l,d=r.left,h=i.left+T.outerWidth(o)-d,a=l-s.top-1,u=d-s.left-1,v=T.getComputedStyle(n),0<parseInt(v.borderTopWidth,10)&&(a+=1,c=0<c?c-1:0),0<parseInt(v.borderLeftWidth,10)&&(u+=1,h=0<h?h-1:0),this.topStyle.top=a+"px",this.topStyle.left=u+"px",this.topStyle.width=h+"px",this.topStyle.display="block",this.leftStyle.top=a+"px",this.leftStyle.left=u+"px",this.leftStyle.height=c+"px",this.leftStyle.display="block",y=Math.floor(this.settings.border.width/2),this.bottomStyle.top=a+c-y+"px",this.bottomStyle.left=u+"px",this.bottomStyle.width=h+"px",this.bottomStyle.display="block",this.rightStyle.top=a+"px",this.rightStyle.left=u+h-y+"px",this.rightStyle.height=c+1+"px",this.rightStyle.display="block",Handsontable.mobileBrowser||!this.hasSetting(this.settings.border.cornerVisible)||R.call(this)?this.cornerStyle.display="none":(this.cornerStyle.top=a+c-4+"px",this.cornerStyle.left=u+h-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="block",m===this.instance.getSetting("totalColumns")-1&&(b=T.getTrimmingContainer(C.wtTable.TABLE),o.offsetLeft+T.outerWidth(o)>=T.innerWidth(b)&&(this.cornerStyle.left=Math.floor(u+h-3-parseInt(this.cornerDefaultStyle.width)/2)+"px",this.cornerStyle.borderRightWidth=0))),Handsontable.mobileBrowser&&function(e,t,n,o){var r=parseInt(this.selectionHandles.styles.topLeft.width,10),i=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(e-r,10)+"px",this.selectionHandles.styles.topLeft.left=parseInt(t-r,10)+"px",this.selectionHandles.styles.topLeftHitArea.top=parseInt(e-i/4*3,10)+"px",this.selectionHandles.styles.topLeftHitArea.left=parseInt(t-i/4*3,10)+"px",this.selectionHandles.styles.bottomRight.top=parseInt(e+o,10)+"px",this.selectionHandles.styles.bottomRight.left=parseInt(t+n,10)+"px",this.selectionHandles.styles.bottomRightHitArea.top=parseInt(e+o-i/4,10)+"px",this.selectionHandles.styles.bottomRightHitArea.left=parseInt(t+n-i/4,10)+"px",this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",R.call(this)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),f==this.instance.wtSettings.getSetting("fixedRowsTop")||p==this.instance.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}.call(this,a,u,h,c)):this.disappear()}},s.prototype.disappear=function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",Handsontable.mobileBrowser&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")},s.prototype.hasSetting=function(e){return"function"==typeof e?e():!!e},window.WalkontableBorder=s},{"./../../../dom.js":27,"./../../../eventManager.js":41,"./cell/coords.js":5}],3:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableViewportColumnsCalculator:{get:function(){return o}},__esModule:{value:!0}});var h=new WeakMap,o=function(e,t,n,o,r,i,s){h.set(this,{viewportWidth:e,scrollOffset:t,totalColumns:n,columnWidthFn:o,overrideFn:r,onlyFullyVisible:i}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()},r=o;$traceurRuntime.createClass(o,{calculate:function(){for(var e,t=0,n=!0,o=[],r=h.get(this),i=r.onlyFullyVisible,s=r.overrideFn,a=r.scrollOffset,l=r.totalColumns,u=r.viewportWidth,d=0;d<l;d++)if(e=this._getColumnWidth(d),t<=a&&!i&&(this.startColumn=d),a<=t&&t+e<=a+u&&(null==this.startColumn&&(this.startColumn=d),this.endColumn=d),o.push(t),t+=e,i||(this.endColumn=d),a+u<=t){n=!1;break}if(this.endColumn===l-1&&n)for(this.startColumn=this.endColumn;0<this.startColumn;){var c=o[this.endColumn]+e-o[this.startColumn-1];if((c<=u||!i)&&this.startColumn--,u<c)break}null!==this.startColumn&&s&&s(this),this.startPosition=o[this.startColumn],null==this.startPosition&&(this.startPosition=null),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)},refreshStretching:function(e){if("none"!==this.stretch){for(var t,n=0,o=h.get(this).totalColumns,r=0;r<o;r++)n+=this._getColumnWidth(r);t=n-(this.totalTargetWidth=e),"all"===this.stretch&&t<0?(this.stretchAllRatio=e/n,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0):"last"===this.stretch&&e!==1/0&&(this.stretchLastWidth=-t+this._getColumnWidth(o-1))}},getStretchedColumnWidth:function(e,t){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(e)),n},_getStretchedAllColumnWidth:function(e,t){var n=0,o=h.get(this).totalColumns;if(this.stretchAllColumnsWidth[e]||(this.stretchAllColumnsWidth[e]=Math.round(t*this.stretchAllRatio)),this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var r=0;r<this.stretchAllColumnsWidth.length;r++)n+=this.stretchAllColumnsWidth[r];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]},_getStretchedLastColumnWidth:function(e){return e===h.get(this).totalColumns-1?this.stretchLastWidth:null},_getColumnWidth:function(e){var t=h.get(this).columnWidthFn(e);return void 0===t&&(t=r.DEFAULT_WIDTH),t}},{get DEFAULT_WIDTH(){return 50}}),window.WalkontableViewportColumnsCalculator=o},{}],4:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableViewportRowsCalculator:{get:function(){return o}},__esModule:{value:!0}});var f=new WeakMap,o=function(e,t,n,o,r,i){f.set(this,{viewportHeight:e,scrollOffset:t,totalRows:n,rowHeightFn:o,overrideFn:r,onlyFullyVisible:i}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()},p=o;$traceurRuntime.createClass(o,{calculate:function(){for(var e=0,t=!0,n=[],o=f.get(this),r=o.onlyFullyVisible,i=o.overrideFn,s=o.rowHeightFn,a=o.scrollOffset,l=o.totalRows,u=o.viewportHeight,d=0;d<l;d++){var c=s(d);if(void 0===c&&(c=p.DEFAULT_HEIGHT),e<=a&&!r&&(this.startRow=d),a<=e&&e+c<=a+u&&(null===this.startRow&&(this.startRow=d),this.endRow=d),n.push(e),e+=c,r||(this.endRow=d),a+u<=e){t=!1;break}}if(this.endRow===l-1&&t)for(this.startRow=this.endRow;0<this.startRow;){var h=n[this.endRow]+c-n[this.startRow-1];if((h<=u||!r)&&this.startRow--,u<=h)break}null!==this.startRow&&i&&i(this),this.startPosition=n[this.startRow],null==this.startPosition&&(this.startPosition=null),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}},{get DEFAULT_HEIGHT(){return 23}}),window.WalkontableViewportRowsCalculator=o},{}],5:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableCellCoords:{get:function(){return o}},__esModule:{value:!0}});var o=function(e,t){void 0!==e&&void 0!==t?(this.row=e,this.col=t):(this.row=null,this.col=null)};$traceurRuntime.createClass(o,{isValid:function(e){return!(this.row<0||this.col<0)&&!(this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))},isEqual:function(e){return e===this||this.row===e.row&&this.col===e.col},isSouthEastOf:function(e){return this.row>=e.row&&this.col>=e.col},isNorthWestOf:function(e){return this.row<=e.row&&this.col<=e.col},isSouthWestOf:function(e){return this.row>=e.row&&this.col<=e.col},isNorthEastOf:function(e){return this.row<=e.row&&this.col>=e.col}},{}),window.WalkontableCellCoords=o},{}],6:[function(e,t,n){"use strict";var o;Object.defineProperties(n,{WalkontableCellRange:{get:function(){return r}},__esModule:{value:!0}});var f=((o=e("./../cell/coords.js"))&&o.__esModule&&o||{default:o}).WalkontableCellCoords,r=function(e,t,n){this.highlight=e,this.from=t,this.to=n},p=r;$traceurRuntime.createClass(r,{isValid:function(e){return this.from.isValid(e)&&this.to.isValid(e)},isSingle:function(){return this.from.row===this.to.row&&this.from.col===this.to.col},getHeight:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1},getWidth:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1},includes:function(e){var t=this.getTopLeftCorner(),n=this.getBottomRightCorner();return e.row<0&&(e.row=0),e.col<0&&(e.col=0),t.row<=e.row&&n.row>=e.row&&t.col<=e.col&&n.col>=e.col},includesRange:function(e){return this.includes(e.getTopLeftCorner())&&this.includes(e.getBottomRightCorner())},isEqual:function(e){return Math.min(this.from.row,this.to.row)==Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(e.from.col,e.to.col)},overlaps:function(e){return e.isSouthEastOf(this.getTopLeftCorner())&&e.isNorthWestOf(this.getBottomRightCorner())},isSouthEastOf:function(e){return this.getTopLeftCorner().isSouthEastOf(e)||this.getBottomRightCorner().isSouthEastOf(e)},isNorthWestOf:function(e){return this.getTopLeftCorner().isNorthWestOf(e)||this.getBottomRightCorner().isNorthWestOf(e)},expand:function(e){var t=this.getTopLeftCorner(),n=this.getBottomRightCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=new f(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=new f(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)},expandByRange:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getTopLeftCorner(),n=this.getBottomRightCorner(),o=(this.getTopRightCorner(),this.getBottomLeftCorner(),e.getTopLeftCorner()),r=e.getBottomRightCorner(),i=Math.min(t.row,o.row),s=Math.min(t.col,o.col),a=Math.max(n.row,r.row),l=Math.max(n.col,r.col),u=new f(i,s),d=new f(a,l),c=new p(u,u,d).isCorner(this.from,e),h=e.isEqual(new p(u,u,d));return c&&!h&&(this.from.col>u.col&&(u.col=l,d.col=s),this.from.row>u.row&&(u.row=a,d.row=i)),this.from=u,this.to=d,!0},getDirection:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0},setDirection:function(e){switch(e){case"NW-SE":this.from=this.getTopLeftCorner(),this.to=this.getBottomRightCorner();break;case"NE-SW":this.from=this.getTopRightCorner(),this.to=this.getBottomLeftCorner();break;case"SE-NW":this.from=this.getBottomRightCorner(),this.to=this.getTopLeftCorner();break;case"SW-NE":this.from=this.getBottomLeftCorner(),this.to=this.getTopRightCorner()}},getTopLeftCorner:function(){return new f(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},getBottomRightCorner:function(){return new f(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getTopRightCorner:function(){return new f(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getBottomLeftCorner:function(){return new f(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},isCorner:function(e,t){return!!(t&&t.includes(e)&&(this.getTopLeftCorner().isEqual(new f(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new f(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new f(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new f(t.to.row,t.to.col))))||(e.isEqual(this.getTopLeftCorner())||e.isEqual(this.getTopRightCorner())||e.isEqual(this.getBottomLeftCorner())||e.isEqual(this.getBottomRightCorner()))},getOppositeCorner:function(e,t){if(!(e instanceof f))return!1;if(t&&t.includes(e)){if(this.getTopLeftCorner().isEqual(new f(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new f(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new f(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new f(t.to.row,t.to.col)))return this.getTopLeftCorner()}return e.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():e.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():e.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():e.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0},getBordersSharedWith:function(e){if(!this.includesRange(e))return[];var t=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),o=Math.min(this.from.col,this.to.col),r=Math.max(this.from.col,this.to.col),i=Math.min(e.from.row,e.to.row),s=Math.max(e.from.row,e.to.row),a=Math.min(e.from.col,e.to.col),l=Math.max(e.from.col,e.to.col),u=[];return t==i&&u.push("top"),r==l&&u.push("right"),n==s&&u.push("bottom"),o==a&&u.push("left"),u},getInner:function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),n=[],o=e.row;o<=t.row;o++)for(var r=e.col;r<=t.col;r++)this.from.row===o&&this.from.col===r||this.to.row===o&&this.to.col===r||n.push(new f(o,r));return n},getAll:function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),n=[],o=e.row;o<=t.row;o++)for(var r=e.col;r<=t.col;r++)e.row===o&&e.col===r?n.push(e):t.row===o&&t.col===r?n.push(t):n.push(new f(o,r));return n},forAll:function(e){for(var t=this.getTopLeftCorner(),n=this.getBottomRightCorner(),o=t.row;o<=n.row;o++)for(var r=t.col;r<=n.col;r++){if(!1===e(o,r))return}}},{}),window.WalkontableCellRange=r},{"./../cell/coords.js":5}],7:[function(e,t,n){"use strict";var o,r,i,s,a,l,u,d;Object.defineProperties(n,{Walkontable:{get:function(){return y}},__esModule:{value:!0}});var c=(o=e("./../../../dom.js"))&&o.__esModule&&o||{default:o},h=((r=e("./../../../helpers.js"))&&r.__esModule&&r||{default:r}).randomString,f=((i=e("./event.js"))&&i.__esModule&&i||{default:i}).WalkontableEvent,p=((s=e("./overlays.js"))&&s.__esModule&&s||{default:s}).WalkontableOverlays,g=((a=e("./scroll.js"))&&a.__esModule&&a||{default:a}).WalkontableScroll,m=((l=e("./settings.js"))&&l.__esModule&&l||{default:l}).WalkontableSettings,w=((u=e("./table.js"))&&u.__esModule&&u||{default:u}).WalkontableTable,v=((d=e("./viewport.js"))&&d.__esModule&&d||{default:d}).WalkontableViewport,y=function(e){var n=[];if(this.guid="wt_"+h(),e.cloneSource?(this.cloneSource=e.cloneSource,this.cloneOverlay=e.cloneOverlay,this.wtSettings=e.cloneSource.wtSettings,this.wtTable=new w(this,e.table,e.wtRootElement),this.wtScroll=new g(this),this.wtViewport=e.cloneSource.wtViewport,this.wtEvent=new f(this),this.selections=this.cloneSource.selections):(this.wtSettings=new m(this,e),this.wtTable=new w(this,e.table),this.wtScroll=new g(this),this.wtViewport=new v(this),this.wtEvent=new f(this),this.selections=this.getSetting("selections"),this.wtOverlays=new p(this)),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var t=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;t<o;t++)n.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(e,t){c.fastInnerText(t,n[e])}])}this.drawn=!1,this.drawInterrupted=!1};$traceurRuntime.createClass(y,{draw:function(){var e=void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,e||c.isVisible(this.wtTable.TABLE)?this.wtTable.draw(e):this.drawInterrupted=!0,this},getCell:function(e){if(!(void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(e);var t=this.wtSettings.getSetting("fixedRowsTop"),n=this.wtSettings.getSetting("fixedColumnsLeft");return e.row<t&&e.col<n?this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(e):e.row<t?this.wtOverlays.topOverlay.clone.wtTable.getCell(e):e.col<n?this.wtOverlays.leftOverlay.clone.wtTable.getCell(e):this.wtTable.getCell(e)},update:function(e,t){return this.wtSettings.update(e,t)},scrollVertical:function(e){return this.wtOverlays.topOverlay.scrollTo(e),this.getSetting("onScrollVertically"),this},scrollHorizontal:function(e){return this.wtOverlays.leftOverlay.scrollTo(e),this.getSetting("onScrollHorizontally"),this},scrollViewport:function(e){return this.wtScroll.scrollViewport(e),this},getViewport:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},getOverlayName:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"},getSetting:function(e,t,n,o,r){return this.wtSettings.getSetting(e,t,n,o,r)},hasSetting:function(e){return this.wtSettings.has(e)},destroy:function(){this.wtOverlays.destroy(),this.wtEvent&&this.wtEvent.destroy()}},{}),window.Walkontable=y},{"./../../../dom.js":27,"./../../../helpers.js":42,"./event.js":8,"./overlays.js":16,"./scroll.js":17,"./settings.js":19,"./table.js":20,"./viewport.js":22}],8:[function(e,t,n){"use strict";var o,r;Object.defineProperties(n,{WalkontableEvent:{get:function(){return i}},__esModule:{value:!0}});var u=(o=e("./../../../dom.js"))&&o.__esModule&&o||{default:o},d=((r=e("./../../../eventManager.js"))&&r.__esModule&&r||{default:r}).eventManager;function i(e){var o=this,t=d(e);this.instance=e;var n=[null,null];this.dblClickTimeout=[null,null];function r(e){var t=o.parentCell(e.realTarget);u.hasClass(e.realTarget,"corner")?o.instance.getSetting("onCellCornerMouseDown",e,e.realTarget):t.TD&&o.instance.hasSetting("onCellMouseDown")&&o.instance.getSetting("onCellMouseDown",e,t.coords,t.TD,o.instance),2!==e.button&&t.TD&&(n[0]=t.TD,clearTimeout(o.dblClickTimeout[0]),o.dblClickTimeout[0]=setTimeout(function(){n[0]=null},1e3))}function i(e){o.instance.touchMoving=!0}function s(e){var t;2!==e.button&&((t=o.parentCell(e.realTarget)).TD===n[0]&&t.TD===n[1]?(u.hasClass(e.realTarget,"corner")?o.instance.getSetting("onCellCornerDblClick",e,t.coords,t.TD,o.instance):o.instance.getSetting("onCellDblClick",e,t.coords,t.TD,o.instance),n[0]=null,n[1]=null):t.TD===n[0]&&(n[1]=t.TD,clearTimeout(o.dblClickTimeout[1]),o.dblClickTimeout[1]=setTimeout(function(){n[1]=null},500)))}var a,l;t.addEventListener(this.instance.wtTable.holder,"mousedown",r),t.addEventListener(this.instance.wtTable.TABLE,"mouseover",function(e){var t,n;o.instance.hasSetting("onCellMouseOver")&&(t=o.instance.wtTable.TABLE,(n=u.closest(e.realTarget,["TD","TH"],t))&&n!==a&&u.isChildOf(n,t)&&(a=n,o.instance.getSetting("onCellMouseOver",e,o.instance.wtTable.getCoords(n),n,o.instance)))}),t.addEventListener(this.instance.wtTable.holder,"mouseup",s),this.instance.wtTable.holder.parentNode.parentNode&&Handsontable.mobileBrowser&&!o.instance.wtTable.isWorkingOnClone()&&(l="."+this.instance.wtTable.holder.parentNode.className.split(" ").join("."),t.addEventListener(this.instance.wtTable.holder,"touchstart",function(e){o.instance.touchApplied=!0,u.isChildOf(e.target,l)&&function(e){t.addEventListener(this,"touchmove",i),o.checkIfTouchMove=setTimeout(function(){return!0===o.instance.touchMoving?(o.instance.touchMoving=void 0,void t.removeEventListener("touchmove",i,!1)):void r(e)},30)}.call(e.target,e)}),t.addEventListener(this.instance.wtTable.holder,"touchend",function(e){o.instance.touchApplied=!1,u.isChildOf(e.target,l)&&function(e){clearTimeout(void 0),e.preventDefault(),s(e)}.call(e.target,e)}),o.instance.momentumScrolling||(o.instance.momentumScrolling={}),t.addEventListener(this.instance.wtTable.holder,"scroll",function(e){clearTimeout(o.instance.momentumScrolling._timeout),o.instance.momentumScrolling.ongoing||o.instance.getSetting("onBeforeTouchScroll"),o.instance.momentumScrolling.ongoing=!0,o.instance.momentumScrolling._timeout=setTimeout(function(){o.instance.touchApplied||(o.instance.momentumScrolling.ongoing=!1,o.instance.getSetting("onAfterMomentumScroll"))},200)})),t.addEventListener(window,"resize",function(){"none"!==o.instance.getSetting("stretchH")&&o.instance.draw()}),this.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1]),t.clear()}}i.prototype.parentCell=function(e){var t={},n=this.instance.wtTable.TABLE,o=u.closest(e,["TD","TH"],n);return o&&u.isChildOf(o,n)?(t.coords=this.instance.wtTable.getCoords(o),t.TD=o):u.hasClass(e,"wtBorder")&&u.hasClass(e,"current")?(t.coords=this.instance.selections.current.cellRange.highlight,t.TD=this.instance.wtTable.getCell(t.coords)):u.hasClass(e,"wtBorder")&&u.hasClass(e,"area")&&this.instance.selections.area.cellRange&&(t.coords=this.instance.selections.area.cellRange.to,t.TD=this.instance.wtTable.getCell(t.coords)),t},window.WalkontableEvent=i},{"./../../../dom.js":27,"./../../../eventManager.js":41}],9:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableColumnFilter:{get:function(){return o}},__esModule:{value:!0}});var o=function(e,t,n){this.offset=e,this.total=t,this.countTH=n};$traceurRuntime.createClass(o,{offsetted:function(e){return e+this.offset},unOffsetted:function(e){return e-this.offset},renderedToSource:function(e){return this.offsetted(e)},sourceToRendered:function(e){return this.unOffsetted(e)},offsettedTH:function(e){return e-this.countTH},unOffsettedTH:function(e){return e+this.countTH},visibleRowHeadedColumnToSourceColumn:function(e){return this.renderedToSource(this.offsettedTH(e))},sourceColumnToVisibleRowHeadedColumn:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}},{}),window.WalkontableColumnFilter=o},{}],10:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableRowFilter:{get:function(){return o}},__esModule:{value:!0}});var o=function(e,t,n){this.offset=e,this.total=t,this.countTH=n};$traceurRuntime.createClass(o,{offsetted:function(e){return e+this.offset},unOffsetted:function(e){return e-this.offset},renderedToSource:function(e){return this.offsetted(e)},sourceToRendered:function(e){return this.unOffsetted(e)},offsettedTH:function(e){return e-this.countTH},unOffsettedTH:function(e){return e+this.countTH},visibleColHeadedRowToSourceRow:function(e){return this.renderedToSource(this.offsettedTH(e))},sourceRowToVisibleColHeadedRow:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}},{}),window.WalkontableRowFilter=o},{}],11:[function(e,t,n){"use strict";var o,r,i;Object.defineProperties(n,{WalkontableOverlay:{get:function(){return u}},__esModule:{value:!0}});var s=(o=e("./../../../../dom.js"))&&o.__esModule&&o||{default:o},a=((r=e("./../../../../helpers.js"))&&r.__esModule&&r||{default:r}).defineGetter,l=((i=e("./../../../../eventManager.js"))&&i.__esModule&&i||{default:i}).eventManager,u=function(e){a(this,"wot",e,{writable:!1}),this.instance=this.wot,this.type="",this.TABLE=this.wot.wtTable.TABLE,this.hider=this.wot.wtTable.hider,this.spreader=this.wot.wtTable.spreader,this.holder=this.wot.wtTable.holder,this.wtRootElement=this.wot.wtTable.wtRootElement,this.trimmingContainer=s.getTrimmingContainer(this.hider.parentNode.parentNode),this.mainTableScrollableElement=s.getScrollableElement(this.wot.wtTable.TABLE),this.needFullRender=this.shouldBeRendered(),this.isElementSizesAdjusted=!1},d=u;$traceurRuntime.createClass(u,{shouldBeRendered:function(){return!0},makeClone:function(e){if(-1===d.CLONE_TYPES.indexOf(e))throw new Error('Clone type "'+e+'" is not supported.');var t=document.createElement("DIV"),n=document.createElement("TABLE");return t.className="ht_clone_"+e+" handsontable",t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.overflow="hidden",n.className=this.wot.wtTable.TABLE.className,t.appendChild(n),this.type=e,this.wot.wtTable.wtRootElement.parentNode.appendChild(t),new Walkontable({cloneSource:this.wot,cloneOverlay:this,table:n})},refresh:function(){var e=void 0!==arguments[0]&&arguments[0],t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t},destroy:function(){l(this.clone).clear()}},{get CLONE_TOP(){return"top"},get CLONE_LEFT(){return"left"},get CLONE_CORNER(){return"corner"},get CLONE_DEBUG(){return"debug"},get CLONE_TYPES(){return[d.CLONE_TOP,d.CLONE_LEFT,d.CLONE_CORNER,d.CLONE_DEBUG]}}),window.WalkontableOverlay=u},{"./../../../../dom.js":27,"./../../../../eventManager.js":41,"./../../../../helpers.js":42}],12:[function(e,t,n){"use strict";var o,r;Object.defineProperties(n,{WalkontableCornerOverlay:{get:function(){return s}},__esModule:{value:!0}});var d=(o=e("./../../../../dom.js"))&&o.__esModule&&o||{default:o},i=((r=e("./_base.js"))&&r.__esModule&&r||{default:r}).WalkontableOverlay,s=function(e){$traceurRuntime.superConstructor(a).call(this,e),this.clone=this.makeClone(i.CLONE_CORNER)},a=s;$traceurRuntime.createClass(s,{shouldBeRendered:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length||!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)},resetFixedPosition:function(){var e,t,n,o,r,i,s,a,l,u;this.wot.wtTable.holder.parentNode&&(e=this.clone.wtTable.holder.parentNode,t=d.outerHeight(this.clone.wtTable.TABLE),n=d.outerWidth(this.clone.wtTable.TABLE),this.trimmingContainer===window&&(o=this.wot.wtTable.hider.getBoundingClientRect(),r=Math.ceil(o.top),i=Math.ceil(o.left),s=Math.ceil(o.bottom),a=Math.ceil(o.right),l=i<0&&0<a-e.offsetWidth?-i+"px":"0",u=r<0&&0<s-e.offsetHeight?-r+"px":"0",d.setOverlayPosition(e,l,u)),e.style.height=(0===t?t:t+4)+"px",e.style.width=(0===n?n:n+4)+"px")}},{},i),window.WalkontableCornerOverlay=s},{"./../../../../dom.js":27,"./_base.js":11}],13:[function(e,t,n){"use strict";var o,r;Object.defineProperties(n,{WalkontableDebugOverlay:{get:function(){return a}},__esModule:{value:!0}});var i=(o=e("./../../../../dom.js"))&&o.__esModule&&o||{default:o},s=((r=e("./_base.js"))&&r.__esModule&&r||{default:r}).WalkontableOverlay,a=function(e){$traceurRuntime.superConstructor(l).call(this,e),this.clone=this.makeClone(s.CLONE_DEBUG),this.clone.wtTable.holder.style.opacity=.4,this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",i.addClass(this.clone.wtTable.holder.parentNode,"wtDebugVisible")},l=a;$traceurRuntime.createClass(a,{},{},s),window.WalkontableDebugOverlay=a},{"./../../../../dom.js":27,"./_base.js":11}],14:[function(e,t,n){"use strict";var o,r;Object.defineProperties(n,{WalkontableLeftOverlay:{get:function(){return s}},__esModule:{value:!0}});var a=(o=e("./../../../../dom.js"))&&o.__esModule&&o||{default:o},i=((r=e("./_base.js"))&&r.__esModule&&r||{default:r}).WalkontableOverlay,s=function(e){$traceurRuntime.superConstructor(l).call(this,e),this.clone=this.makeClone(i.CLONE_LEFT)},l=s;$traceurRuntime.createClass(s,{shouldBeRendered:function(){return!(!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)},resetFixedPosition:function(){var e,t,n,o,r,i,s;this.needFullRender&&this.wot.wtTable.holder.parentNode&&(e=this.clone.wtTable.holder.parentNode,t=0,this.trimmingContainer===window?(n=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(n.left),r=Math.ceil(n.right),s=""===(s=this.wot.wtTable.hider.style.top)?0:s,t=i=o<0&&0<r-e.offsetWidth?-o:0,i+="px",a.setOverlayPosition(e,i,s)):t=this.getScrollPosition(),this.adjustHeaderBordersPosition(t))},setScrollPosition:function(e){this.mainTableScrollableElement===window?window.scrollTo(e,a.getWindowScrollTop()):this.mainTableScrollableElement.scrollLeft=e},onScroll:function(){this.wot.getSetting("onScrollHorizontally")},sumCellSizes:function(e,t){for(var n=0,o=this.wot.wtSettings.defaultColumnWidth;e<t;)n+=this.wot.wtTable.getStretchedColumnWidth(e)||o,e++;return n},adjustElementsSize:function(){var e=void 0!==arguments[0]&&arguments[0];(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildsSize(),e||(this.isElementSizesAdjusted=!0))},adjustRootElementSize:function(){var e,t=this.wot.wtTable.holder,n=t.clientHeight!==t.offsetHeight?a.getScrollbarWidth():0,o=this.clone.wtTable.holder.parentNode.style;this.trimmingContainer!==window&&(o.height=this.wot.wtViewport.getWorkspaceHeight()-n+"px"),this.clone.wtTable.holder.style.height=o.height,e=a.outerWidth(this.clone.wtTable.TABLE),o.width=(0===e?e:e+4)+"px"},adjustRootChildsSize:function(){var e=a.getScrollbarWidth();this.clone.wtTable.hider.style.height=this.hider.style.height,this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height,0===e&&(e=30),this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+e+"px"},applyToDOM:function(){var e=this.wot.getSetting("totalColumns");if(this.isElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.left="0"}this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.top=""},scrollTo:function(e,t){var n=this.getTableParentOffset(),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,r=0;t&&o.offsetWidth!==o.clientWidth&&(r=a.getScrollbarWidth()),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),e),n+=r,this.setScrollPosition(n)},getTableParentOffset:function(){return this.trimmingContainer===window?this.wot.wtTable.holderOffset.left:0},getScrollPosition:function(){return a.getScrollLeft(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(e){var t,n;0===this.wot.getSetting("fixedColumnsLeft")&&0<this.wot.getSetting("rowHeaders").length&&(t=this.wot.wtTable.holder.parentNode,n=a.hasClass(t,"innerBorderLeft"),e?a.addClass(t,"innerBorderLeft"):a.removeClass(t,"innerBorderLeft"),(!n&&e||n&&!e)&&this.wot.wtOverlays.adjustElementsSize())}},{},i),window.WalkontableLeftOverlay=s},{"./../../../../dom.js":27,"./_base.js":11}],15:[function(e,t,n){"use strict";var o,r;Object.defineProperties(n,{WalkontableTopOverlay:{get:function(){return s}},__esModule:{value:!0}});var a=(o=e("./../../../../dom.js"))&&o.__esModule&&o||{default:o},i=((r=e("./_base.js"))&&r.__esModule&&r||{default:r}).WalkontableOverlay,s=function(e){$traceurRuntime.superConstructor(l).call(this,e),this.clone=this.makeClone(i.CLONE_TOP)},l=s;$traceurRuntime.createClass(s,{shouldBeRendered:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length)},resetFixedPosition:function(){var e,t,n,o,r,i,s;this.needFullRender&&this.wot.wtTable.holder.parentNode&&(e=this.clone.wtTable.holder.parentNode,t=0,this.wot.wtOverlays.leftOverlay.trimmingContainer===window?(n=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(n.top),r=Math.ceil(n.bottom),s=""===(s=this.wot.wtTable.hider.style.left)?0:s,t=i=o<0&&0<r-e.offsetHeight?-o:0,i+="px",a.setOverlayPosition(e,s,i)):t=this.getScrollPosition(),this.adjustHeaderBordersPosition(t))},setScrollPosition:function(e){this.mainTableScrollableElement===window?window.scrollTo(a.getWindowScrollLeft(),e):this.mainTableScrollableElement.scrollTop=e},onScroll:function(){this.wot.getSetting("onScrollVertically")},sumCellSizes:function(e,t){for(var n=0,o=this.wot.wtSettings.settings.defaultRowHeight;e<t;)n+=this.wot.wtTable.getRowHeight(e)||o,e++;return n},adjustElementsSize:function(){var e=void 0!==arguments[0]&&arguments[0];(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildsSize(),e||(this.isElementSizesAdjusted=!0))},adjustRootElementSize:function(){var e,t=this.wot.wtTable.holder,n=t.clientWidth!==t.offsetWidth?a.getScrollbarWidth():0,o=this.clone.wtTable.holder.parentNode.style;this.trimmingContainer!==window&&(o.width=this.wot.wtViewport.getWorkspaceWidth()-n+"px"),this.clone.wtTable.holder.style.width=o.width,e=a.outerHeight(this.clone.wtTable.TABLE),o.height=(0===e?e:e+4)+"px"},adjustRootChildsSize:function(){var e=a.getScrollbarWidth();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===e&&(e=30),this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+e+"px"},applyToDOM:function(){var e=this.wot.getSetting("totalRows");if(this.isElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.left=""},scrollTo:function(e,t){var n=this.getTableParentOffset(),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,r=0;t&&o.offsetHeight!==o.clientHeight&&(r=a.getScrollbarWidth()),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),e),n+=r,this.setScrollPosition(n)},getTableParentOffset:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0},getScrollPosition:function(){return a.getScrollTop(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(e){var t,n,o;0===this.wot.getSetting("fixedRowsTop")&&0<this.wot.getSetting("columnHeaders").length&&(t=this.wot.wtTable.holder.parentNode,n=a.hasClass(t,"innerBorderTop"),e?a.addClass(t,"innerBorderTop"):a.removeClass(t,"innerBorderTop"),(!n&&e||n&&!e)&&this.wot.wtOverlays.adjustElementsSize()),0!==this.wot.getSetting("rowHeaders").length||(o=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)"))&&(o.style["border-left-width"]=0)}},{},i),window.WalkontableTopOverlay=s},{"./../../../../dom.js":27,"./_base.js":11}],16:[function(e,t,n){"use strict";var o,r,i,s,a,l;Object.defineProperties(n,{WalkontableOverlays:{get:function(){return g}},__esModule:{value:!0}});var u=(o=e("./../../../dom.js"))&&o.__esModule&&o||{default:o},d=((r=e("./../../../eventManager.js"))&&r.__esModule&&r||{default:r}).EventManager,c=((i=e("./overlay/corner.js"))&&i.__esModule&&i||{default:i}).WalkontableCornerOverlay,h=((s=e("./overlay/debug.js"))&&s.__esModule&&s||{default:s}).WalkontableDebugOverlay,f=((a=e("./overlay/left.js"))&&a.__esModule&&a||{default:a}).WalkontableLeftOverlay,p=((l=e("./overlay/top.js"))&&l.__esModule&&l||{default:l}).WalkontableTopOverlay,g=function(e){this.wot=e,this.instance=this.wot,this.eventManager=new d(this.wot),this.wot.update("scrollbarWidth",u.getScrollbarWidth()),this.wot.update("scrollbarHeight",u.getScrollbarWidth()),this.mainTableScrollableElement=u.getScrollableElement(this.wot.wtTable.TABLE),this.topOverlay=new p(this.wot),this.leftOverlay=new f(this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay=new c(this.wot)),this.wot.getSetting("debug")&&(this.debug=new h(this.wot)),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},left:{top:0,left:null}},this.registerListeners()};$traceurRuntime.createClass(g,{refreshAll:function(){this.wot.drawn&&(this.wot.wtTable.holder.parentNode?(this.wot.draw(!0),this.topOverlay.onScroll(),this.leftOverlay.onScroll()):this.destroy())},registerListeners:function(){var r=this;this.eventManager.addEventListener(document.documentElement,"keydown",function(){return r.onKeyDown()}),this.eventManager.addEventListener(document.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(this.mainTableScrollableElement,"scroll",function(e){return r.onTableScroll(e)}),this.topOverlay.needFullRender&&(this.eventManager.addEventListener(this.topOverlay.clone.wtTable.holder,"scroll",function(e){return r.onTableScroll(e)}),this.eventManager.addEventListener(this.topOverlay.clone.wtTable.holder,"wheel",function(e){return r.onTableScroll(e)})),this.leftOverlay.needFullRender&&(this.eventManager.addEventListener(this.leftOverlay.clone.wtTable.holder,"scroll",function(e){return r.onTableScroll(e)}),this.eventManager.addEventListener(this.leftOverlay.clone.wtTable.holder,"wheel",function(e){return r.onTableScroll(e)})),this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&this.eventManager.addEventListener(window,"wheel",function(e){var t,n=e.wheelDeltaY||e.deltaY,o=e.wheelDeltaX||e.deltaX;r.topOverlay.clone.wtTable.holder.contains(e.target)?t="top":r.leftOverlay.clone.wtTable.holder.contains(e.target)&&(t="left"),("top"==t&&0!==n||"left"==t&&0!==o)&&e.preventDefault()})},onTableScroll:function(e){Handsontable.mobileBrowser||this.keyPressed&&this.mainTableScrollableElement!==window&&!e.target.contains(this.mainTableScrollableElement)||("scroll"===e.type?this.syncScrollPositions(e):this.translateMouseWheelToScroll(e))},onKeyDown:function(){this.keyPressed=!0},onKeyUp:function(){this.keyPressed=!1},translateMouseWheelToScroll:function(e){for(var t,n=this.topOverlay.clone.wtTable.holder,o=this.leftOverlay.clone.wtTable.holder,r={type:"wheel"},i=e.target,s=e.wheelDeltaY||-1*e.deltaY,a=e.wheelDeltaX||-1*e.deltaX;i!=document&&null!=i;){if(-1<i.className.indexOf("wtHolder")){t=i;break}i=i.parentNode}return(r.target=t)==n?this.syncScrollPositions(r,-.2*s):t==o&&this.syncScrollPositions(r,-.2*a),!1},syncScrollPositions:function(e){var t,n,o,r,i,s,a=void 0!==arguments[1]?arguments[1]:null;this.destroyed||(0!==arguments.length?(t=this.mainTableScrollableElement,n=e.target,o=0,r=!1,this.topOverlay.needFullRender&&(i=this.topOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&(s=this.leftOverlay.clone.wtTable.holder),n===document&&(n=window),n===t?(o=u.getScrollLeft(n),this.overlayScrollPositions.master.left!==o&&(this.overlayScrollPositions.master.left=o,r=!0,i&&(i.scrollLeft=o)),o=u.getScrollTop(n),this.overlayScrollPositions.master.top!==o&&(this.overlayScrollPositions.master.top=o,r=!0,s&&(s.scrollTop=o))):n===i?(o=u.getScrollLeft(n),this.overlayScrollPositions.top.left!==o&&(this.overlayScrollPositions.top.left=o,r=!0,t.scrollLeft=o),null!==a&&(r=!0,t.scrollTop+=a)):n===s&&(o=u.getScrollTop(n),this.overlayScrollPositions.left.top!==o&&(this.overlayScrollPositions.left.top=o,r=!0,t.scrollTop=o),null!==a&&(r=!0,t.scrollLeft+=a)),!this.keyPressed&&r&&"scroll"===e.type&&this.refreshAll()):this.syncScrollWithMaster())},syncScrollWithMaster:function(){var e=this.topOverlay.mainTableScrollableElement;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e.scrollLeft),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=e.scrollTop)},destroy:function(){this.eventManager.clear(),this.topOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.debug&&this.debug.destroy(),this.destroyed=!0},refresh:function(){var e,t,n,o=void 0!==arguments[0]&&arguments[0];this.topOverlay.isElementSizesAdjusted&&this.leftOverlay.isElementSizesAdjusted&&(t=(e=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement).clientWidth,n=e.clientHeight,t===this.spreaderLastSize.width&&n===this.spreaderLastSize.height||(this.spreaderLastSize.width=t,this.spreaderLastSize.height=n,this.adjustElementsSize())),this.leftOverlay.refresh(o),this.topOverlay.refresh(o),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(o),this.debug&&this.debug.refresh(o)},adjustElementsSize:function(){var e=void 0!==arguments[0]&&arguments[0],t=this.wot.getSetting("totalColumns"),n=this.wot.getSetting("totalRows"),o=this.wot.wtViewport.getRowHeaderWidth(),r=this.wot.wtViewport.getColumnHeaderHeight(),i=this.wot.wtTable.hider.style;i.width=o+this.leftOverlay.sumCellSizes(0,t)+"px",i.height=r+this.topOverlay.sumCellSizes(0,n)+1+"px",this.topOverlay.adjustElementsSize(e),this.leftOverlay.adjustElementsSize(e)},applyToDOM:function(){this.topOverlay.isElementSizesAdjusted&&this.leftOverlay.isElementSizesAdjusted||this.adjustElementsSize(),this.topOverlay.applyToDOM(),this.leftOverlay.applyToDOM()}},{}),window.WalkontableOverlays=g},{"./../../../dom.js":27,"./../../../eventManager.js":41,"./overlay/corner.js":12,"./overlay/debug.js":13,"./overlay/left.js":14,"./overlay/top.js":15}],17:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableScroll:{get:function(){return o}},__esModule:{value:!0}});var o=function(e){this.wot=e,this.instance=e};$traceurRuntime.createClass(o,{scrollViewport:function(e){if(this.wot.drawn){var t=this.wot.getSetting("totalRows"),n=this.wot.getSetting("totalColumns");if(e.row<0||e.row>t-1)throw new Error("row "+e.row+" does not exist");if(e.col<0||e.col>n-1)throw new Error("column "+e.col+" does not exist");e.row>this.instance.wtTable.getLastVisibleRow()?this.wot.wtOverlays.topOverlay.scrollTo(e.row,!0):e.row>=this.instance.getSetting("fixedRowsTop")&&e.row<this.instance.wtTable.getFirstVisibleRow()&&this.wot.wtOverlays.topOverlay.scrollTo(e.row),e.col>this.instance.wtTable.getLastVisibleColumn()?this.wot.wtOverlays.leftOverlay.scrollTo(e.col,!0):e.col>=this.instance.getSetting("fixedColumnsLeft")&&e.col<this.instance.wtTable.getFirstVisibleColumn()&&this.wot.wtOverlays.leftOverlay.scrollTo(e.col)}}},{}),window.WalkontableScroll=o},{}],18:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{WalkontableSelection:{get:function(){return d}},__esModule:{value:!0}});var h=(o=e("./../../../dom.js"))&&o.__esModule&&o||{default:o},a=((r=e("./border.js"))&&r.__esModule&&r||{default:r}).WalkontableBorder,l=((i=e("./cell/coords.js"))&&i.__esModule&&i||{default:i}).WalkontableCellCoords,u=((s=e("./cell/range.js"))&&s.__esModule&&s||{default:s}).WalkontableCellRange,d=function(e,t){this.settings=e,this.cellRange=t||null,this.instanceBorders={}};$traceurRuntime.createClass(d,{getBorder:function(e){if(this.instanceBorders[e.guid])return this.instanceBorders[e.guid];this.instanceBorders[e.guid]=new a(e,this.settings)},isEmpty:function(){return null===this.cellRange},add:function(e){this.isEmpty()?this.cellRange=new u(e,e,e):this.cellRange.expand(e)},replace:function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1},clear:function(){this.cellRange=null},getCorners:function(){var e=this.cellRange.getTopLeftCorner(),t=this.cellRange.getBottomRightCorner();return[e.row,e.col,t.row,t.col]},addClassAtCoords:function(e,t,n,o){var r=e.wtTable.getCell(new l(t,n));"object"==typeof r&&h.addClass(r,o)},draw:function(e){if(this.isEmpty()){var t;!this.settings.border||(t=this.getBorder(e))&&t.disappear()}else{for(var n,o,r,i=e.wtTable.getRenderedRowsCount(),s=e.wtTable.getRenderedColumnsCount(),a=this.getCorners(),l=0;l<s;l++)(o=e.wtTable.columnFilter.renderedToSource(l))>=a[1]&&o<=a[3]&&(r=e.wtTable.getColumnHeader(o))&&this.settings.highlightColumnClassName&&h.addClass(r,this.settings.highlightColumnClassName);for(var u,d=0;d<i;d++){(n=e.wtTable.rowFilter.renderedToSource(d))>=a[0]&&n<=a[2]&&(r=e.wtTable.getRowHeader(n))&&this.settings.highlightRowClassName&&h.addClass(r,this.settings.highlightRowClassName);for(var c=0;c<s;c++)o=e.wtTable.columnFilter.renderedToSource(c),n>=a[0]&&n<=a[2]&&o>=a[1]&&o<=a[3]?this.settings.className&&this.addClassAtCoords(e,n,o,this.settings.className):n>=a[0]&&n<=a[2]?this.settings.highlightRowClassName&&this.addClassAtCoords(e,n,o,this.settings.highlightRowClassName):o>=a[1]&&o<=a[3]&&this.settings.highlightColumnClassName&&this.addClassAtCoords(e,n,o,this.settings.highlightColumnClassName)}e.getSetting("onBeforeDrawBorders",a,this.settings.className),!this.settings.border||(u=this.getBorder(e))&&u.appear(a)}}},{}),window.WalkontableSelection=d},{"./../../../dom.js":27,"./border.js":2,"./cell/coords.js":5,"./cell/range.js":6}],19:[function(e,t,n){"use strict";var o;Object.defineProperties(n,{WalkontableSettings:{get:function(){return r}},__esModule:{value:!0}});var i=(o=e("./../../../dom.js"))&&o.__esModule&&o||{default:o},r=function(e,t){var r=this;for(var n in this.wot=e,this.instance=e,this.defaults={table:void 0,debug:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,data:void 0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,t,n){var o=r.getSetting("data",e,t);i.fastInnerText(n,null==o?"":o)},columnWidth:function(e){},rowHeight:function(e){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1},this.settings={},this.defaults)if(this.defaults.hasOwnProperty(n))if(void 0!==t[n])this.settings[n]=t[n];else{if(void 0===this.defaults[n])throw new Error('A required setting "'+n+'" was not provided');this.settings[n]=this.defaults[n]}};$traceurRuntime.createClass(r,{update:function(e,t){if(void 0===t)for(var n in e)e.hasOwnProperty(n)&&(this.settings[n]=e[n]);else this.settings[e]=t;return this.wot},getSetting:function(e,t,n,o,r){return"function"==typeof this.settings[e]?this.settings[e](t,n,o,r):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]},has:function(e){return!!this.settings[e]}},{}),window.WalkontableSettings=r},{"./../../../dom.js":27}],20:[function(e,t,n){"use strict";var o,r,i,s,a,l,u,d,c,h;Object.defineProperties(n,{WalkontableTable:{get:function(){return R}},__esModule:{value:!0}});var f=(o=e("./../../../dom.js"))&&o.__esModule&&o||{default:o},p=((r=e("./cell/coords.js"))&&r.__esModule&&r||{default:r}).WalkontableCellCoords,g=((i=e("./cell/range.js"))&&i.__esModule,((s=e("./filter/column.js"))&&s.__esModule&&s||{default:s}).WalkontableColumnFilter),m=((a=e("./overlay/corner.js"))&&a.__esModule&&a||{default:a}).WalkontableCornerOverlay,w=((l=e("./overlay/debug.js"))&&l.__esModule&&l||{default:l}).WalkontableDebugOverlay,v=((u=e("./overlay/left.js"))&&u.__esModule&&u||{default:u}).WalkontableLeftOverlay,y=((d=e("./filter/row.js"))&&d.__esModule&&d||{default:d}).WalkontableRowFilter,b=((c=e("./tableRenderer.js"))&&c.__esModule&&c||{default:c}).WalkontableTableRenderer,C=((h=e("./overlay/top.js"))&&h.__esModule&&h||{default:h}).WalkontableTopOverlay;function R(e,t){this.instance=e,this.TABLE=t,f.removeTextNodes(this.TABLE);var n,o,r,i,s=this.TABLE.parentNode;s&&1===s.nodeType&&f.hasClass(s,"wtHolder")||((n=document.createElement("DIV")).className="wtSpreader",s&&s.insertBefore(n,this.TABLE),n.appendChild(this.TABLE)),this.spreader=this.TABLE.parentNode,this.spreader.style.position="relative",(s=this.spreader.parentNode)&&1===s.nodeType&&f.hasClass(s,"wtHolder")||((o=document.createElement("DIV")).className="wtHider",s&&s.insertBefore(o,this.spreader),o.appendChild(this.spreader)),this.hider=this.spreader.parentNode,(s=this.hider.parentNode)&&1===s.nodeType&&f.hasClass(s,"wtHolder")||((r=document.createElement("DIV")).style.position="relative",r.className="wtHolder",s&&s.insertBefore(r,this.hider),e.cloneSource||(r.parentNode.className+="ht_master handsontable"),r.appendChild(this.hider)),this.holder=this.hider.parentNode,this.wtRootElement=this.holder.parentNode,this.alignOverlaysWithTrimmingContainer(),this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0],this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0],this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0],this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.instance.getSetting("columnHeaders").length&&(this.THEAD.childNodes.length||(i=document.createElement("TR"),this.THEAD.appendChild(i))),this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null}R.prototype.alignOverlaysWithTrimmingContainer=function(){var e=f.getTrimmingContainer(this.wtRootElement);this.isWorkingOnClone()||(this.holder.parentNode.style.position="relative",e!==window?(this.holder.style.width=f.getStyle(e,"width"),this.holder.style.height=f.getStyle(e,"height"),this.holder.style.overflow=""):(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible"))},R.prototype.isWorkingOnClone=function(){return!!this.instance.cloneSource},R.prototype.draw=function(e){var t,n;return this.isWorkingOnClone()||(this.holderOffset=f.offset(this.holder),e=this.instance.wtViewport.createRenderCalculators(e)),e?(this.isWorkingOnClone()||this.instance.wtViewport.createVisibleCalculators(),this.instance.wtOverlays&&this.instance.wtOverlays.refresh(!0)):(this.isWorkingOnClone()?this.tableOffset=this.instance.cloneSource.wtTable.tableOffset:this.tableOffset=f.offset(this.TABLE),t=this.instance.cloneOverlay instanceof w||this.instance.cloneOverlay instanceof C||this.instance.cloneOverlay instanceof m?0:this.instance.wtViewport.rowsRenderCalculator.startRow,n=this.instance.cloneOverlay instanceof w||this.instance.cloneOverlay instanceof v||this.instance.cloneOverlay instanceof m?0:this.instance.wtViewport.columnsRenderCalculator.startColumn,this.rowFilter=new y(t,this.instance.getSetting("totalRows"),this.instance.getSetting("columnHeaders").length),this.columnFilter=new g(n,this.instance.getSetting("totalColumns"),this.instance.getSetting("rowHeaders").length),this._doDraw(),this.alignOverlaysWithTrimmingContainer()),this.refreshSelections(e),this.isWorkingOnClone()||(this.instance.wtOverlays.topOverlay.resetFixedPosition(),this.instance.wtOverlays.leftOverlay.resetFixedPosition(),this.instance.wtOverlays.topLeftCornerOverlay&&this.instance.wtOverlays.topLeftCornerOverlay.resetFixedPosition()),this.instance.drawn=!0,this},R.prototype._doDraw=function(){new b(this).render()},R.prototype.removeClassFromCells=function(e){for(var t=this.TABLE.querySelectorAll("."+e),n=0,o=t.length;n<o;n++)f.removeClass(t[n],e)},R.prototype.refreshSelections=function(e){var t,n;if(this.instance.selections){if(n=this.instance.selections.length,e)for(t=0;t<n;t++)this.instance.selections[t].settings.className&&this.removeClassFromCells(this.instance.selections[t].settings.className),this.instance.selections[t].settings.highlightRowClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightRowClassName),this.instance.selections[t].settings.highlightColumnClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightColumnClassName);for(t=0;t<n;t++)this.instance.selections[t].draw(this.instance,e)}},R.prototype.getCell=function(e){if(this.isRowBeforeRenderedRows(e.row))return-1;if(this.isRowAfterRenderedRows(e.row))return-2;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e.row)];return t?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e.col)]:void 0},R.prototype.getColumnHeader=function(e,t){t=t||0;var n=this.THEAD.childNodes[t];if(n)return n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]},R.prototype.getRowHeader=function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return t?t.childNodes[0]:void 0},R.prototype.getCoords=function(e){var t=e.parentNode,n=f.index(t),n=t.parentNode===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(n):this.rowFilter.renderedToSource(n);return new p(n,this.columnFilter.visibleRowHeadedColumnToSourceColumn(e.cellIndex))},R.prototype.getTrForRow=function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]},R.prototype.getFirstRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.startRow},R.prototype.getFirstVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.startRow},R.prototype.getFirstRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.startColumn},R.prototype.getFirstVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.startColumn},R.prototype.getLastRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.endRow},R.prototype.getLastVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.endRow},R.prototype.getLastRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.endColumn},R.prototype.getLastVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.endColumn},R.prototype.isRowBeforeRenderedRows=function(e){return this.rowFilter.sourceToRendered(e)<0&&0<=e},R.prototype.isRowAfterViewport=function(e){return e>this.getLastVisibleRow()},R.prototype.isRowAfterRenderedRows=function(e){return e>this.getLastRenderedRow()},R.prototype.isColumnBeforeViewport=function(e){return this.columnFilter.sourceToRendered(e)<0&&0<=e},R.prototype.isColumnAfterViewport=function(e){return e>this.getLastVisibleColumn()},R.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.getLastRenderedRow()},R.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn},R.prototype.getRenderedColumnsCount=function(){return this.instance.cloneOverlay instanceof w?this.instance.getSetting("totalColumns"):this.instance.cloneOverlay instanceof v||this.instance.cloneOverlay instanceof m?this.instance.getSetting("fixedColumnsLeft"):this.instance.wtViewport.columnsRenderCalculator.count},R.prototype.getRenderedRowsCount=function(){return this.instance.cloneOverlay instanceof w?this.instance.getSetting("totalRows"):this.instance.cloneOverlay instanceof C||this.instance.cloneOverlay instanceof m?this.instance.getSetting("fixedRowsTop"):this.instance.wtViewport.rowsRenderCalculator.count},R.prototype.getVisibleRowsCount=function(){return this.instance.wtViewport.rowsVisibleCalculator.count},R.prototype.allRowsInViewport=function(){return this.instance.getSetting("totalRows")==this.getVisibleRowsCount()},R.prototype.getRowHeight=function(e){var t=this.instance.wtSettings.settings.rowHeight(e),n=this.instance.wtViewport.oversizedRows[e];return void 0!==n&&(t=t?Math.max(t,n):n),t},R.prototype.getColumnHeaderHeight=function(e){var t=this.instance.wtSettings.settings.defaultRowHeight,n=this.instance.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t},R.prototype.getVisibleColumnsCount=function(){return this.instance.wtViewport.columnsVisibleCalculator.count},R.prototype.allColumnsInViewport=function(){return this.instance.getSetting("totalColumns")==this.getVisibleColumnsCount()},R.prototype.getColumnWidth=function(e){var t=this.instance.wtSettings.settings.columnWidth;"function"==typeof t?t=t(e):"object"==typeof t&&(t=t[e]);var n=this.instance.wtViewport.oversizedCols[e];return void 0!==n&&(t=t?Math.max(t,n):n),t},R.prototype.getStretchedColumnWidth=function(e){var t,n=this.getColumnWidth(e)||this.instance.wtSettings.settings.defaultColumnWidth,o=this.instance.wtViewport.columnsRenderCalculator;return o&&(t=o.getStretchedColumnWidth(e,n))&&(n=t),n},window.WalkontableTable=R},{"./../../../dom.js":27,"./cell/coords.js":5,"./cell/range.js":6,"./filter/column.js":9,"./filter/row.js":10,"./overlay/corner.js":12,"./overlay/debug.js":13,"./overlay/left.js":14,"./overlay/top.js":15,"./tableRenderer.js":21}],21:[function(e,t,n){"use strict";var o;Object.defineProperties(n,{WalkontableTableRenderer:{get:function(){return r}},__esModule:{value:!0}});var u=(o=e("./../../../dom.js"))&&o.__esModule&&o||{default:o},s={},r=function(e){this.wtTable=e,this.wot=e.instance,this.instance=e.instance,this.rowFilter=e.rowFilter,this.columnFilter=e.columnFilter,this.TABLE=e.TABLE,this.THEAD=e.THEAD,this.TBODY=e.TBODY,this.COLGROUP=e.COLGROUP,this.rowHeaders=[],this.rowHeaderCount=0,this.columnHeaders=[],this.columnHeaderCount=0,this.fixedRowsTop=0};$traceurRuntime.createClass(r,{render:function(){this.wtTable.isWorkingOnClone()||this.wot.getSetting("beforeDraw",!0),this.rowHeaders=this.wot.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.wot.getSetting("fixedRowsTop"),this.columnHeaders=this.wot.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var e,t=this.wtTable.getRenderedColumnsCount(),n=this.wtTable.getRenderedRowsCount(),o=this.wot.getSetting("totalColumns"),r=this.wot.getSetting("totalRows"),i=!1;if(0<o&&(this.adjustAvailableNodes(),i=!0,this.renderColGroups(),this.renderColumnHeaders(),this.renderRows(r,n,t),this.wtTable.isWorkingOnClone()?this.adjustColumnHeaderHeights():(e=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnWidths(t)),i||this.adjustAvailableNodes(),this.removeRedundantRows(n),!this.wtTable.isWorkingOnClone()){if(this.markOversizedRows(),this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM(),e!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;for(var s=this.wtTable.getFirstRenderedColumn(),a=this.wtTable.getLastRenderedColumn(),l=s;l<a;l++){var u=this.wtTable.getStretchedColumnWidth(l),d=this.columnFilter.sourceToRendered(l);this.COLGROUP.childNodes[d+this.rowHeaderCount].style.width=u+"px"}}this.wot.getSetting("onDraw",!0)}},removeRedundantRows:function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},renderRows:function(e,t,n){for(var o=0,r=this.rowFilter.renderedToSource(o),i=this.wtTable.isWorkingOnClone();r<e&&0<=r;){if(1e3<o)throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.");if(void 0!==t&&o===t)break;var s,a=this.getOrCreateTrForRow(o,a);this.renderRowHeaders(r,a),this.adjustColumns(a,n+this.rowHeaderCount),this.renderCells(r,a,n),i||this.resetOversizedRow(r),a.firstChild&&(s=this.wot.wtTable.getRowHeight(r),a.firstChild.style.height=s?s+"px":""),o++,r=this.rowFilter.renderedToSource(o)}},resetOversizedRow:function(e){this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[e]&&(this.wot.wtViewport.oversizedRows[e]=void 0)},markOversizedRows:function(){var e,t,n,o,r,i=this.instance.wtTable.TBODY.childNodes.length;if(i*this.instance.wtSettings.settings.defaultRowHeight!=u.innerHeight(this.instance.wtTable.TBODY)-1)for(;i;)i--,n=this.instance.wtTable.rowFilter.renderedToSource(i),e=this.instance.wtTable.getRowHeight(n),t=(r=(o=this.instance.wtTable.getTrForRow(n)).querySelector("th"))?u.innerHeight(r):u.innerHeight(o)-1,(!e&&this.instance.wtSettings.settings.defaultRowHeight<t||e<t)&&(this.instance.wtViewport.oversizedRows[n]=t)},adjustColumnHeaderHeights:function(){for(var e=this.wot.getSetting("columnHeaders"),t=this.wot.wtTable.THEAD.childNodes,n=this.wot.wtViewport.oversizedColumnHeaders,o=0,r=e.length;o<r;o++)if(n[o]){if(0===t[o].childNodes.length)return;t[o].childNodes[0].style.height=n[o]+"px"}},markIfOversizedColumnHeader:function(e){for(var t,n,o,r=this.wot.getSetting("columnHeaders").length,i=this.wot.wtSettings.settings.defaultRowHeight,s=this.wot.wtTable.columnFilter.renderedToSource(e);r;)r--,t=this.wot.wtTable.getColumnHeaderHeight(r),(n=this.wot.wtTable.getColumnHeader(s,r))&&(o=u.innerHeight(n),(!t&&i<o||t<o)&&(this.wot.wtViewport.oversizedColumnHeaders[r]=o))},renderCells:function(e,t,n){for(var o,r,i,s,a,l=0;l<n;l++)r=this.columnFilter.renderedToSource(l),"TH"==(o=0===l?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]:o.nextSibling).nodeName&&(i=o,s=t,a=document.createElement("TD"),s.insertBefore(a,i),s.removeChild(i),o=a),u.hasClass(o,"hide")||(o.className=""),o.removeAttribute("style"),this.wot.wtSettings.settings.cellRenderer(e,r,o);return o},adjustColumnWidths:function(e){var t=0,n=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;n.offsetHeight<n.scrollHeight&&(t=u.getScrollbarWidth()),this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-t);for(var o=0;o<e;o++){var r=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(o));this.COLGROUP.childNodes[o+this.rowHeaderCount].style.width=r+"px"}},appendToTbody:function(e){this.TBODY.appendChild(e),this.wtTable.tbodyChildrenLength++},getOrCreateTrForRow:function(e,t){var n;return e>=this.wtTable.tbodyChildrenLength?(n=this.createRow(),this.appendToTbody(n)):n=0===e?this.TBODY.firstChild:t.nextSibling,n},createRow:function(){for(var e=document.createElement("TR"),t=0;t<this.rowHeaderCount;t++)e.appendChild(document.createElement("TH"));return e},renderRowHeader:function(e,t,n){n.className="",n.removeAttribute("style"),this.rowHeaders[t](e,n,t)},renderRowHeaders:function(e,t){for(var n,o,r,i=t.firstChild,s=0;s<this.rowHeaderCount;s++)i?"TD"==i.nodeName&&(n=i,o=t,r=document.createElement("TH"),o.insertBefore(r,n),o.removeChild(n),i=r):(i=document.createElement("TH"),t.appendChild(i)),this.renderRowHeader(e,s,i),i=i.nextSibling},adjustAvailableNodes:function(){this.adjustColGroups(),this.adjustThead()},renderColumnHeaders:function(){var e=this.wot.getOverlayName();if(this.columnHeaderCount){for(var t=this.wtTable.getRenderedColumnsCount(),n=0;n<this.columnHeaderCount;n++)for(var o=this.getTrForColumnHeaders(n),r=-1*this.rowHeaderCount;r<t;r++){var i=this.columnFilter.renderedToSource(r);this.renderColumnHeader(n,i,o.childNodes[r+this.rowHeaderCount]),s[e]||this.wtTable.isWorkingOnClone()||this.markIfOversizedColumnHeader(r)}s[e]=!0}},adjustColGroups:function(){for(var e=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<e+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>e+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--},adjustThead:function(){var e=this.wtTable.getRenderedColumnsCount(),t=this.THEAD.firstChild;if(this.columnHeaders.length){for(var n=0,o=this.columnHeaders.length;n<o;n++){for((t=this.THEAD.childNodes[n])||(t=document.createElement("TR"),this.THEAD.appendChild(t)),this.theadChildrenLength=t.childNodes.length;this.theadChildrenLength<e+this.rowHeaderCount;)t.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>e+this.rowHeaderCount;)t.removeChild(t.lastChild),this.theadChildrenLength--}var r=this.THEAD.childNodes.length;if(r>this.columnHeaders.length)for(var i=this.columnHeaders.length;i<r;i++)this.THEAD.removeChild(this.THEAD.lastChild)}else t&&u.empty(t)},getTrForColumnHeaders:function(e){return this.THEAD.childNodes[e]},renderColumnHeader:function(e,t,n){return n.className="",n.removeAttribute("style"),this.columnHeaders[e](t,n,e)},renderColGroups:function(){for(var e=0;e<this.wtTable.colgroupChildrenLength;e++)e<this.rowHeaderCount?u.addClass(this.COLGROUP.childNodes[e],"rowHeader"):u.removeClass(this.COLGROUP.childNodes[e],"rowHeader")},adjustColumns:function(e,t){for(var n=e.childNodes.length;n<t;){var o=document.createElement("TD");e.appendChild(o),n++}for(;t<n;)e.removeChild(e.lastChild),n--},removeRedundantColumns:function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}},{}),window.WalkontableTableRenderer=r},{"./../../../dom.js":27}],22:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{WalkontableViewport:{get:function(){return c}},__esModule:{value:!0}});var a=(o=e("./../../../dom.js"))&&o.__esModule&&o||{default:o},l=((r=e("./../../../eventManager.js"))&&r.__esModule&&r||{default:r}).eventManager,u=((i=e("./calculator/viewportColumns.js"))&&i.__esModule&&i||{default:i}).WalkontableViewportColumnsCalculator,d=((s=e("./calculator/viewportRows.js"))&&s.__esModule&&s||{default:s}).WalkontableViewportRowsCalculator,c=function(e){var t=this;this.wot=e,this.instance=this.wot,this.oversizedRows=[],this.oversizedCols=[],this.oversizedColumnHeaders=[],this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,l(e).addEventListener(window,"resize",function(){t.clientHeight=t.getWorkspaceHeight()})};$traceurRuntime.createClass(c,{getWorkspaceHeight:function(){var e=this.instance.wtOverlays.topOverlay.trimmingContainer;return e===window?document.documentElement.clientHeight:0<a.outerHeight(e)&&0<e.clientHeight?e.clientHeight:1/0},getWorkspaceWidth:function(){var e,t=this.instance.getSetting("totalColumns"),n=this.instance.wtOverlays.leftOverlay.trimmingContainer,o=this.instance.getSetting("stretchH"),r=document.documentElement.offsetWidth,i=Handsontable.freezeOverlays?Math.min(r-this.getWorkspaceOffset().left,r):Math.min(this.getContainerFillWidth(),r-this.getWorkspaceOffset().left,r);return n===window&&0<t&&this.sumColumnWidths(0,t-1)>i?document.documentElement.clientWidth:n===window||"scroll"!=(e=a.getStyle(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"))&&"hidden"!=e&&"auto"!=e?"none"!==o&&o?i:Math.max(i,a.outerWidth(this.instance.wtTable.TABLE)):Math.max(i,n.clientWidth)},hasVerticalScroll:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()},hasHorizontalScroll:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()},sumColumnWidths:function(e,t){for(var n=0,o=this.instance.wtSettings.defaultColumnWidth;e<t;)n+=this.wot.wtTable.getColumnWidth(e)||o,e++;return n},getContainerFillWidth:function(){if(this.containerWidth)return this.containerWidth;var e,t=this.instance.wtTable.holder,n=document.createElement("DIV");return n.style.width="100%",n.style.height="1px",t.appendChild(n),e=n.offsetWidth,this.containerWidth=e,t.removeChild(n),e},getWorkspaceOffset:function(){return a.offset(this.wot.wtTable.TABLE)},getWorkspaceActualHeight:function(){return a.outerHeight(this.wot.wtTable.TABLE)},getWorkspaceActualWidth:function(){return a.outerWidth(this.wot.wtTable.TABLE)||a.outerWidth(this.wot.wtTable.TBODY)||a.outerWidth(this.wot.wtTable.THEAD)},getColumnHeaderHeight:function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=a.outerHeight(this.wot.wtTable.THEAD)),this.columnHeaderHeight},getViewportHeight:function(){var e,t=this.getWorkspaceHeight();return t===1/0||0<(e=this.getColumnHeaderHeight())&&(t-=e),t},getRowHeaderWidth:function(){if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth)){var e=this.instance.getSetting("rowHeaders");if(e.length)for(var t=this.instance.wtTable.TABLE.querySelector("TH"),n=this.rowHeaderWidth=0,o=e.length;n<o;n++)t?(this.rowHeaderWidth+=a.outerWidth(t),t=t.nextSibling):this.rowHeaderWidth+=50;else this.rowHeaderWidth=0}return this.rowHeaderWidth},getViewportWidth:function(){var e,t=this.getWorkspaceWidth();return t!==1/0&&0<(e=this.getRowHeaderWidth())?t-e:t},createRowsCalculator:function(){var e,t,n,o,r=void 0!==arguments[0]&&arguments[0],i=this;return this.rowHeaderWidth=NaN,e=this.wot.wtSettings.settings.renderAllRows?1/0:this.getViewportHeight(),(t=a.getScrollTop(this.wot.wtOverlays.mainTableScrollableElement)-this.wot.wtOverlays.topOverlay.getTableParentOffset())<0&&(t=0),(n=this.wot.getSetting("fixedRowsTop"))&&(t+=o=this.wot.wtOverlays.topOverlay.sumCellSizes(0,n),e-=o),new d(e,t,this.wot.getSetting("totalRows"),function(e){return i.wot.wtTable.getRowHeight(e)},r?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,r)},createColumnsCalculator:function(){var e,t,n,o=void 0!==arguments[0]&&arguments[0],r=this,i=this.getViewportWidth();return this.columnHeaderHeight=NaN,(e=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset())<0&&(e=0),(t=this.wot.getSetting("fixedColumnsLeft"))&&(e+=n=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,t),i-=n),this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(i-=a.getScrollbarWidth()),new u(i,e,this.wot.getSetting("totalColumns"),function(e){return r.wot.wtTable.getColumnWidth(e)},o?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,o,this.wot.getSetting("stretchH"))},createRenderCalculators:function(){var e,t,n=void 0!==arguments[0]&&arguments[0];return n&&(e=this.createRowsCalculator(!0),t=this.createColumnsCalculator(!0),this.areAllProposedVisibleRowsAlreadyRendered(e)&&this.areAllProposedVisibleColumnsAlreadyRendered(t)||(n=!1)),n||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n},createVisibleCalculators:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0),this.columnsVisibleCalculator=this.createColumnsCalculator(!0)},areAllProposedVisibleRowsAlreadyRendered:function(e){return!!this.rowsVisibleCalculator&&(!(e.startRow<this.rowsRenderCalculator.startRow||e.startRow===this.rowsRenderCalculator.startRow&&0<e.startRow)&&!(e.endRow>this.rowsRenderCalculator.endRow||e.endRow===this.rowsRenderCalculator.endRow&&e.endRow<this.wot.getSetting("totalRows")-1))},areAllProposedVisibleColumnsAlreadyRendered:function(e){return!!this.columnsVisibleCalculator&&(!(e.startColumn<this.columnsRenderCalculator.startColumn||e.startColumn===this.columnsRenderCalculator.startColumn&&0<e.startColumn)&&!(e.endColumn>this.columnsRenderCalculator.endColumn||e.endColumn===this.columnsRenderCalculator.endColumn&&e.endColumn<this.wot.getSetting("totalColumns")-1))}},{}),window.WalkontableViewport=c},{"./../../../dom.js":27,"./../../../eventManager.js":41,"./calculator/viewportColumns.js":3,"./calculator/viewportRows.js":4}],23:[function(e,t,n){"use strict";var o,r,i,s,a,l,u,d,c,h,f,p,g=Handsontable.version,m=Handsontable.buildDate;window.Handsontable=function e(t,n){var o=new e.Core(t,n||{});return o.init(),o},Handsontable.version=g,Handsontable.buildDate=m,(o=e("./shims/array.filter.js"))&&o.__esModule,(r=e("./shims/array.indexOf.js"))&&r.__esModule,(i=e("./shims/array.isArray.js"))&&i.__esModule,(s=e("./shims/classes.js"))&&s.__esModule,(a=e("./shims/object.keys.js"))&&a.__esModule,(l=e("./shims/string.trim.js"))&&l.__esModule,(u=e("./shims/weakmap.js"))&&u.__esModule,Handsontable.plugins={};var w=((d=e("./pluginHooks.js"))&&d.__esModule&&d||{default:d}).Hooks;Handsontable.hooks||(Handsontable.hooks=new w),(c=e("./core.js"))&&c.__esModule,(h=e("./renderers/_cellDecorator.js"))&&h.__esModule,(f=e("./cellTypes.js"))&&f.__esModule,(p=e("./../plugins/jqueryHandsontable.js"))&&p.__esModule},{"./../plugins/jqueryHandsontable.js":1,"./cellTypes.js":24,"./core.js":25,"./pluginHooks.js":44,"./renderers/_cellDecorator.js":71,"./shims/array.filter.js":78,"./shims/array.indexOf.js":79,"./shims/array.isArray.js":80,"./shims/classes.js":81,"./shims/object.keys.js":82,"./shims/string.trim.js":83,"./shims/weakmap.js":84}],24:[function(e,t,n){"use strict";var o,r,i,s,a,l,u,d,c,h,f,p,g,m,w,v,y,b,C,R,S,E,T=(o=e("./helpers.js"))&&o.__esModule&&o||{default:o},_=((r=e("./editors.js"))&&r.__esModule&&r||{default:r}).getEditorConstructor,H=((i=e("./renderers.js"))&&i.__esModule&&i||{default:i}).getRenderer;(s=e("./editors/autocompleteEditor.js"))&&s.__esModule,(a=e("./editors/checkboxEditor.js"))&&a.__esModule,(l=e("./editors/dateEditor.js"))&&l.__esModule,(u=e("./editors/dropdownEditor.js"))&&u.__esModule,(d=e("./editors/handsontableEditor.js"))&&d.__esModule,(c=e("./editors/mobileTextEditor.js"))&&c.__esModule,(h=e("./editors/numericEditor.js"))&&h.__esModule,(f=e("./editors/passwordEditor.js"))&&f.__esModule,(p=e("./editors/selectEditor.js"))&&p.__esModule,(g=e("./editors/textEditor.js"))&&g.__esModule,(m=e("./renderers/autocompleteRenderer.js"))&&m.__esModule,(w=e("./renderers/checkboxRenderer.js"))&&w.__esModule,(v=e("./renderers/htmlRenderer.js"))&&v.__esModule,(y=e("./renderers/numericRenderer.js"))&&y.__esModule,(b=e("./renderers/passwordRenderer.js"))&&b.__esModule,(C=e("./renderers/textRenderer.js"))&&C.__esModule,(R=e("./validators/autocompleteValidator.js"))&&R.__esModule,(S=e("./validators/dateValidator.js"))&&S.__esModule,(E=e("./validators/numericValidator.js"))&&E.__esModule;Handsontable.mobileBrowser=T.isMobileBrowser(),Handsontable.AutocompleteCell={editor:_("autocomplete"),renderer:H("autocomplete"),validator:Handsontable.AutocompleteValidator},Handsontable.CheckboxCell={editor:_("checkbox"),renderer:H("checkbox")},Handsontable.TextCell={editor:Handsontable.mobileBrowser?_("mobile"):_("text"),renderer:H("text")},Handsontable.NumericCell={editor:_("numeric"),renderer:H("numeric"),validator:Handsontable.NumericValidator,dataType:"number"},Handsontable.DateCell={editor:_("date"),validator:Handsontable.DateValidator,renderer:H("autocomplete")},Handsontable.HandsontableCell={editor:_("handsontable"),renderer:H("autocomplete")},Handsontable.PasswordCell={editor:_("password"),renderer:H("password"),copyable:!1},Handsontable.DropdownCell={editor:_("dropdown"),renderer:H("autocomplete"),validator:Handsontable.AutocompleteValidator},Handsontable.cellTypes={text:Handsontable.TextCell,date:Handsontable.DateCell,numeric:Handsontable.NumericCell,checkbox:Handsontable.CheckboxCell,autocomplete:Handsontable.AutocompleteCell,handsontable:Handsontable.HandsontableCell,password:Handsontable.PasswordCell,dropdown:Handsontable.DropdownCell},Handsontable.cellLookup={validator:{numeric:Handsontable.NumericValidator,autocomplete:Handsontable.AutocompleteValidator}}},{"./editors.js":29,"./editors/autocompleteEditor.js":31,"./editors/checkboxEditor.js":32,"./editors/dateEditor.js":33,"./editors/dropdownEditor.js":34,"./editors/handsontableEditor.js":35,"./editors/mobileTextEditor.js":36,"./editors/numericEditor.js":37,"./editors/passwordEditor.js":38,"./editors/selectEditor.js":39,"./editors/textEditor.js":40,"./helpers.js":42,"./renderers.js":70,"./renderers/autocompleteRenderer.js":72,"./renderers/checkboxRenderer.js":73,"./renderers/htmlRenderer.js":74,"./renderers/numericRenderer.js":75,"./renderers/passwordRenderer.js":76,"./renderers/textRenderer.js":77,"./validators/autocompleteValidator.js":86,"./validators/dateValidator.js":87,"./validators/numericValidator.js":88}],25:[function(e,t,n){"use strict";var o,r,i,s,a,l,u,d,c,h,f,p,v=(o=e("./dom.js"))&&o.__esModule&&o||{default:o},k=(r=e("./helpers.js"))&&r.__esModule&&r||{default:r},y=((i=e("numeral"))&&i.__esModule&&i||{default:i}).default,b=((s=e("./dataMap.js"))&&s.__esModule&&s||{default:s}).DataMap,C=((a=e("./editorManager.js"))&&a.__esModule&&a||{default:a}).EditorManager,R=((l=e("./eventManager.js"))&&l.__esModule&&l||{default:l}).eventManager,S=((u=e("./plugins.js"))&&u.__esModule&&u||{default:u}).getPlugin,E=((d=e("./renderers.js"))&&d.__esModule&&d||{default:d}).getRenderer,T=((c=e("./tableView.js"))&&c.__esModule&&c||{default:c}).TableView,M=((h=e("./3rdparty/walkontable/src/cell/coords.js"))&&h.__esModule&&h||{default:h}).WalkontableCellCoords,O=((f=e("./3rdparty/walkontable/src/cell/range.js"))&&f.__esModule&&f||{default:f}).WalkontableCellRange;(p=e("./3rdparty/walkontable/src/selection.js"))&&p.__esModule;Handsontable.activeGuid=null,Handsontable.Core=function(e,t){var _,h,c,f,n,H=this,u=function(){},o=R(H);function d(){var e=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==e&&(e=!0,this.onQueueEmpty())}}}function p(o,t,n){var r=new d;r.onQueueEmpty=function(){var e;o.length&&("function"==typeof(e=Handsontable.hooks.run(H,"beforeChange",o,t))?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):!1===e&&o.splice(0,o.length));n()};for(var e,i,s,a,l,u=o.length-1;0<=u;u--){null===o[u]?o.splice(u,1):(e=o[u][0],i=h.propToCol(o[u][1]),s=H.runHooks("modifyCol",i),"numeric"===(a=H.getCellMeta(e,s)).type&&"string"==typeof o[u][3]&&0<o[u][3].length&&(/^-?[\d\s]*(\.|\,)?\d*$/.test(o[u][3])||a.format)&&(l=o[u][3].length,void 0===a.language||o[u][3].indexOf(".")===l-3&&-1===o[u][3].indexOf(",")?y.language("en"):y.language(a.language),y.validate(o[u][3])&&(o[u][3]=y().unformat(o[u][3]))),H.getCellValidator(a)&&(r.addValidatorToQueue(),H.validateCell(o[u][3],a,function(t,n){return function(e){if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&!1===n.allowInvalid&&(o.splice(t,1),n.valid=!0,--t),r.removeValidatorFormQueue()}}(u,a),t)))}r.checkIfQueueIsEmpty()}function g(e,t){var n=e.length-1;if(!(n<0)){for(;0<=n;n--)if(null!==e[n]){if(null!=e[n][2]||null!=e[n][3]){if(_.settings.allowInsertRow)for(;e[n][0]>H.countRows()-1;)h.createRow();if("array"===H.dataType&&_.settings.allowInsertColumn)for(;h.propToCol(e[n][1])>H.countCols()-1;)h.createCol();h.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1);H.forceFullRender=!0,c.adjustRowsAndCols(),Handsontable.hooks.run(H,"beforeChangeRender",e,t),f.refreshBorders(null,!0),Handsontable.hooks.run(H,"afterChange",e,t||"edit")}}function m(e,t,n){return"object"==typeof e?e:[[e,t,n]]}function w(e){if(e.hasOwnProperty("type")){var t,n={};if("object"==typeof e.type)t=e.type;else if("string"==typeof e.type&&void 0===(t=Handsontable.cellTypes[e.type]))throw new Error('You declared cell type "'+e.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var o in t)t.hasOwnProperty(o)&&!e.hasOwnProperty(o)&&(n[o]=t[o]);return n}}k.extend(u.prototype,D.prototype),k.extend(u.prototype,t),k.extend(u.prototype,w(t)),this.rootElement=e,this.isHotTableEnv=v.isChildOfWebComponentTable(this.rootElement),Handsontable.eventManager.isHotTableEnv=this.isHotTableEnv,this.container=document.createElement("DIV"),e.insertBefore(this.container,e.firstChild),this.guid="ht_"+k.randomString(),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid),_={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new u,selRange:null,isPopulated:null,scrollable:null,firstRun:!0},c={alter:function(e,t,n,o,r){var i,s;switch(n=n||1,e){case"insert_row":if(H.getSettings().maxRows===H.countRows())return;(s=h.createRow(t,n))&&(f.isSelected()&&_.selRange.from.row>=t?(_.selRange.from.row=_.selRange.from.row+s,f.transformEnd(s,0)):f.refreshBorders());break;case"insert_col":(s=h.createCol(t,n))&&(Array.isArray(H.getSettings().colHeaders)&&((i=[t,0]).length+=s,Array.prototype.splice.apply(H.getSettings().colHeaders,i)),f.isSelected()&&_.selRange.from.col>=t?(_.selRange.from.col=_.selRange.from.col+s,f.transformEnd(0,s)):f.refreshBorders());break;case"remove_row":t=H.runHooks("modifyCol",t),h.removeRow(t,n),_.cellSettings.splice(t,n);var a=H.getSettings().fixedRowsTop;t+1<=a&&(H.getSettings().fixedRowsTop-=Math.min(n,a-t)),c.adjustRowsAndCols(),f.refreshBorders();break;case"remove_col":h.removeCol(t,n);for(var l=0,u=h.getAll().length;l<u;l++)l in _.cellSettings&&_.cellSettings[l].splice(t,n);var d=H.getSettings().fixedColumnsLeft;t+1<=d&&(H.getSettings().fixedColumnsLeft-=Math.min(n,d-t)),Array.isArray(H.getSettings().colHeaders)&&(void 0===t&&(t=-1),H.getSettings().colHeaders.splice(t,n)),c.adjustRowsAndCols(),f.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"')}r||c.adjustRowsAndCols()},adjustRowsAndCols:function(){if(_.settings.minRows){var e=H.countRows();if(e<_.settings.minRows)for(var t=0,n=_.settings.minRows;t<n-e;t++)h.createRow(H.countRows(),1,!0)}if(_.settings.minSpareRows){var o=H.countEmptyRows(!0);if(o<_.settings.minSpareRows)for(;o<_.settings.minSpareRows&&H.countRows()<_.settings.maxRows;o++)h.createRow(H.countRows(),1,!0)}var r;if((_.settings.minCols||_.settings.minSpareCols)&&(r=H.countEmptyCols(!0)),_.settings.minCols&&!_.settings.columns&&H.countCols()<_.settings.minCols)for(;H.countCols()<_.settings.minCols;r++)h.createCol(H.countCols(),1,!0);if(_.settings.minSpareCols&&!_.settings.columns&&"array"===H.dataType&&r<_.settings.minSpareCols)for(;r<_.settings.minSpareCols&&H.countCols()<_.settings.maxCols;r++)h.createCol(H.countCols(),1,!0);var i,s,a,l,u,d=H.countRows(),c=H.countCols();0!==d&&0!==c||f.deselect(),f.isSelected()&&(i=!1,s=_.selRange.from.row,a=_.selRange.from.col,l=_.selRange.to.row,u=_.selRange.to.col,d-1<s?(i=!0,(s=d-1)<l&&(l=s)):d-1<l&&(i=!0,(l=d-1)<s&&(s=l)),c-1<a?(i=!0,(a=c-1)<u&&(u=a)):c-1<u&&(i=!0,(u=c-1)<a&&(a=u)),i&&H.selectCell(s,a,l,u)),H.view&&H.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(e,t,n,o,r,i,s){var a,l,u,d,c,h,f,p=[],g={},m=t.length;if(0===m)return!1;switch(r){case"shift_down":for(d=n?n.col-e.col+1:0,c=n?n.row-e.row+1:0,l=0,u=(t=k.translateRowsToColumns(t)).length,h=Math.max(u,d);l<h;l++)if(l<u){for(a=0,m=t[l].length;a<c-m;a++)t[l].push(t[l][a%m]);t[l].unshift(e.col+l,e.row,0),H.spliceCol.apply(H,t[l])}else t[l%u][0]=e.col+l,H.spliceCol.apply(H,t[l%u]);break;case"shift_right":for(d=n?n.col-e.col+1:0,c=n?n.row-e.row+1:0,a=0,m=t.length,f=Math.max(m,c);a<f;a++)if(a<m){for(l=0,u=t[a].length;l<d-u;l++)t[a].push(t[a][l%u]);t[a].unshift(e.row+a,e.col,0),H.spliceRow.apply(H,t[a])}else t[a%m][0]=e.row+a,H.spliceRow.apply(H,t[a%m]);break;case"overwrite":default:g.row=e.row,g.col=e.col;var w,v,y,b,C,R,S={row:0,col:0},E={row:n&&e?n.row-e.row+1:1,col:n&&e?n.col-e.col+1:1},T=!0;for(-1!==["up","left"].indexOf(i)?S={row:Math.ceil(E.row/m)||1,col:Math.ceil(E.col/t[0].length)||1}:-1!==["down","right"].indexOf(i)&&(S={row:1,col:1}),a=0;a<m&&!(n&&g.row>n.row||!_.settings.allowInsertRow&&g.row>H.countRows()-1||g.row>=_.settings.maxRows);a++){for(g.col=e.col,u=t[a]?t[a].length:0,l=0;l<u&&!(n&&g.col>n.col||!_.settings.allowInsertColumn&&g.col>H.countCols()-1||g.col>=_.settings.maxCols);l++){H.getCellMeta(g.row,g.col).readOnly||(v=t[a][l],y=H.getDataAtCell(g.row,g.col),b={row:a,col:l},"autofill"===o&&(w=H.runHooks("beforeAutofillInsidePopulate",b,i,t,s,S,E))&&(S=void 0!==w.iterators?w.iterators:S,v=void 0!==w.value?w.value:v),null!==v&&"object"==typeof v?null===y||"object"!=typeof y?T=!1:(R=Handsontable.helper.duckSchema(y[0]||y),C=Handsontable.helper.duckSchema(v[0]||v),Handsontable.helper.isObjectEquals(R,C)?v=Handsontable.helper.deepClone(v):T=!1):null!==y&&"object"==typeof y&&(T=!1),T&&p.push([g.row,g.col,v]),T=!0),g.col++,n&&l===u-1&&((l=-1)!==["down","right"].indexOf(i)?S.col++:-1!==["up","left"].indexOf(i)&&1<S.col&&S.col--)}g.row++,S.col=1,n&&a===m-1&&((a=-1)!==["down","right"].indexOf(i)?S.row++:-1!==["up","left"].indexOf(i)&&1<S.row&&S.row--)}H.setDataAtCell(p,null,null,o||"populateFromArray")}}},this.selection=f={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(e,t){H.selection.selectedHeader.rows=e,H.selection.selectedHeader.cols=t},begin:function(){H.selection.inProgress=!0},finish:function(){var e=H.getSelected();Handsontable.hooks.run(H,"afterSelectionEnd",e[0],e[1],e[2],e[3]),Handsontable.hooks.run(H,"afterSelectionEndByProp",e[0],H.colToProp(e[1]),e[2],H.colToProp(e[3])),H.selection.inProgress=!1},isInProgress:function(){return H.selection.inProgress},setRangeStart:function(e,t){Handsontable.hooks.run(H,"beforeSetRangeStart",e),_.selRange=new O(e,e,e),f.setRangeEnd(e,null,t)},setRangeEnd:function(e,t,n){var o;null!==_.selRange&&(Handsontable.hooks.run(H,"beforeSetRangeEnd",e),H.selection.begin(),_.selRange.to=new M(e.row,e.col),_.settings.multiSelect||(_.selRange.from=e),H.view.wt.selections.current.clear(),"string"==typeof(o=H.getCellMeta(_.selRange.highlight.row,_.selRange.highlight.col).disableVisualSelection)&&(o=[o]),(!1===o||Array.isArray(o)&&-1===o.indexOf("current"))&&H.view.wt.selections.current.add(_.selRange.highlight),H.view.wt.selections.area.clear(),(!1===o||Array.isArray(o)&&-1===o.indexOf("area"))&&f.isMultiple()&&(H.view.wt.selections.area.add(_.selRange.from),H.view.wt.selections.area.add(_.selRange.to)),(_.settings.currentRowClassName||_.settings.currentColClassName)&&(H.view.wt.selections.highlight.clear(),H.view.wt.selections.highlight.add(_.selRange.from),H.view.wt.selections.highlight.add(_.selRange.to)),Handsontable.hooks.run(H,"afterSelection",_.selRange.from.row,_.selRange.from.col,_.selRange.to.row,_.selRange.to.col),Handsontable.hooks.run(H,"afterSelectionByProp",_.selRange.from.row,h.colToProp(_.selRange.from.col),_.selRange.to.row,h.colToProp(_.selRange.to.col)),!1!==t&&H.view.mainViewIsActive()&&(_.selRange.from&&!f.isMultiple()?H.view.scrollViewport(_.selRange.from):H.view.scrollViewport(e)),f.refreshBorders(null,n))},refreshBorders:function(e,t){t||n.destroyEditor(e),H.view.render(),f.isSelected()&&!t&&n.prepareEditor()},isMultiple:function(){var e=!(_.selRange.to.col===_.selRange.from.col&&_.selRange.to.row===_.selRange.from.row),t=Handsontable.hooks.run(H,"afterIsMultipleSelection",e);if(e)return t},transformStart:function(e,t,n,o){var r,i,s,a=new M(e,t),l=0,u=0;H.runHooks("modifyTransformStart",a),r=H.countRows(),i=H.countCols(),_.selRange.highlight.row+e>r-1?n&&0<_.settings.minSpareRows?(H.alter("insert_row",r),r=H.countRows()):_.settings.autoWrapCol&&(a.row=1-r,a.col=_.selRange.highlight.col+a.col==i-1?1-i:1):_.settings.autoWrapCol&&_.selRange.highlight.row+a.row<0&&0<=_.selRange.highlight.col+a.col&&(a.row=r-1,a.col=_.selRange.highlight.col+a.col==0?i-1:-1),_.selRange.highlight.col+a.col>i-1?n&&0<_.settings.minSpareCols?(H.alter("insert_col",i),i=H.countCols()):_.settings.autoWrapRow&&(a.row=_.selRange.highlight.row+a.row==r-1?1-r:1,a.col=1-i):_.settings.autoWrapRow&&_.selRange.highlight.col+a.col<0&&0<=_.selRange.highlight.row+a.row&&(a.row=_.selRange.highlight.row+a.row==0?r-1:-1,a.col=i-1),(s=new M(_.selRange.highlight.row+a.row,_.selRange.highlight.col+a.col)).row<0?(l=-1,s.row=0):0<s.row&&s.row>=r&&(l=1,s.row=r-1),s.col<0?(u=-1,s.col=0):0<s.col&&s.col>=i&&(u=1,s.col=i-1),H.runHooks("afterModifyTransformStart",s,l,u),f.setRangeStart(s,o)},transformEnd:function(e,t){var n,o,r,i=new M(e,t),s=0,a=0;H.runHooks("modifyTransformEnd",i),n=H.countRows(),o=H.countCols(),(r=new M(_.selRange.to.row+i.row,_.selRange.to.col+i.col)).row<0?(s=-1,r.row=0):0<r.row&&r.row>=n&&(s=1,r.row=n-1),r.col<0?(a=-1,r.col=0):0<r.col&&r.col>=o&&(a=1,r.col=o-1),H.runHooks("afterModifyTransformEnd",r,s,a),f.setRangeEnd(r,!0)},isSelected:function(){return null!==_.selRange},inInSelection:function(e){return!!f.isSelected()&&_.selRange.includes(e)},deselect:function(){f.isSelected()&&(H.selection.inProgress=!1,_.selRange=null,H.view.wt.selections.current.clear(),H.view.wt.selections.area.clear(),(_.settings.currentRowClassName||_.settings.currentColClassName)&&H.view.wt.selections.highlight.clear(),n.destroyEditor(),f.refreshBorders(),Handsontable.hooks.run(H,"afterDeselect"))},selectAll:function(){_.settings.multiSelect&&(f.setRangeStart(new M(0,0)),f.setRangeEnd(new M(H.countRows()-1,H.countCols()-1),!1))},empty:function(){if(f.isSelected()){for(var e,t=_.selRange.getTopLeftCorner(),n=_.selRange.getBottomRightCorner(),o=[],r=t.row;r<=n.row;r++)for(e=t.col;e<=n.col;e++)H.getCellMeta(r,e).readOnly||o.push([r,e,""]);H.setDataAtCell(o)}}},this.init=function(){Handsontable.hooks.run(H,"beforeInit"),Handsontable.mobileBrowser&&v.addClass(H.rootElement,"mobile"),this.updateSettings(_.settings,!0),this.view=new T(this),n=new C(H,_,f,h),this.forceFullRender=!0,this.view.render(),"object"==typeof _.firstRun&&(Handsontable.hooks.run(H,"afterChange",_.firstRun[0],_.firstRun[1]),_.firstRun=!1),Handsontable.hooks.run(H,"afterInit")},this.validateCell=function(t,r,i,n){var o,e=H.getCellValidator(r);function s(e){var t=r.col,n=r.row,o=H.getCell(n,t,!0);o&&H.view.wt.wtSettings.settings.cellRenderer(n,t,o),i(e)}"[object RegExp]"===Object.prototype.toString.call(e)&&(o=e,e=function(e,t){t(o.test(e))}),"function"==typeof e?(t=Handsontable.hooks.run(H,"beforeValidate",t,r.row,r.prop,n),H._registerTimeout(setTimeout(function(){e.call(r,t,function(e){e=Handsontable.hooks.run(H,"afterValidate",e,t,r.row,r.prop,n),s(r.valid=e),Handsontable.hooks.run(H,"postAfterValidate",e,t,r.row,r.prop,n)})},0))):(r.valid=!0,s(r.valid))},this.setDataAtCell=function(e,t,n,o){for(var r,i=m(e,t,n),s=[],a=0,l=i.length;a<l;a++){if("object"!=typeof i[a])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof i[a][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");r=h.colToProp(i[a][1]),s.push([i[a][0],r,h.get(i[a][0],r),i[a][2]])}o||"object"!=typeof e||(o=t),p(s,o,function(){g(s,o)})},this.setDataAtRowProp=function(e,t,n,o){for(var r=m(e,t,n),i=[],s=0,a=r.length;s<a;s++)i.push([r[s][0],r[s][1],h.get(r[s][0],r[s][1]),r[s][2]]);o||"object"!=typeof e||(o=t),p(i,o,function(){g(i,o)})},this.listen=function(){Handsontable.activeGuid=H.guid,document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()},this.unlisten=function(){Handsontable.activeGuid=null},this.isListening=function(){return Handsontable.activeGuid===H.guid},this.destroyEditor=function(e){f.refreshBorders(e)},this.populateFromArray=function(e,t,n,o,r,i,s,a,l){var u;if("object"!=typeof n||"object"!=typeof n[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");return u="number"==typeof o?new M(o,r):null,c.populateFromArray(new M(e,t),n,u,i,s,a,l)},this.spliceCol=function(e,t,n){return h.spliceCol.apply(h,arguments)},this.spliceRow=function(e,t,n){return h.spliceRow.apply(h,arguments)},this.getSelected=function(){if(f.isSelected())return[_.selRange.from.row,_.selRange.from.col,_.selRange.to.row,_.selRange.to.col]},this.getSelectedRange=function(){if(f.isSelected())return _.selRange},this.render=function(){H.view&&(H.forceFullRender=!0,f.refreshBorders(null,!0))},this.loadData=function(e){if("object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("loadData only accepts array of objects or array of arrays ("+typeof e+" given)");var t;e=[];for(var n=0,o=_.settings.startRows;n<o;n++){t=[];for(var r=0,i=_.settings.startCols;r<i;r++)t.push(null);e.push(t)}}_.isPopulated=!1,u.prototype.data=e,Array.isArray(_.settings.dataSchema)||Array.isArray(e[0])?H.dataType="array":"function"==typeof _.settings.dataSchema?H.dataType="function":H.dataType="object",h=new b(H,_,u),_.cellSettings.length=0,c.adjustRowsAndCols(),Handsontable.hooks.run(H,"afterLoadData"),_.firstRun?_.firstRun=[null,"loadData"]:(Handsontable.hooks.run(H,"afterChange",null,"loadData"),H.render()),_.isPopulated=!0},this.getData=function(e,t,n,o){return void 0===e?h.getAll():h.getRange(new M(e,t),new M(n,o),h.DESTINATION_RENDERER)},this.getCopyableData=function(e,t,n,o){return h.getCopyableText(new M(e,t),new M(n,o))},this.getSchema=function(){return h.getSchema()},this.updateSettings=function(e,t){var n,o,r,i;if(void 0!==e.rows)throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if(void 0!==e.cols)throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");for(l in e)"data"!==l&&(-1<Handsontable.hooks.getRegistered().indexOf(l)?"function"!=typeof e[l]&&!Array.isArray(e[l])||H.addHook(l,e[l]):!t&&e.hasOwnProperty(l)&&(u.prototype[l]=e[l]));if(void 0===e.data&&void 0===_.settings.data?H.loadData(null):void 0!==e.data?H.loadData(e.data):void 0!==e.columns&&h.createMap(),n=H.countCols(),(_.cellSettings.length=0)<n)for(var s,a,l=0;l<n;l++)_.columnSettings[l]=k.columnFactory(u,_.columnsSettingConflicts),s=_.columnSettings[l].prototype,u.prototype.columns&&(a=u.prototype.columns[l],k.extend(s,a),k.extend(s,w(a)));if(void 0!==e.cell)for(l in e.cell){e.cell.hasOwnProperty(l)&&(o=e.cell[l],H.setCellMetaObject(o.row,o.col,o))}Handsontable.hooks.run(H,"afterCellMetaReset"),void 0!==e.className&&(u.prototype.className&&v.removeClass(H.rootElement,u.prototype.className),e.className&&v.addClass(H.rootElement,e.className)),void 0!==e.height&&("function"==typeof(r=e.height)&&(r=r()),H.rootElement.style.height=r+"px"),void 0!==e.width&&("function"==typeof(i=e.width)&&(i=i()),H.rootElement.style.width=i+"px"),r&&(H.rootElement.style.overflow="hidden"),t||Handsontable.hooks.run(H,"afterUpdateSettings"),c.adjustRowsAndCols(),H.view&&!_.firstRun&&(H.forceFullRender=!0,f.refreshBorders(null,!0))},this.getValue=function(){var e=H.getSelected();if(u.prototype.getValue){if("function"==typeof u.prototype.getValue)return u.prototype.getValue.call(H);if(e)return H.getData()[e[0]][u.prototype.getValue]}else if(e)return H.getDataAtCell(e[0],e[1])},this.getSettings=function(){return _.settings},this.clear=function(){f.selectAll(),f.empty()},this.alter=function(e,t,n,o,r){c.alter(e,t,n,o,r)},this.getCell=function(e,t,n){return H.view.getCellAtCoords(new M(e,t),n)},this.getCoords=function(e){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,e)},this.colToProp=function(e){return h.colToProp(e)},this.propToCol=function(e){return h.propToCol(e)},this.getDataAtCell=function(e,t){return h.get(e,h.colToProp(t))},this.getDataAtRowProp=function(e,t){return h.get(e,t)},this.getDataAtCol=function(e){var t=[];return t.concat.apply(t,h.getRange(new M(0,e),new M(_.settings.data.length-1,e),h.DESTINATION_RENDERER))},this.getDataAtProp=function(e){var t=[],n=h.getRange(new M(0,h.propToCol(e)),new M(_.settings.data.length-1,h.propToCol(e)),h.DESTINATION_RENDERER);return t.concat.apply(t,n)},this.getSourceDataAtCol=function(e){for(var t=[],n=_.settings.data,o=0;o<n.length;o++)t.push(n[o][e]);return t},this.getSourceDataAtRow=function(e){return _.settings.data[e]},this.getDataAtRow=function(e){return h.getRange(new M(e,0),new M(e,this.countCols()-1),h.DESTINATION_RENDERER)[0]},this.removeCellMeta=function(e,t,n){null!=H.getCellMeta(e,t)[n]&&delete _.cellSettings[e][t][n]},this.setCellMetaObject=function(e,t,n){if("object"==typeof n)for(var o in n){var r;n.hasOwnProperty(o)&&(r=n[o],this.setCellMeta(e,t,o,r))}},this.setCellMeta=function(e,t,n,o){_.cellSettings[e]||(_.cellSettings[e]=[]),_.cellSettings[e][t]||(_.cellSettings[e][t]=new _.columnSettings[t]),_.cellSettings[e][t][n]=o,Handsontable.hooks.run(H,"afterSetCellMeta",e,t,n,o)},this.getCellMeta=function(e,t){var n,o,r,i,s=h.colToProp(t);return o=e,e=Handsontable.hooks.run(H,"modifyRow",o),r=t,t=Handsontable.hooks.run(H,"modifyCol",r),_.columnSettings[t]||(_.columnSettings[t]=k.columnFactory(u,_.columnsSettingConflicts)),_.cellSettings[e]||(_.cellSettings[e]=[]),_.cellSettings[e][t]||(_.cellSettings[e][t]=new _.columnSettings[t]),(n=_.cellSettings[e][t]).row=e,n.col=t,n.prop=s,n.instance=H,Handsontable.hooks.run(H,"beforeGetCellMeta",e,t,n),k.extend(n,w(n)),!n.cells||(i=n.cells.call(n,e,t,s))&&(k.extend(n,i),k.extend(n,w(i))),Handsontable.hooks.run(H,"afterGetCellMeta",e,t,n),n},this.isColumnModificationAllowed=function(){return!("object"===H.dataType||H.getSettings().columns)};var r=k.cellMethodLookupFactory("renderer");function i(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}this.getCellRenderer=function(e,t){var n=r.call(this,e,t);return E(n)},this.getCellEditor=k.cellMethodLookupFactory("editor"),this.getCellValidator=k.cellMethodLookupFactory("validator"),this.validateCells=function(e){var t=new d;t.onQueueEmpty=e;for(var n=H.countRows()-1;0<=n;){for(var o=H.countCols()-1;0<=o;)t.addValidatorToQueue(),H.validateCell(H.getDataAtCell(n,o),H.getCellMeta(n,o),function(){t.removeValidatorFormQueue()},"validateCells"),o--;n--}t.checkIfQueueIsEmpty()},this.getRowHeader=function(e){if(void 0!==e)return Array.isArray(_.settings.rowHeaders)&&void 0!==_.settings.rowHeaders[e]?_.settings.rowHeaders[e]:"function"==typeof _.settings.rowHeaders?_.settings.rowHeaders(e):_.settings.rowHeaders&&"string"!=typeof _.settings.rowHeaders&&"number"!=typeof _.settings.rowHeaders?e+1:_.settings.rowHeaders;for(var t=[],n=0,o=H.countRows();n<o;n++)t.push(H.getRowHeader(n));return t},this.hasRowHeaders=function(){return!!_.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==_.settings.colHeaders&&null!==_.settings.colHeaders)return!!_.settings.colHeaders;for(var e=0,t=H.countCols();e<t;e++)if(H.getColHeader(e))return!0;return!1},this.getColHeader=function(e){if(void 0===e){for(var t=[],n=0,o=H.countCols();n<o;n++)t.push(H.getColHeader(n));return t}var r=e;return e=Handsontable.hooks.run(H,"modifyCol",e),_.settings.columns&&_.settings.columns[e]&&_.settings.columns[e].title?_.settings.columns[e].title:Array.isArray(_.settings.colHeaders)&&void 0!==_.settings.colHeaders[e]?_.settings.colHeaders[e]:"function"==typeof _.settings.colHeaders?_.settings.colHeaders(e):_.settings.colHeaders&&"string"!=typeof _.settings.colHeaders&&"number"!=typeof _.settings.colHeaders?k.spreadsheetColumnLabel(r):_.settings.colHeaders},this._getColWidthFromSettings=function(e){var t=H.getCellMeta(0,e),n=t.width;if(void 0!==n&&n!==_.settings.width||(n=t.colWidths),null!=n){switch(typeof n){case"object":n=n[e];break;case"function":n=n(e)}"string"==typeof n&&(n=parseInt(n,10))}return n},this.getColWidth=function(e){var t=(t=H._getColWidthFromSettings(e))||50;return t=Handsontable.hooks.run(H,"modifyColWidth",t,e)},this._getRowHeightFromSettings=function(e){var t=_.settings.rowHeights;if(null!=t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=H._getRowHeightFromSettings(e);return t=Handsontable.hooks.run(H,"modifyRowHeight",t,e)},this.countRows=function(){return _.settings.data.length},this.countCols=function(){return"object"===H.dataType||"function"===H.dataType?_.settings.columns&&_.settings.columns.length?_.settings.columns.length:h.colToPropCache.length:"array"===H.dataType?_.settings.columns&&_.settings.columns.length?_.settings.columns.length:_.settings.data&&_.settings.data[0]&&_.settings.data[0].length?_.settings.data[0].length:0:void 0},this.rowOffset=function(){return H.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return H.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return H.view.wt.drawn?H.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return H.view.wt.drawn?H.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return H.view.wt.drawn?H.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return H.view.wt.drawn?H.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(e){for(var t,n=H.countRows()-1,o=0;0<=n;){if(t=Handsontable.hooks.run(this,"modifyRow",n),H.isEmptyRow(t))o++;else if(e)break;n--}return o},this.countEmptyCols=function(e){if(H.countRows()<1)return 0;for(var t=H.countCols()-1,n=0;0<=t;){if(H.isEmptyCol(t))n++;else if(e)break;t--}return n},this.isEmptyRow=function(e){return _.settings.isEmptyRow.call(H,e)},this.isEmptyCol=function(e){return _.settings.isEmptyCol.call(H,e)},this.selectCell=function(e,t,n,o,r,i){var s;if(i=void 0===i||!0===i,"number"!=typeof e||e<0||e>=H.countRows())return!1;if("number"!=typeof t||t<0||t>=H.countCols())return!1;if(void 0!==n){if("number"!=typeof n||n<0||n>=H.countRows())return!1;if("number"!=typeof o||o<0||o>=H.countCols())return!1}return s=new M(e,t),_.selRange=new O(s,s,s),document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur(),i&&H.listen(),void 0===n?f.setRangeEnd(_.selRange.from,r):f.setRangeEnd(new M(n,o),r),H.selection.finish(),!0},this.selectCellByProp=function(e,t,n,o,r){return arguments[1]=h.propToCol(arguments[1]),void 0!==arguments[3]&&(arguments[3]=h.propToCol(arguments[3])),H.selectCell.apply(H,arguments)},this.deselectCell=function(){f.deselect()},this.destroy=function(){for(var e in H._clearTimeouts(),H.view&&H.view.destroy(),v.empty(H.rootElement),o.clear(),Handsontable.hooks.run(H,"afterDestroy"),Handsontable.hooks.destroy(H),H)H.hasOwnProperty(e)&&("function"==typeof H[e]?"runHooks"!==e&&(H[e]=i):"guid"!==e&&(H[e]=null));u=H=n=f=c=h=_=null},this.getActiveEditor=function(){return n.getActiveEditor()},this.getPlugin=function(e){return S(this,e)},this.getInstance=function(){return H},this.addHook=function(e,t){Handsontable.hooks.add(e,t,H)},this.addHookOnce=function(e,t){Handsontable.hooks.once(e,t,H)},this.removeHook=function(e,t){Handsontable.hooks.remove(e,t,H)},this.runHooks=function(e,t,n,o,r,i,s){return Handsontable.hooks.run(H,e,t,n,o,r,i,s)},this.timeouts=[],this._registerTimeout=function(e){this.timeouts.push(e)},this._clearTimeouts=function(){for(var e=0,t=this.timeouts.length;e<t;e++)clearTimeout(this.timeouts[e])},this.version=Handsontable.version};var D=function(){};D.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,colWidths:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",persistentState:!1,currentRowClassName:void 0,currentColClassName:void 0,stretchH:"none",isEmptyRow:function(e){for(var t,n,o=0,r=this.countCols();o<r;o++)if(""!==(t=this.getDataAtCell(e,o))&&null!=t)return"object"==typeof t&&(n=this.getCellMeta(e,o),k.isObjectEquals(this.getSchema()[n.prop],t));return!0},isEmptyCol:function(e){for(var t,n=0,o=this.countRows();n<o;n++)if(""!==(t=this.getDataAtCell(n,e))&&null!=t)return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,search:!1,type:"text",copyable:!0,editor:void 0,autoComplete:void 0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:10,viewportColumnRenderingOffset:10,groups:void 0,validator:void 0,disableVisualSelection:!1,sortIndicator:!1,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,format:void 0,className:void 0},Handsontable.DefaultSettings=D},{"./3rdparty/walkontable/src/cell/coords.js":5,"./3rdparty/walkontable/src/cell/range.js":6,"./3rdparty/walkontable/src/selection.js":18,"./dataMap.js":26,"./dom.js":27,"./editorManager.js":28,"./eventManager.js":41,"./helpers.js":42,"./plugins.js":45,"./renderers.js":70,"./tableView.js":85,numeral:"numeral"}],26:[function(e,t,n){"use strict";var o,r,i;Object.defineProperties(n,{DataMap:{get:function(){return l}},__esModule:{value:!0}});var d=(o=e("./helpers.js"))&&o.__esModule&&o||{default:o},s=((r=e("./multiMap.js"))&&r.__esModule&&r||{default:r}).MultiMap,a=((i=e("SheetClip"))&&i.__esModule&&i||{default:i}).default;function l(e,t,n){this.instance=e,this.priv=t,this.GridSettings=n,this.dataSource=this.instance.getSettings().data,this.dataSource[0]?this.duckSchema=this.recursiveDuckSchema(this.dataSource[0]):this.duckSchema={},this.createMap()}(Handsontable.DataMap=l).prototype.DESTINATION_RENDERER=1,l.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,l.prototype.recursiveDuckSchema=function(e){return Handsontable.helper.duckSchema(e)},l.prototype.recursiveDuckColumns=function(e,t,n){var o,r;if(void 0===t&&(t=0,n=""),"object"==typeof e&&!Array.isArray(e))for(r in e)e.hasOwnProperty(r)&&(null===e[r]?(o=n+r,this.colToPropCache.push(o),this.propToColCache.set(o,t),t++):t=this.recursiveDuckColumns(e[r],t,r+"."));return t},l.prototype.createMap=function(){var e,t,n=this.getSchema();if(void 0===n)throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");this.colToPropCache=[],this.propToColCache=new s;var o=this.instance.getSettings().columns;if(o)for(e=0,t=o.length;e<t;e++)void 0!==o[e].data&&(this.colToPropCache[e]=o[e].data,this.propToColCache.set(o[e].data,e));else this.recursiveDuckColumns(n)},l.prototype.colToProp=function(e){return e=Handsontable.hooks.run(this.instance,"modifyCol",e),this.colToPropCache&&void 0!==this.colToPropCache[e]?this.colToPropCache[e]:e},l.prototype.propToCol=function(e){var t=void 0!==this.propToColCache.get(e)?this.propToColCache.get(e):e;return t=Handsontable.hooks.run(this.instance,"modifyCol",t)},l.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;return e?"function"==typeof e?e():e:this.duckSchema},l.prototype.createRow=function(e,t,n){var o,r=this.instance.countCols(),i=0;t=t||1,("number"!=typeof e||e>=this.instance.countRows())&&(e=this.instance.countRows());for(var s=this.instance.getSettings().maxRows;i<t&&this.instance.countRows()<s;){if("array"===this.instance.dataType){o=[];for(var a=0;a<r;a++)o.push(null)}else"function"===this.instance.dataType?o=this.instance.getSettings().dataSchema(e):(o={},d.deepExtend(o,this.getSchema()));e===this.instance.countRows()?this.dataSource.push(o):this.dataSource.splice(e,0,o),i++,0}return Handsontable.hooks.run(this.instance,"afterCreateRow",e,i,n),this.instance.forceFullRender=!0,i},l.prototype.createCol=function(e,t,n){if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var o,r,i=this.instance.countRows(),s=this.dataSource,a=0;t=t||1,r=e;for(var l=this.instance.getSettings().maxCols;a<t&&this.instance.countCols()<l;){if(o=d.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof e||e>=this.instance.countCols()){for(var u=0;u<i;u++)void 0===s[u]&&(s[u]=[]),s[u].push(null);this.priv.columnSettings.push(o)}else{for(u=0;u<i;u++)s[u].splice(r,0,null);this.priv.columnSettings.splice(r,0,o)}a++,r++}return Handsontable.hooks.run(this.instance,"afterCreateCol",e,a,n),this.instance.forceFullRender=!0,a},l.prototype.removeRow=function(e,t){t=t||1,"number"!=typeof e&&(e=-t),e=(this.instance.countRows()+e)%this.instance.countRows();var n,o,r=this.physicalRowsToLogical(e,t);!1!==Handsontable.hooks.run(this.instance,"beforeRemoveRow",e,t)&&(o=(n=this.dataSource).filter(function(e,t){return-1==r.indexOf(t)}),n.length=0,Array.prototype.push.apply(n,o),Handsontable.hooks.run(this.instance,"afterRemoveRow",e,t),this.instance.forceFullRender=!0)},l.prototype.removeCol=function(e,t){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");if(t=t||1,"number"!=typeof e&&(e=-t),e=(this.instance.countCols()+e)%this.instance.countCols(),!1!==Handsontable.hooks.run(this.instance,"beforeRemoveCol",e,t)){for(var n=this.dataSource,o=0,r=this.instance.countRows();o<r;o++)n[o].splice(e,t);this.priv.columnSettings.splice(e,t),Handsontable.hooks.run(this.instance,"afterRemoveCol",e,t),this.instance.forceFullRender=!0}},l.prototype.spliceCol=function(e,t,n){var o=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getDataAtCol(e),i=r.slice(t,t+n),s=r.slice(t+n);d.extendArray(o,s);for(var a=0;a<n;)o.push(null),a++;return d.to2dArray(o),this.instance.populateFromArray(t,e,o,null,null,"spliceCol"),i},l.prototype.spliceRow=function(e,t,n){var o=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getSourceDataAtRow(e),i=r.slice(t,t+n),s=r.slice(t+n);d.extendArray(o,s);for(var a=0;a<n;)o.push(null),a++;return this.instance.populateFromArray(e,t,[o],null,null,"spliceRow"),i},l.prototype.get=function(e,t){if(e=Handsontable.hooks.run(this.instance,"modifyRow",e),"string"==typeof t&&-1<t.indexOf(".")){var n=t.split("."),o=this.dataSource[e];if(!o)return null;for(var r=0,i=n.length;r<i;r++)if(void 0===(o=o[n[r]]))return null;return o}return"function"==typeof t?t(this.dataSource.slice(e,e+1)[0]):this.dataSource[e]?this.dataSource[e][t]:null};var u=d.cellMethodLookupFactory("copyable",!1);l.prototype.getCopyable=function(e,t){return u.call(this.instance,e,this.propToCol(t))?this.get(e,t):""},l.prototype.set=function(e,t,n,o){if(e=Handsontable.hooks.run(this.instance,"modifyRow",e,o||"datamapGet"),"string"==typeof t&&-1<t.indexOf(".")){for(var r=t.split("."),i=this.dataSource[e],s=0,a=r.length-1;s<a;s++)void 0===i[r[s]]&&(i[r[s]]={}),i=i[r[s]];i[r[s]]=n}else"function"==typeof t?t(this.dataSource.slice(e,e+1)[0],n):this.dataSource[e][t]=n},l.prototype.physicalRowsToLogical=function(e,t){for(var n,o=this.instance.countRows(),r=(o+e)%o,i=[],s=t;r<o&&s;)n=Handsontable.hooks.run(this.instance,"modifyRow",r),i.push(n),s--,r++;return i},l.prototype.clear=function(){for(var e=0;e<this.instance.countRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")},l.prototype.getAll=function(){return this.dataSource},l.prototype.getRange=function(e,t,n){for(var o,r,i=[],s=n===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,a=Math.max(e.row,t.row),l=Math.max(e.col,t.col),u=Math.min(e.row,t.row);u<=a;u++){for(r=[],o=Math.min(e.col,t.col);o<=l;o++)r.push(s.call(this,u,this.colToProp(o)));i.push(r)}return i},l.prototype.getText=function(e,t){return a.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))},l.prototype.getCopyableText=function(e,t){return a.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))}},{"./helpers.js":42,"./multiMap.js":43,SheetClip:"SheetClip"}],27:[function(e,t,n){"use strict";function o(e){null!=e&&null==e.isImmediatePropagationEnabled&&(e.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1,this.cancelBubble=!0},e.isImmediatePropagationEnabled=!0,e.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled})}function r(e,t,n){for(;null!=e&&e!==n;){if(e.nodeType===Node.ELEMENT_NODE&&(-1<t.indexOf(e.nodeName)||-1<t.indexOf(e)))return e;e=e.host&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.host:e.parentNode}return null}function i(e,t){var n=e.parentNode,o=[];for("string"==typeof t?o=Array.prototype.slice.call(document.querySelectorAll(t),0):o.push(t);null!=n;){if(-1<o.indexOf(n))return!0;n=n.parentNode}return!1}function s(e){var t,n="hot-table",o=!1;function r(e){return e.nodeType===Node.ELEMENT_NODE&&e.nodeName===n.toUpperCase()}for(t=a(e);null!=t;){if(r(t)){o=!0;break}if(t.host&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(o=r(t.host))break;t=t.host}t=t.parentNode}return o}function a(e){return"undefined"!=typeof Polymer&&"function"==typeof wrap?wrap(e):e}function l(e){return"undefined"!=typeof Polymer&&"function"==typeof unwrap?unwrap(e):e}function u(){var e=document.createElement("div");return!(!e.createShadowRoot||!e.createShadowRoot.toString().match(/\[native code\]/))}function d(e){var t=0;if(e.previousSibling)for(;e=e.previousSibling;)++t;return t}Object.defineProperties(n,{enableImmediatePropagation:{get:function(){return o}},closest:{get:function(){return r}},isChildOf:{get:function(){return i}},isChildOfWebComponentTable:{get:function(){return s}},polymerWrap:{get:function(){return a}},polymerUnwrap:{get:function(){return l}},isWebComponentSupportedNatively:{get:function(){return u}},index:{get:function(){return d}},hasClass:{get:function(){return y}},addClass:{get:function(){return b}},removeClass:{get:function(){return C}},removeTextNodes:{get:function(){return R}},empty:{get:function(){return S}},HTML_CHARACTERS:{get:function(){return E}},fastInnerHTML:{get:function(){return T}},fastInnerText:{get:function(){return M}},isVisible:{get:function(){return O}},offset:{get:function(){return D}},getWindowScrollTop:{get:function(){return x}},getWindowScrollLeft:{get:function(){return A}},getScrollTop:{get:function(){return j}},getScrollLeft:{get:function(){return P}},getScrollableElement:{get:function(){return L}},getTrimmingContainer:{get:function(){return N}},getStyle:{get:function(){return W}},getComputedStyle:{get:function(){return I}},outerWidth:{get:function(){return B}},outerHeight:{get:function(){return V}},innerHeight:{get:function(){return F}},innerWidth:{get:function(){return Y}},addEvent:{get:function(){return G}},removeEvent:{get:function(){return z}},hasCaptionProblem:{get:function(){return U}},getCaretPosition:{get:function(){return $}},getSelectionEndPosition:{get:function(){return X}},setCaretPosition:{get:function(){return K}},getScrollbarWidth:{get:function(){return q}},isIE8:{get:function(){return J}},isIE9:{get:function(){return ee}},isSafari:{get:function(){return ne}},setOverlayPosition:{get:function(){return oe}},getCssTransform:{get:function(){return re}},resetCssTransform:{get:function(){return ie}},__esModule:{value:!0}});var c,h,f,p,g,m,w=!!document.documentElement.classList;function v(e){var t=0,n=[];if(!e||!e.length)return n;for(;e[t];)n.push(e[t]),t++;return n}function y(e,t){return h(e,t)}function b(e,t){return f(e,t)}function C(e,t){return p(e,t)}function R(e,t){if(3===e.nodeType)t.removeChild(e);else if(-1<["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName))for(var n=e.childNodes,o=n.length-1;0<=o;o--)R(n[o],e)}function S(e){for(var t;t=e.lastChild;)e.removeChild(t)}p=w?((m=document.createElement("div")).classList.add("test","test2"),c=m.classList.contains("test2"),h=function(e,t){return""!==t&&e.classList.contains(t)},f=function(e,t){var n=0;if("string"==typeof t&&(t=t.split(" ")),t=v(t),c)e.classList.add.apply(e.classList,t);else for(;t&&t[n];)e.classList.add(t[n]),n++},function(e,t){var n=0;if("string"==typeof t&&(t=t.split(" ")),t=v(t),c)e.classList.remove.apply(e.classList,t);else for(;t&&t[n];)e.classList.remove(t[n]),n++}):(g=function(e){return new RegExp("(\\s|^)"+e+"(\\s|$)")},h=function(e,t){return!!e.className.match(g(t))},f=function(e,t){var n=0,o=e.className;if("string"==typeof t&&(t=t.split(" ")),""===o)o=t.join(" ");else for(;t&&t[n];)g(t[n]).test(o)||(o+=" "+t[n]),n++;e.className=o},function(e,t){var n=0,o=e.className;for("string"==typeof t&&(t=t.split(" "));t&&t[n];)o=o.replace(g(t[n])," ").trim(),n++;e.className!==o&&(e.className=o)});var E=/(<(.*)>|&(.*);)/;function T(e,t){E.test(t)?e.innerHTML=t:M(e,t)}var _,H,k=!!document.createTextNode("test").textContent;function M(e,t){var n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?k?n.textContent=t:n.data=t:(S(e),e.appendChild(document.createTextNode(t)))}function O(e){for(var t=e;l(t)!==document.documentElement;){if(null===t)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(t.host){if(t.host.impl)return O(t.host.impl);if(t.host)return O(t.host);throw new Error("Lost in Web Components world")}return!1}if("none"===t.style.display)return!1;t=t.parentNode}return!0}function D(e){var t,n,o,r,i=document.documentElement;if(U()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName)return{top:(r=e.getBoundingClientRect()).top+(window.pageYOffset||i.scrollTop)-(i.clientTop||0),left:r.left+(window.pageXOffset||i.scrollLeft)-(i.clientLeft||0)};for(t=e.offsetLeft,n=e.offsetTop,o=e;(e=e.offsetParent)&&e!==document.body;)t+=e.offsetLeft,n+=e.offsetTop,o=e;return o&&"fixed"===o.style.position&&(t+=window.pageXOffset||i.scrollLeft,n+=window.pageYOffset||i.scrollTop),{left:t,top:n}}function x(){var e=window.scrollY;return null==e&&(e=document.documentElement.scrollTop),e}function A(){var e=window.scrollX;return null==e&&(e=document.documentElement.scrollLeft),e}function j(e){return e===window?x():e.scrollTop}function P(e){return e===window?A():e.scrollLeft}function L(e){for(var t,n,o,r=e.parentNode,i=["auto","scroll"],s="",a="",l="",u="";r&&r.style&&document.body!==r;){if(t=r.style.overflow,n=r.style.overflowX,o=r.style.overflowY,"scroll"==t||"scroll"==n||"scroll"==o)return r;if(window.getComputedStyle&&(a=(s=window.getComputedStyle(r)).getPropertyValue("overflow"),l=s.getPropertyValue("overflow-y"),u=s.getPropertyValue("overflow-x"),"scroll"===a||"scroll"===u||"scroll"===l))return r;if(r.clientHeight<=r.scrollHeight&&(-1!==i.indexOf(o)||-1!==i.indexOf(t)||-1!==i.indexOf(a)||-1!==i.indexOf(l)))return r;if(r.clientWidth<=r.scrollWidth&&(-1!==i.indexOf(n)||-1!==i.indexOf(t)||-1!==i.indexOf(a)||-1!==i.indexOf(u)))return r;r=r.parentNode}return window}function N(e){for(var t=e.parentNode;t&&t.style&&document.body!==t;){if("visible"!==t.style.overflow&&""!==t.style.overflow)return t;if(window.getComputedStyle){var n=window.getComputedStyle(t);if("visible"!==n.getPropertyValue("overflow")&&""!==n.getPropertyValue("overflow"))return t}t=t.parentNode}return window}function W(e,t){if(e){if(e===window)return"width"===t?window.innerWidth+"px":"height"===t?window.innerHeight+"px":void 0;var n,o=e.style[t];return""!==o&&void 0!==o?o:""!==(n=I(e))[t]&&void 0!==n[t]?n[t]:void 0}}function I(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}function B(e){return e.offsetWidth}function V(e){return U()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function F(e){return e.clientHeight||e.innerHeight}function Y(e){return e.clientWidth||e.innerWidth}function G(e,t,n){window.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function z(e,t,n){window.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)}function U(){return void 0===_&&function(){var e=document.createElement("TABLE");e.style.borderSpacing=0,e.style.borderWidth=0,e.style.padding=0;var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding=0,n.style.margin=0,e.insertBefore(n,t),document.body.appendChild(e),_=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}(),_}function $(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(t.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function X(e){if(e.selectionEnd)return e.selectionEnd;if(document.selection){var t=document.selection.createRange();return null==t?0:e.createTextRange().text.indexOf(t.text)+t.text.length}}function K(t,n,o){if(void 0===o&&(o=n),t.setSelectionRange){t.focus();try{t.setSelectionRange(n,o)}catch(e){var r=t.parentNode,i=r.style.display;r.style.display="block",t.setSelectionRange(n,o),r.style.display=i}}else{var e;t.createTextRange&&((e=t.createTextRange()).collapse(!0),e.moveEnd("character",o),e.moveStart("character",n),e.select())}}function q(){return void 0===H&&(H=function(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),(document.body||document.documentElement).appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var o=e.offsetWidth;return n==o&&(o=t.clientWidth),(document.body||document.documentElement).removeChild(t),n-o}()),H}var Z=!document.createTextNode("test").textContent;function J(){return J}var Q=!!document.documentMode;function ee(){return Q}var te=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);function ne(){return te}function oe(e,t,n){Z||Q?(e.style.top=n,e.style.left=t):te?e.style["-webkit-transform"]="translate3d("+t+","+n+",0)":e.style.transform="translate3d("+t+","+n+",0)"}function re(e){var t;return e.style.transform&&""!==(t=e.style.transform)?["transform",t]:e.style["-webkit-transform"]&&""!==(t=e.style["-webkit-transform"])?["-webkit-transform",t]:-1}function ie(e){e.transform&&""!==e.transform?e.transform="":e["-webkit-transform"]&&""!==e["-webkit-transform"]&&(e["-webkit-transform"]="")}window.Handsontable=window.Handsontable||{},Handsontable.Dom={addClass:b,addEvent:G,closest:r,empty:S,enableImmediatePropagation:o,fastInnerHTML:T,fastInnerText:M,getCaretPosition:$,getComputedStyle:I,getCssTransform:re,getScrollableElement:L,getScrollbarWidth:q,getScrollLeft:P,getScrollTop:j,getStyle:W,getSelectionEndPosition:X,getTrimmingContainer:N,getWindowScrollLeft:A,getWindowScrollTop:x,hasCaptionProblem:U,hasClass:y,HTML_CHARACTERS:E,index:d,innerHeight:F,innerWidth:Y,isChildOf:i,isChildOfWebComponentTable:s,isIE8:J,isIE9:ee,isSafari:ne,isVisible:O,isWebComponentSupportedNatively:u,offset:D,outerHeight:V,outerWidth:B,polymerUnwrap:l,polymerWrap:a,removeClass:C,removeEvent:z,removeTextNodes:R,resetCssTransform:ie,setCaretPosition:K,setOverlayPosition:oe}},{}],28:[function(e,t,n){"use strict";var o,r,i,s,a;Object.defineProperties(n,{EditorManager:{get:function(){return l}},__esModule:{value:!0}});var h=((o=e("./3rdparty/walkontable/src/cell/coords.js"))&&o.__esModule&&o||{default:o}).WalkontableCellCoords,f=(r=e("./helpers.js"))&&r.__esModule&&r||{default:r},p=(i=e("./dom.js"))&&i.__esModule&&i||{default:i},g=((s=e("./editors.js"))&&s.__esModule,((a=e("./eventManager.js"))&&a.__esModule&&a||{default:a}).eventManager);function l(a,l,r){var e,u,d=this,i=f.keyCode,s=!1;function c(e){var t="function"==typeof l.settings.enterMoves?l.settings.enterMoves(event):l.settings.enterMoves;e?r.transformStart(-t.row,-t.col):r.transformStart(t.row,t.col,!0)}function t(e){var t;if(a.isListening()&&(Handsontable.hooks.run(a,"beforeKeyDown",e),!s&&(p.enableImmediatePropagation(e),!e.isImmediatePropagationStopped()&&(l.lastKeyCode=e.keyCode,r.isSelected())))){var n=(e.ctrlKey||e.metaKey)&&!e.altKey;if(!u||u.isWaiting()||f.isMetaKey(e.keyCode)||n||d.isEditorOpened())switch(t=e.shiftKey?r.setRangeEnd:r.setRangeStart,e.keyCode){case i.A:!d.isEditorOpened()&&n&&(r.selectAll(),e.preventDefault(),f.stopPropagation(e));break;case i.ARROW_UP:d.isEditorOpened()&&!u.isWaiting()&&d.closeEditorAndSaveChanges(n),e.shiftKey?r.transformEnd(-1,0):r.transformStart(-1,0),e.preventDefault(),f.stopPropagation(e);break;case i.ARROW_DOWN:d.isEditorOpened()&&!u.isWaiting()&&d.closeEditorAndSaveChanges(n),e.shiftKey?r.transformEnd(1,0):r.transformStart(1,0),e.preventDefault(),f.stopPropagation(e);break;case i.ARROW_RIGHT:d.isEditorOpened()&&!u.isWaiting()&&d.closeEditorAndSaveChanges(n),e.shiftKey?r.transformEnd(0,1):r.transformStart(0,1),e.preventDefault(),f.stopPropagation(e);break;case i.ARROW_LEFT:d.isEditorOpened()&&!u.isWaiting()&&d.closeEditorAndSaveChanges(n),e.shiftKey?r.transformEnd(0,-1):r.transformStart(0,-1),e.preventDefault(),f.stopPropagation(e);break;case i.TAB:var o="function"==typeof l.settings.tabMoves?l.settings.tabMoves(e):l.settings.tabMoves;e.shiftKey?r.transformStart(-o.row,-o.col):r.transformStart(o.row,o.col,!0),e.preventDefault(),f.stopPropagation(e);break;case i.BACKSPACE:case i.DELETE:r.empty(e),d.prepareEditor(),e.preventDefault();break;case i.F2:d.openEditor(null,e),e.preventDefault();break;case i.ENTER:d.isEditorOpened()?(u&&u.state!==Handsontable.EditorState.WAITING&&d.closeEditorAndSaveChanges(n),c(e.shiftKey)):a.getSettings().enterBeginsEditing?d.openEditor(null,e):c(e.shiftKey),e.preventDefault(),e.stopImmediatePropagation();break;case i.ESCAPE:d.isEditorOpened()&&d.closeEditorAndRestoreOriginalValue(n),e.preventDefault();break;case i.HOME:e.ctrlKey||e.metaKey?t(new h(0,l.selRange.from.col)):t(new h(l.selRange.from.row,0)),e.preventDefault(),f.stopPropagation(e);break;case i.END:e.ctrlKey||e.metaKey?t(new h(a.countRows()-1,l.selRange.from.col)):t(new h(l.selRange.from.row,a.countCols()-1)),e.preventDefault(),f.stopPropagation(e);break;case i.PAGE_UP:r.transformStart(-a.countVisibleRows(),0),e.preventDefault(),f.stopPropagation(e);break;case i.PAGE_DOWN:r.transformStart(a.countVisibleRows(),0),e.preventDefault(),f.stopPropagation(e)}else d.openEditor("",e)}}e=g(a),this.destroyEditor=function(e){this.closeEditor(e)},this.getActiveEditor=function(){return u},this.prepareEditor=function(){var e,t,n,o,r,i,s;u&&u.isWaiting()?this.closeEditor(!1,!1,function(e){e&&d.prepareEditor()}):(e=l.selRange.highlight.row,t=l.selRange.highlight.col,n=a.colToProp(t),o=a.getCell(e,t),r=a.getDataAtCell(e,t),i=a.getCellMeta(e,t),(s=a.getCellEditor(i))?(u=Handsontable.editors.getEditor(s,a)).prepare(e,t,n,o,r,i):u=void 0)},this.isEditorOpened=function(){return u&&u.isOpened()},this.openEditor=function(e,t){u&&!u.cellProperties.readOnly?u.beginEditing(e,t):u&&u.cellProperties.readOnly&&t&&t.keyCode===f.keyCode.ENTER&&c()},this.closeEditor=function(e,t,n){u?u.finishEditing(e,t,n):n&&n(!1)},this.closeEditorAndSaveChanges=function(e){return this.closeEditor(!1,e)},this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(!0,e)},a.addHook("afterDocumentKeyDown",t),e.addEventListener(document.documentElement,"keydown",function(e){a.runHooks("afterDocumentKeyDown",e)}),a.view.wt.update("onCellDblClick",function(e,t,n){"TD"==n.nodeName&&d.openEditor()}),a.addHook("afterDestroy",function(){s=!0})}Handsontable.EditorManager=l},{"./3rdparty/walkontable/src/cell/coords.js":5,"./dom.js":27,"./editors.js":29,"./eventManager.js":41,"./helpers.js":42}],29:[function(e,t,n){"use strict";var o;Object.defineProperties(n,{registerEditor:{get:function(){return a}},getEditor:{get:function(){return l}},hasEditor:{get:function(){return d}},getEditorConstructor:{get:function(){return u}},__esModule:{value:!0}});(o=e("./helpers.js"))&&o.__esModule;var r={},i=new WeakMap;function s(e){var t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]}}function a(e,t){var n=new s(t);"string"==typeof e&&(r[e]=n),i.set(t,n)}function l(e,t){var n;if("function"==typeof e)i.get(e)||a(null,e),n=i.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter ');n=r[e]}if(!n)throw Error('No editor registered under name "'+e+'"');return n.getInstance(t)}function u(e){var t;if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter ');if(!(t=r[e]))throw Error('No editor registered under name "'+e+'"');return t.getConstructor()}function d(e){return!!r[e]}Handsontable.editors=Handsontable.editors||{},Handsontable.editors.registerEditor=a,Handsontable.editors.getEditor=l},{"./helpers.js":42}],30:[function(e,t,n){"use strict";var o,r;Object.defineProperties(n,{BaseEditor:{get:function(){return a}},__esModule:{value:!0}});var i=(o=e("./../helpers.js"))&&o.__esModule&&o||{default:o},s=((r=e("./../3rdparty/walkontable/src/cell/coords.js"))&&r.__esModule&&r||{default:r}).WalkontableCellCoords;function a(e){this.instance=e,this.state=Handsontable.EditorState.VIRGIN,this._opened=!1,this._closeCallback=null,this.init()}Handsontable.editors=Handsontable.editors||{},Handsontable.editors.BaseEditor=a,Handsontable.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},a.prototype._fireCallbacks=function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)},a.prototype.init=function(){},a.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},a.prototype.setValue=function(e){throw Error("Editor setValue() method unimplemented")},a.prototype.open=function(){throw Error("Editor open() method unimplemented")},a.prototype.close=function(){throw Error("Editor close() method unimplemented")},a.prototype.prepare=function(e,t,n,o,r,i){this.TD=o,this.row=e,this.col=t,this.prop=n,this.originalValue=r,this.cellProperties=i,this.state=Handsontable.EditorState.VIRGIN},a.prototype.extend=function(){var e,t=this.constructor;return e=function(){t.apply(this,arguments)},n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e;function n(){}},a.prototype.saveValue=function(e,t){var n,o;t?((n=this.instance.getSelected())[0]>n[2]&&(o=n[0],n[0]=n[2],n[2]=o),n[1]>n[3]&&(o=n[1],n[1]=n[3],n[3]=o),this.instance.populateFromArray(n[0],n[1],e,n[2],n[3],"edit")):this.instance.populateFromArray(this.row,this.col,e,null,null,"edit")},a.prototype.beginEditing=function(e,t){this.state==Handsontable.EditorState.VIRGIN&&(this.instance.view.scrollViewport(new s(this.row,this.col)),this.instance.view.render(),this.state=Handsontable.EditorState.EDITING,e="string"==typeof e?e:this.originalValue,this.setValue(i.stringify(e)),this.open(t),this._opened=!0,this.focus(),this.instance.view.render())},a.prototype.finishEditing=function(e,t,n){var o,r,i=this;if(n&&(r=this._closeCallback,this._closeCallback=function(e){r&&r(e),n(e)}),!this.isWaiting())if(this.state!=Handsontable.EditorState.VIRGIN){if(this.state==Handsontable.EditorState.EDITING){if(e)return this.cancelChanges(),void this.instance.view.render();o=this.instance.getSettings().trimWhitespace?[["string"==typeof this.getValue()?String.prototype.trim.call(this.getValue()||""):this.getValue()]]:[[this.getValue()]],this.state=Handsontable.EditorState.WAITING,this.saveValue(o,t),this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(e){i.state=Handsontable.EditorState.FINISHED,i.discardEditor(e)}):(this.state=Handsontable.EditorState.FINISHED,this.discardEditor(!0))}}else this.instance._registerTimeout(setTimeout(function(){i._fireCallbacks(!0)},0))},a.prototype.cancelChanges=function(){this.state=Handsontable.EditorState.FINISHED,this.discardEditor()},a.prototype.discardEditor=function(e){this.state===Handsontable.EditorState.FINISHED&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=Handsontable.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this.state=Handsontable.EditorState.VIRGIN,this._fireCallbacks(!0)))},a.prototype.isOpened=function(){return this._opened},a.prototype.isWaiting=function(){return this.state===Handsontable.EditorState.WAITING}},{"./../3rdparty/walkontable/src/cell/coords.js":5,"./../helpers.js":42}],31:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{AutocompleteEditor:{get:function(){return h}},__esModule:{value:!0}});var l=(o=e("./../helpers.js"))&&o.__esModule&&o||{default:o},u=(r=e("./../dom.js"))&&r.__esModule&&r||{default:r},a=(i=e("./../editors.js"))&&i.__esModule&&i||{default:i},d=a.registerEditor,c=((s=e("./handsontableEditor.js"))&&s.__esModule&&s||{default:s}).HandsontableEditor,h=c.prototype.extend();Handsontable.editors=Handsontable.editors||{},(Handsontable.editors.AutocompleteEditor=h).prototype.init=function(){c.prototype.init.apply(this,arguments),this.query=null,this.choices=[]};h.prototype.createElements=function(){c.prototype.createElements.apply(this,arguments),u.addClass(this.htContainer,"autocompleteEditor"),u.addClass(this.htContainer,-1!==window.navigator.platform.indexOf("Mac")?"htMacScroll":"")};function f(e){0;var t=this.getActiveEditor(),n=l.keyCode;if(l.isPrintableChar(e.keyCode)||e.keyCode===n.BACKSPACE||e.keyCode===n.DELETE||e.keyCode===n.INSERT){var o=0;if(e.keyCode===n.C&&(e.ctrlKey||e.metaKey))return;t.isOpened()||(o+=10),t.instance._registerTimeout(setTimeout(function(){t.queryChoices(t.TEXTAREA.value),0},o))}}h.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",f),c.prototype.prepare.apply(this,arguments)},h.prototype.open=function(){c.prototype.open.apply(this,arguments);var e=this.htEditor.getInstance(),l=this;this.TEXTAREA.style.visibility="visible",this.focus(),e.updateSettings({colWidths:[u.outerWidth(this.TEXTAREA)-2],width:u.outerWidth(this.TEXTAREA)+u.getScrollbarWidth()+2,afterRenderer:function(e,t,n,o,r){var i,s,a=!0===this.getCellMeta(t,n).filteringCaseSensitive;(r=Handsontable.helper.stringify(r))&&-1!=(i=a?r.indexOf(this.query):r.toLowerCase().indexOf(l.query.toLowerCase()))&&(s=r.substr(i,l.query.length),e.innerHTML=r.replace(s,"<strong>"+s+"</strong>"))}}),this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=u.getScrollbarWidth()+2+"px",l.instance._registerTimeout(setTimeout(function(){l.queryChoices(l.TEXTAREA.value)},0))},h.prototype.close=function(){c.prototype.close.apply(this,arguments)},h.prototype.queryChoices=function(t){var n,o,r,e;this.query=t,"function"==typeof this.cellProperties.source?(n=this).cellProperties.source(t,function(e){n.updateChoicesList(e)}):Array.isArray(this.cellProperties.source)?(e=t&&!1!==this.cellProperties.filter?(o=!0===this.cellProperties.filteringCaseSensitive,r=t.toLowerCase(),this.cellProperties.source.filter(function(e){return o?-1!=e.indexOf(t):-1!=e.toLowerCase().indexOf(r)})):this.cellProperties.source,this.updateChoicesList(e)):this.updateChoicesList([])},h.prototype.updateChoicesList=function(e){var t,n=u.getCaretPosition(this.TEXTAREA),o=u.getSelectionEndPosition(this.TEXTAREA),r=h.sortByRelevance(this.getValue(),e,this.cellProperties.filteringCaseSensitive);if(0!=this.cellProperties.filter){for(var i=[],s=0,a=r.length;s<a;s++)i.push(e[r[s]]);t=0,e=i}else t=r[0];this.choices=e,this.htEditor.loadData(l.pivot([e])),this.updateDropdownHeight(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(t),this.instance.listen(),this.TEXTAREA.focus(),u.setCaretPosition(this.TEXTAREA,n,n!=o?o:void 0)},h.prototype.updateDropdownHeight=function(){this.htEditor.updateSettings({height:this.getDropdownHeight()}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()},h.prototype.finishEditing=function(e){e||this.instance.removeHook("beforeKeyDown",f),c.prototype.finishEditing.apply(this,arguments)},h.prototype.highlightBestMatchingChoice=function(e){"number"==typeof e?this.htEditor.selectCell(e,0):this.htEditor.deselectCell()},h.sortByRelevance=function(e,t,n){var o,r,i,s,a,l=[],u=e.length,d=[];if(0===u){for(s=0,a=t.length;s<a;s++)d.push(s);return d}for(s=0,a=t.length;s<a;s++)o=Handsontable.helper.stringify(t[s]),-1!=(r=n?o.indexOf(e):o.toLowerCase().indexOf(e.toLowerCase()))&&(i=o.length-r-u,l.push({baseIndex:s,index:r,charsLeft:i,value:o}));for(l.sort(function(e,t){return-1===t.index?-1:-1===e.index?1:e.index<t.index?-1:t.index<e.index?1:e.index===t.index?e.charsLeft<t.charsLeft?-1:e.charsLeft>t.charsLeft?1:0:void 0}),s=0,a=l.length;s<a;s++)d.push(l[s].baseIndex);return d},h.prototype.getDropdownHeight=function(){var e=this.htEditor.getInstance().getRowHeight(0)||23;return 10<=this.choices.length?10*e:this.choices.length*e+8},d("autocomplete",h)},{"./../dom.js":27,"./../editors.js":29,"./../helpers.js":42,"./handsontableEditor.js":35}],32:[function(e,t,n){"use strict";var o,r;Object.defineProperties(n,{CheckboxEditor:{get:function(){return s}},__esModule:{value:!0}});var i=((o=e("./../editors.js"))&&o.__esModule&&o||{default:o}).registerEditor,s=((r=e("./_baseEditor.js"))&&r.__esModule&&r||{default:r}).BaseEditor.prototype.extend();Handsontable.editors=Handsontable.editors||{},(Handsontable.editors.CheckboxEditor=s).prototype.beginEditing=function(){var e=this.TD.querySelector('input[type="checkbox"]');e&&e.click()},s.prototype.finishEditing=function(){},s.prototype.init=function(){},s.prototype.open=function(){},s.prototype.close=function(){},s.prototype.getValue=function(){},s.prototype.setValue=function(){},s.prototype.focus=function(){},i("checkbox",s)},{"./../editors.js":29,"./_baseEditor.js":30}],33:[function(e,t,n){"use strict";var o,r,i,s,a,l,u;Object.defineProperties(n,{DateEditor:{get:function(){return v}},__esModule:{value:!0}});var d=(o=e("./../helpers.js"))&&o.__esModule&&o||{default:o},c=(r=e("./../dom.js"))&&r.__esModule&&r||{default:r},h=(i=e("./../editors.js"))&&i.__esModule&&i||{default:i},f=h.registerEditor,p=((s=e("./textEditor.js"))&&s.__esModule&&s||{default:s}).TextEditor,g=((a=e("./../eventManager.js"))&&a.__esModule&&a||{default:a}).eventManager,m=((l=e("moment"))&&l.__esModule&&l||{default:l}).default,w=((u=e("pikaday"))&&u.__esModule&&u||{default:u}).default;Handsontable.editors=Handsontable.editors||{},Handsontable.editors.DateEditor=v;var v=function(e){this.$datePicker=null,this.datePicker=null,this.datePickerStyle=null,this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,$traceurRuntime.superGet(this,y.prototype,"constructor").call(this,e)},y=v;$traceurRuntime.createClass(v,{init:function(){var e=this;if("function"!=typeof m)throw new Error("You need to include moment.js to your project.");if("function"!=typeof w)throw new Error("You need to include Pikaday to your project.");$traceurRuntime.superGet(this,y.prototype,"init").call(this),this.instance.addHook("afterDestroy",function(){e.parentDestroyed=!0,e.destroyElements()})},createElements:function(){var t=this;$traceurRuntime.superGet(this,y.prototype,"createElements").call(this),this.datePicker=document.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,c.addClass(this.datePicker,"htDatepickerHolder"),document.body.appendChild(this.datePicker);var e=this.TEXTAREA,n={format:this.defaultDateFormat,field:e,trigger:e,container:this.datePicker,reposition:!1,bound:!1,onSelect:function(e){isNaN(e.getTime())||(e=m(e).format(t.cellProperties.dateFormat||t.defaultDateFormat)),t.setValue(e),t.hideDatepicker()},onClose:function(){t.parentDestroyed||t.finishEditing(!1)}};this.$datePicker=new w(n),g(this).addEventListener(this.datePicker,"mousedown",function(e){d.stopPropagation(e)}),this.hideDatepicker()},destroyElements:function(){this.$datePicker.destroy()},prepare:function(e,t,n,o,r,i){this._opened=!1,$traceurRuntime.superGet(this,y.prototype,"prepare").call(this,e,t,n,o,r,i)},open:function(){var e=void 0!==arguments[0]?arguments[0]:null;$traceurRuntime.superGet(this,y.prototype,"open").call(this),this.showDatepicker(e)},close:function(){var e=this;this._opened=!1,this.instance._registerTimeout(setTimeout(function(){e.instance.selection.refreshBorders()},0)),$traceurRuntime.superGet(this,y.prototype,"close").call(this)},finishEditing:function(){var e,t=void 0!==arguments[0]&&arguments[0],n=void 0!==arguments[1]&&arguments[1];!t||void 0!==(e=this.originalValue)&&this.setValue(e),this.hideDatepicker(),$traceurRuntime.superGet(this,y.prototype,"finishEditing").call(this,t,n)},showDatepicker:function(e){var t,n=this.TD.getBoundingClientRect(),o=this.cellProperties.dateFormat||this.defaultDateFormat,r=this.$datePicker.config(),i=this.instance.view.isMouseDown(),s=!!e&&d.isMetaKey(e.keyCode);this.datePickerStyle.top=window.pageYOffset+n.top+c.outerHeight(this.TD)+"px",this.datePickerStyle.left=window.pageXOffset+n.left+"px",this.$datePicker._onInputFocus=function(){},r.format=o,this.originalValue?(t=this.originalValue,m(t,o,!0).isValid()&&this.$datePicker.setMoment(m(t,o),!0),s||i||this.setValue("")):this.cellProperties.defaultDate?(t=this.cellProperties.defaultDate,r.defaultDate=t,m(t,o,!0).isValid()&&this.$datePicker.setMoment(m(t,o),!0),s||i||this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block",this.$datePicker.show()},hideDatepicker:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{},p),f("date",v)},{"./../dom.js":27,"./../editors.js":29,"./../eventManager.js":41,"./../helpers.js":42,"./textEditor.js":40,moment:"moment",pikaday:"pikaday"}],34:[function(e,t,n){"use strict";var o,r;Object.defineProperties(n,{DropdownEditor:{get:function(){return l}},__esModule:{value:!0}});var i=(o=e("./../editors.js"))&&o.__esModule&&o||{default:o},s=i.registerEditor,a=((r=e("./autocompleteEditor.js"))&&r.__esModule&&r||{default:r}).AutocompleteEditor,l=a.prototype.extend();Handsontable.editors=Handsontable.editors||{},(Handsontable.editors.DropdownEditor=l).prototype.prepare=function(){a.prototype.prepare.apply(this,arguments),this.cellProperties.filter=!1,this.cellProperties.strict=!0},s("dropdown",l)},{"./../editors.js":29,"./autocompleteEditor.js":31}],35:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{HandsontableEditor:{get:function(){return h}},__esModule:{value:!0}});var l=(o=e("./../helpers.js"))&&o.__esModule&&o||{default:o},a=(r=e("./../dom.js"))&&r.__esModule&&r||{default:r},u=(i=e("./../editors.js"))&&i.__esModule&&i||{default:i},d=u.registerEditor,c=((s=e("./textEditor.js"))&&s.__esModule&&s||{default:s}).TextEditor,h=c.prototype.extend();Handsontable.editors=Handsontable.editors||{},(Handsontable.editors.HandsontableEditor=h).prototype.createElements=function(){c.prototype.createElements.apply(this,arguments);var e=document.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.htEditor=new Handsontable(e),this.assignHooks()},h.prototype.prepare=function(e,t,n,o,r,i){c.prototype.prepare.apply(this,arguments);var s=this,a={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,cells:function(){return{readOnly:!0}},fillHandle:!1,afterOnCellMouseDown:function(){var e=this.getValue();void 0!==e&&s.setValue(e),s.instance.destroyEditor()}};this.cellProperties.handsontable&&l.extend(a,i.handsontable),this.htEditor&&this.htEditor.destroy(),this.htEditor=new Handsontable(this.htContainer,a)};function f(e){var t,n,o,r,i;null!=e&&null==e.isImmediatePropagationEnabled&&(e.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1,this.cancelBubble=!0},e.isImmediatePropagationEnabled=!0,e.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled}),e.isImmediatePropagationStopped()||(n=(t=this.getActiveEditor()).htEditor.getInstance(),e.keyCode==l.keyCode.ARROW_DOWN?r=n.getSelected()?(i=n.getSelected()[0],o=n.countRows()-1,Math.min(o,i+1)):0:e.keyCode==l.keyCode.ARROW_UP&&n.getSelected()&&(r=(i=n.getSelected()[0])-1),void 0!==r&&(r<0?n.deselectCell():n.selectCell(r,0),e.preventDefault(),e.stopImmediatePropagation(),t.instance.listen(),t.TEXTAREA.focus()))}h.prototype.open=function(){this.instance.addHook("beforeKeyDown",f),c.prototype.open.apply(this,arguments),this.htEditor.render(),this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible"),a.setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length)},h.prototype.close=function(){this.instance.removeHook("beforeKeyDown",f),this.instance.listen(),c.prototype.close.apply(this,arguments)},h.prototype.focus=function(){this.instance.listen(),c.prototype.focus.apply(this,arguments)},h.prototype.beginEditing=function(e){var t=this.instance.getSettings().onBeginEditing;t&&!1===t()||c.prototype.beginEditing.apply(this,arguments)},h.prototype.finishEditing=function(e,t){var n;return this.htEditor.isListening()&&this.instance.listen(),!this.htEditor.getSelected()||void 0!==(n=this.htEditor.getInstance().getValue())&&this.setValue(n),c.prototype.finishEditing.apply(this,arguments)},h.prototype.assignHooks=function(){var e=this;this.instance.addHook("afterDestroy",function(){e.htEditor&&e.htEditor.destroy()})},d("handsontable",h)},{"./../dom.js":27,"./../editors.js":29,"./../helpers.js":42,"./textEditor.js":40}],36:[function(e,t,n){"use strict";var o,r,i,s,a;Object.defineProperties(n,{MobileTextEditor:{get:function(){return p}},__esModule:{value:!0}});var l=(o=e("./../helpers.js"))&&o.__esModule&&o||{default:o},d=(r=e("./../dom.js"))&&r.__esModule&&r||{default:r},u=(i=e("./../editors.js"))&&i.__esModule&&i||{default:i},c=u.registerEditor,h=((s=e("./_baseEditor.js"))&&s.__esModule&&s||{default:s}).BaseEditor,f=((a=e("./../eventManager.js"))&&a.__esModule&&a||{default:a}).eventManager,p=h.prototype.extend(),g={};Handsontable.editors=Handsontable.editors||{},Handsontable.editors.MobileTextEditor=p;p.prototype.valueChanged=function(){return this.initValue!=this.getValue()},p.prototype.init=function(){var e=this;this.eventManager=f(this.instance),this.createElements(),this.bindEvents(),this.instance.addHook("afterDestroy",function(){e.destroy()})},p.prototype.getValue=function(){return this.TEXTAREA.value},p.prototype.setValue=function(e){this.initValue=e,this.TEXTAREA.value=e},p.prototype.createElements=function(){this.editorContainer=document.createElement("DIV"),this.editorContainer.className="htMobileEditorContainer",this.cellPointer=document.createElement("DIV"),this.cellPointer.className="cellPointer",this.moveHandle=document.createElement("DIV"),this.moveHandle.className="moveHandle",this.inputPane=document.createElement("DIV"),this.inputPane.className="inputs",this.positionControls=document.createElement("DIV"),this.positionControls.className="positionControls",this.TEXTAREA=document.createElement("TEXTAREA"),d.addClass(this.TEXTAREA,"handsontableInput"),this.inputPane.appendChild(this.TEXTAREA),this.editorContainer.appendChild(this.cellPointer),this.editorContainer.appendChild(this.moveHandle),this.editorContainer.appendChild(this.inputPane),this.editorContainer.appendChild(this.positionControls),function(){for(var e in this.controls={},this.controls.leftButton=document.createElement("DIV"),this.controls.leftButton.className="leftButton",this.controls.rightButton=document.createElement("DIV"),this.controls.rightButton.className="rightButton",this.controls.upButton=document.createElement("DIV"),this.controls.upButton.className="upButton",this.controls.downButton=document.createElement("DIV"),this.controls.downButton.className="downButton",this.controls)this.controls.hasOwnProperty(e)&&this.positionControls.appendChild(this.controls[e])}.call(this),document.body.appendChild(this.editorContainer)},p.prototype.onBeforeKeyDown=function(e){var t=this.getActiveEditor();if(d.enableImmediatePropagation(e),e.target===t.TEXTAREA&&!e.isImmediatePropagationStopped()){var n=l.keyCode;switch(e.keyCode){case n.ENTER:t.close(),e.preventDefault();break;case n.BACKSPACE:e.stopImmediatePropagation()}}},p.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown),d.addClass(this.editorContainer,"active"),d.removeClass(this.cellPointer,"hidden"),this.updateEditorPosition()},p.prototype.focus=function(){this.TEXTAREA.focus(),d.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},p.prototype.close=function(){this.TEXTAREA.blur(),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown),d.removeClass(this.editorContainer,"active")},p.prototype.scrollToView=function(){var e=this.instance.getSelectedRange().highlight;this.instance.view.scrollViewport(e)},p.prototype.hideCellPointer=function(){d.hasClass(this.cellPointer,"hidden")||d.addClass(this.cellPointer,"hidden")},p.prototype.updateEditorPosition=function(e,t){var n,o,r,i,s,a,l,u;e&&t?(e=parseInt(e,10),t=parseInt(t,10),this.editorContainer.style.top=t+"px",this.editorContainer.style.left=e+"px"):(n=this.instance.getSelected(),o=this.instance.getCell(n[0],n[1]),g.cellPointer||(g.cellPointer={height:d.outerHeight(this.cellPointer),width:d.outerWidth(this.cellPointer)}),g.editorContainer||(g.editorContainer={width:d.outerWidth(this.editorContainer)}),void 0!==o&&(r=this.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer==window?0:d.getScrollLeft(this.instance.view.wt.wtOverlays.leftOverlay.holder),i=this.instance.view.wt.wtOverlays.topOverlay.trimmingContainer==window?0:d.getScrollTop(this.instance.view.wt.wtOverlays.topOverlay.holder),s=d.offset(o),a=d.outerWidth(o),l=r,u=i,this.editorContainer.style.top=parseInt(s.top+d.outerHeight(o)-u+g.cellPointer.height,10)+"px",this.editorContainer.style.left=parseInt(window.innerWidth/2-g.editorContainer.width/2,10)+"px",s.left+a/2>parseInt(this.editorContainer.style.left,10)+g.editorContainer.width?this.editorContainer.style.left=window.innerWidth-g.editorContainer.width+"px":s.left+a/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px"),this.cellPointer.style.left=parseInt(s.left-g.cellPointer.width/2-d.offset(this.editorContainer).left+a/2-l,10)+"px"))},p.prototype.updateEditorData=function(){var e=this.instance.getSelected(),t=this.instance.getDataAtCell(e[0],e[1]);this.row=e[0],this.col=e[1],this.setValue(t),this.updateEditorPosition()},p.prototype.prepareAndSave=function(){var e;if(!this.valueChanged())return!0;e=this.instance.getSettings().trimWhitespace?[[String.prototype.trim.call(this.getValue())]]:[[this.getValue()]],this.saveValue(e)},p.prototype.bindEvents=function(){var s=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(e){s.prepareAndSave(),s.instance.selection.transformStart(0,-1,null,!0),s.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(e){s.prepareAndSave(),s.instance.selection.transformStart(0,1,null,!0),s.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.upButton,"touchend",function(e){s.prepareAndSave(),s.instance.selection.transformStart(-1,0,null,!0),s.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.downButton,"touchend",function(e){s.prepareAndSave(),s.instance.selection.transformStart(1,0,null,!0),s.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.moveHandle,"touchstart",function(e){var t,n,o,r,i;1==e.touches.length&&(t=e.touches[0],n=s.editorContainer.offsetLeft,o=s.editorContainer.offsetTop,r=t.pageX-n,i=t.pageY-o,s.eventManager.addEventListener(this,"touchmove",function(e){var t=e.touches[0];s.updateEditorPosition(t.pageX-r,t.pageY-i),s.hideCellPointer(),e.preventDefault()}))}),this.eventManager.addEventListener(document.body,"touchend",function(e){d.isChildOf(e.target,s.editorContainer)||d.isChildOf(e.target,s.instance.rootElement)||s.close()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.leftOverlay.holder,"scroll",function(e){s.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer!=window&&s.hideCellPointer()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.topOverlay.holder,"scroll",function(e){s.instance.view.wt.wtOverlays.topOverlay.trimmingContainer!=window&&s.hideCellPointer()})},p.prototype.destroy=function(){this.eventManager.clear(),this.editorContainer.parentNode.removeChild(this.editorContainer)},c("mobile",p)},{"./../dom.js":27,"./../editors.js":29,"./../eventManager.js":41,"./../helpers.js":42,"./_baseEditor.js":30}],37:[function(e,t,n){"use strict";var o,r,i;Object.defineProperties(n,{NumericEditor:{get:function(){return d}},__esModule:{value:!0}});var s=((o=e("numeral"))&&o.__esModule&&o||{default:o}).default,a=(r=e("./../editors.js"))&&r.__esModule&&r||{default:r},l=a.registerEditor,u=((i=e("./textEditor.js"))&&i.__esModule&&i||{default:i}).TextEditor;Handsontable.editors=Handsontable.editors||{},Handsontable.editors.NumericEditor=d;var d=function(){$traceurRuntime.superConstructor(c).apply(this,arguments)},c=d;$traceurRuntime.createClass(d,{beginEditing:function(e){var t;void 0===e&&this.originalValue&&(void 0!==this.cellProperties.language&&s.language(this.cellProperties.language),t=s.languageData().delimiters.decimal,e=(""+this.originalValue).replace(".",t)),$traceurRuntime.superGet(this,c.prototype,"beginEditing").call(this,e)}},{},u),l("numeric",d)},{"./../editors.js":29,"./textEditor.js":40,numeral:"numeral"}],38:[function(e,t,n){"use strict";var o,r,i;Object.defineProperties(n,{PasswordEditor:{get:function(){return d}},__esModule:{value:!0}});var s=(o=e("./../dom.js"))&&o.__esModule&&o||{default:o},a=(r=e("./../editors.js"))&&r.__esModule&&r||{default:r},l=a.registerEditor,u=((i=e("./textEditor.js"))&&i.__esModule&&i||{default:i}).TextEditor,d=u.prototype.extend();Handsontable.editors=Handsontable.editors||{},(Handsontable.editors.PasswordEditor=d).prototype.createElements=function(){u.prototype.createElements.apply(this,arguments),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,s.empty(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)},l("password",d)},{"./../dom.js":27,"./../editors.js":29,"./textEditor.js":40}],39:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{SelectEditor:{get:function(){return h}},__esModule:{value:!0}});var a=(o=e("./../dom.js"))&&o.__esModule&&o||{default:o},l=(r=e("./../helpers.js"))&&r.__esModule&&r||{default:r},u=(i=e("./../editors.js"))&&i.__esModule&&i||{default:i},d=u.registerEditor,c=((s=e("./_baseEditor.js"))&&s.__esModule&&s||{default:s}).BaseEditor,h=c.prototype.extend();Handsontable.editors=Handsontable.editors||{},(Handsontable.editors.SelectEditor=h).prototype.init=function(){this.select=document.createElement("SELECT"),a.addClass(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement.appendChild(this.select)},h.prototype.prepare=function(){c.prototype.prepare.apply(this,arguments);var e,t=this.cellProperties.selectOptions,n="function"==typeof t?this.prepareOptions(t(this.row,this.col,this.prop)):this.prepareOptions(t);for(var o in a.empty(this.select),n){n.hasOwnProperty(o)&&((e=document.createElement("OPTION")).value=o,a.fastInnerHTML(e,n[o]),this.select.appendChild(e))}},h.prototype.prepareOptions=function(e){var t={};if(Array.isArray(e))for(var n=0,o=e.length;n<o;n++)t[e[n]]=e[n];else"object"==typeof e&&(t=e);return t},h.prototype.getValue=function(){return this.select.value},h.prototype.setValue=function(e){this.select.value=e};function f(e){var t=this.getActiveEditor();switch(null!=e&&null==e.isImmediatePropagationEnabled&&(e.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1},e.isImmediatePropagationEnabled=!0,e.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled}),e.keyCode){case l.keyCode.ARROW_UP:var n=t.select.selectedIndex-1;0<=n&&(t.select[n].selected=!0),e.stopImmediatePropagation(),e.preventDefault();break;case l.keyCode.ARROW_DOWN:var o=t.select.selectedIndex+1;o<=t.select.length-1&&(t.select[o].selected=!0),e.stopImmediatePropagation(),e.preventDefault()}}h.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0},h.prototype.open=function(){var e,t=a.outerWidth(this.TD),n=a.outerHeight(this.TD),o=a.offset(this.instance.rootElement),r=a.offset(this.TD);switch(this.checkEditorSection()){case"top":e=a.getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":e=a.getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"corner":e=a.getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode)}var i=this.select.style;e&&-1!=e?i[e[0]]=e[1]:a.resetCssTransform(this.select),i.height=n+"px",i.minWidth=t+"px",i.top=r.top-o.top+"px",i.left=r.left-o.left+"px",i.margin="0px",i.display="",this.instance.addHook("beforeKeyDown",f)},h.prototype.close=function(){this.select.style.display="none",this.instance.removeHook("beforeKeyDown",f)},h.prototype.focus=function(){this.select.focus()},d("select",h)},{"./../dom.js":27,"./../editors.js":29,"./../helpers.js":42,"./_baseEditor.js":30}],40:[function(e,t,n){"use strict";var o,r,i,s,a,l;Object.defineProperties(n,{TextEditor:{get:function(){return g}},__esModule:{value:!0}});var w=(o=e("./../dom.js"))&&o.__esModule&&o||{default:o},u=(r=e("./../helpers.js"))&&r.__esModule&&r||{default:r},d=((i=e("autoResize"))&&i.__esModule&&i||{default:i}).default,c=((s=e("./_baseEditor.js"))&&s.__esModule&&s||{default:s}).BaseEditor,h=((a=e("./../eventManager.js"))&&a.__esModule&&a||{default:a}).eventManager,f=(l=e("./../editors.js"))&&l.__esModule&&l||{default:l},p=f.registerEditor,g=c.prototype.extend();Handsontable.editors=Handsontable.editors||{},(Handsontable.editors.TextEditor=g).prototype.init=function(){var e=this;this.createElements(),this.eventManager=h(this),this.bindEvents(),this.autoResize=d(),this.instance.addHook("afterDestroy",function(){e.destroy()})},g.prototype.getValue=function(){return this.TEXTAREA.value},g.prototype.setValue=function(e){this.TEXTAREA.value=e};function m(e){var t=this.getActiveEditor(),n=u.keyCode,o=(e.ctrlKey||e.metaKey)&&!e.altKey;if(w.enableImmediatePropagation(e),e.target===t.TEXTAREA&&!e.isImmediatePropagationStopped())if(17!==e.keyCode&&224!==e.keyCode&&91!==e.keyCode&&93!==e.keyCode){switch(e.keyCode){case n.ARROW_RIGHT:case n.ARROW_LEFT:case n.ARROW_UP:case n.ARROW_DOWN:t.isWaiting()||e.stopImmediatePropagation();break;case n.ENTER:var r,i,s,a=t.instance.getSelected(),l=!(a[0]===a[2]&&a[1]===a[3]);(o&&!l||e.altKey)&&(t.isOpened()?(r=w.getCaretPosition(t.TEXTAREA),s=(i=t.getValue()).slice(0,r)+"\n"+i.slice(r),t.setValue(s),w.setCaretPosition(t.TEXTAREA,r+1)):t.beginEditing(t.originalValue+"\n"),e.stopImmediatePropagation()),e.preventDefault();break;case n.A:case n.X:case n.C:case n.V:o&&e.stopImmediatePropagation();break;case n.BACKSPACE:case n.DELETE:case n.HOME:case n.END:e.stopImmediatePropagation()}t.autoResize.resize(String.fromCharCode(e.keyCode))}else e.stopImmediatePropagation()}g.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",m)},g.prototype.close=function(){this.textareaParentStyle.display="none",this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",m)},g.prototype.focus=function(){this.TEXTAREA.focus(),w.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},g.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA"),w.addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),w.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var e=this;this.instance._registerTimeout(setTimeout(function(){e.refreshDimensions()},0))},g.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0},g.prototype.getEditedCell=function(){var e;switch(this.checkEditorSection()){case"top":e=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=101;break;case"corner":e=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"left":e=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;default:e=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return-1!=e&&-2!=e?e:void 0},g.prototype.refreshDimensions=function(){if(this.state===Handsontable.EditorState.EDITING&&(this.TD=this.getEditedCell(),this.TD)){var e,t=w.offset(this.TD),n=w.offset(this.instance.rootElement),o=w.getScrollableElement(this.TD),r=t.top-n.top-1-(o.scrollTop||0),i=t.left-n.left-1-(o.scrollLeft||0),s=this.instance.getSettings(),a=s.rowHeaders?1:0,l=s.colHeaders?1:0,u=this.checkEditorSection(),d=this.TD.style.backgroundColor;switch(u){case"top":e=w.getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":e=w.getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"corner":e=w.getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode)}r<0&&(r=0),i<0&&(i=0),l&&0===this.instance.getSelected()[0]&&(r+=1),a&&0===this.instance.getSelected()[1]&&(i+=1),e&&-1!=e?this.textareaParentStyle[e[0]]=e[1]:w.resetCssTransform(this.textareaParentStyle),this.textareaParentStyle.top=r+"px",this.textareaParentStyle.left=i+"px";var c=this.TD.offsetTop-this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),h=this.TD.offsetLeft-this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition(),f=w.innerWidth(this.TD)-8,p=this.instance.view.maximumVisibleElementWidth(h)-10,g=this.TD.scrollHeight+1,m=this.instance.view.maximumVisibleElementHeight(c)-2;0<parseInt(this.TD.style.borderTopWidth,10)&&--g,0<parseInt(this.TD.style.borderLeftWidth,10)&&0<a&&--f,this.TEXTAREA.style.fontSize=w.getComputedStyle(this.TD).fontSize,this.TEXTAREA.style.fontFamily=w.getComputedStyle(this.TD).fontFamily,this.TEXTAREA.style.backgroundColor="",this.TEXTAREA.style.backgroundColor=d||w.getComputedStyle(this.TEXTAREA).backgroundColor,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(g,m),maxHeight:m,minWidth:Math.min(f,p),maxWidth:p},!0),this.textareaParentStyle.display="block"}},g.prototype.bindEvents=function(){var e=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(e){u.stopPropagation(e)}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(e){u.stopPropagation(e)}),this.instance.addHook("afterScrollVertically",function(){e.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){e.refreshDimensions(),e.focus()}),this.instance.addHook("afterRowResize",function(){e.refreshDimensions(),e.focus()}),this.instance.addHook("afterDestroy",function(){e.eventManager.clear()})},g.prototype.destroy=function(){this.eventManager.clear()},p("text",g)},{"./../dom.js":27,"./../editors.js":29,"./../eventManager.js":41,"./../helpers.js":42,"./_baseEditor.js":30,autoResize:"autoResize"}],41:[function(e,t,n){"use strict";var o;Object.defineProperties(n,{EventManager:{get:function(){return r}},eventManager:{get:function(){return i}},__esModule:{value:!0}});var l=(o=e("./dom.js"))&&o.__esModule&&o||{default:o},r=function(e){var t=void 0!==e?e:null;this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])};function i(e){return new r(e)}$traceurRuntime.createClass(r,{addEventListener:function(e,t,n){var o=this,r=this.context;function i(e){null==e.target&&null!=e.srcElement&&(e.definePoperty?e.definePoperty("target",{value:e.srcElement}):e.target=e.srcElement),null==e.preventDefault&&(e.definePoperty?e.definePoperty("preventDefault",{value:function(){this.returnValue=!1}}):e.preventDefault=function(){this.returnValue=!1}),e=function(e,t){var n,o,r,i,s,a="HOT-TABLE";if(t.isTargetWebComponent=!1,t.realTarget=t.target,!Handsontable.eventManager.isHotTableEnv)return t;t=l.polymerWrap(t),s=t.path?t.path.length:0;for(;s--;){if(t.path[s].nodeName===a)n=!0;else if(n&&t.path[s].shadowRoot){i=t.path[s];break}0!==s||i||(i=t.path[s])}i=i||t.target;t.isTargetWebComponent=!0,l.isWebComponentSupportedNatively()?t.realTarget=t.srcElement||t.toElement:(e instanceof Handsontable.Core||e instanceof Walkontable)&&(e instanceof Handsontable.Core?o=e.view.wt.wtTable.TABLE:e instanceof Walkontable&&(o=e.wtTable.TABLE.parentNode.parentNode),r=l.closest(t.target,[a],o),t.realTarget=r&&o.querySelector(a)||t.target);return Object.defineProperty(t,"target",{get:function(){return l.polymerWrap(i)},enumerable:!0,configurable:!0}),t}(r,e),n.call(this,e)}return this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:i}),window.addEventListener?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i),Handsontable.countEventManagerListeners++,function(){o.removeEventListener(e,t,n)}},removeEventListener:function(e,t,n){for(var o,r=this.context.eventListeners.length;r--;)if((o=this.context.eventListeners[r]).event==t&&o.element==e){if(n&&n!=o.callback)continue;this.context.eventListeners.splice(r,1),o.element.removeEventListener?o.element.removeEventListener(o.event,o.callbackProxy,!1):o.element.detachEvent("on"+o.event,o.callbackProxy),Handsontable.countEventManagerListeners--}},clearEvents:function(){for(var e=this.context.eventListeners.length;e--;){var t=this.context.eventListeners[e];t&&this.removeEventListener(t.element,t.event,t.callback)}},clear:function(){this.clearEvents()},fireEvent:function(e,t){var n,o={bubbles:!0,cancelable:"mousemove"!==t,view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};document.createEvent?(n=document.createEvent("MouseEvents")).initMouseEvent(t,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||document.body.parentNode):n=document.createEventObject(),e.dispatchEvent?e.dispatchEvent(n):e.fireEvent("on"+t,n)}},{}),window.Handsontable=window.Handsontable||{},Handsontable.countEventManagerListeners=0,Handsontable.eventManager=i},{"./dom.js":27}],42:[function(e,t,n){"use strict";var o;Object.defineProperties(n,{isPrintableChar:{get:function(){return i}},isMetaKey:{get:function(){return s}},isCtrlKey:{get:function(){return a}},stringify:{get:function(){return l}},toUpperCaseFirst:{get:function(){return u}},equalsIgnoreCase:{get:function(){return d}},duckSchema:{get:function(){return c}},spreadsheetColumnLabel:{get:function(){return h}},createSpreadsheetData:{get:function(){return f}},createSpreadsheetObjectData:{get:function(){return p}},isNumeric:{get:function(){return g}},randomString:{get:function(){return m}},inherit:{get:function(){return w}},extend:{get:function(){return v}},deepExtend:{get:function(){return y}},deepClone:{get:function(){return b}},isObjectEquals:{get:function(){return C}},getPrototypeOf:{get:function(){return R}},columnFactory:{get:function(){return S}},translateRowsToColumns:{get:function(){return E}},to2dArray:{get:function(){return T}},extendArray:{get:function(){return _}},isInput:{get:function(){return H}},isOutsideInput:{get:function(){return k}},keyCode:{get:function(){return M}},isObject:{get:function(){return O}},pivot:{get:function(){return D}},proxy:{get:function(){return x}},cellMethodLookupFactory:{get:function(){return A}},isMobileBrowser:{get:function(){return j}},isTouchSupported:{get:function(){return P}},stopPropagation:{get:function(){return L}},pageX:{get:function(){return N}},pageY:{get:function(){return W}},defineGetter:{get:function(){return I}},requestAnimationFrame:{get:function(){return z}},cancelAnimationFrame:{get:function(){return U}},__esModule:{value:!0}});var r=(o=e("./dom.js"))&&o.__esModule&&o||{default:o};function i(e){return 32==e||48<=e&&e<=57||96<=e&&e<=111||186<=e&&e<=192||219<=e&&e<=222||226<=e||65<=e&&e<=90}function s(e){return-1!=[M.ARROW_DOWN,M.ARROW_UP,M.ARROW_LEFT,M.ARROW_RIGHT,M.HOME,M.END,M.DELETE,M.BACKSPACE,M.F1,M.F2,M.F3,M.F4,M.F5,M.F6,M.F7,M.F8,M.F9,M.F10,M.F11,M.F12,M.TAB,M.PAGE_DOWN,M.PAGE_UP,M.ENTER,M.ESCAPE,M.SHIFT,M.CAPS_LOCK,M.ALT].indexOf(e)}function a(e){return-1!=[M.CONTROL_LEFT,224,M.COMMAND_LEFT,M.COMMAND_RIGHT].indexOf(e)}function l(e){switch(typeof e){case"string":case"number":return e+"";case"object":return null===e?"":e.toString();case"undefined":return"";default:return e.toString()}}function u(e){return e[0].toUpperCase()+e.substr(1)}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],o=e.length;o--;){var r=l(e[o]).toLowerCase();-1===n.indexOf(r)&&n.push(r)}return 1===n.length}function c(e){var t;if(Array.isArray(e))t=[];else for(var n in t={},e)e.hasOwnProperty(n)&&(e[n]&&"object"==typeof e[n]&&!Array.isArray(e[n])?t[n]=c(e[n]):Array.isArray(e[n])?e[n].length&&"object"==typeof e[n][0]&&!Array.isArray(e[n][0])?t[n]=[c(e[n][0])]:t[n]=[]:t[n]=null);return t}function h(e){for(var t,n=e+1,o="";0<n;)t=(n-1)%26,o=String.fromCharCode(65+t)+o,n=parseInt((n-t)/26,10);return o}function f(e,t){e="number"==typeof e?e:100,t="number"==typeof t?t:4;for(var n=[],o=0;o<e;o++){for(var r=[],i=0;i<t;i++)r.push(h(i)+(o+1));n.push(r)}return n}function p(e,t){e="number"==typeof e?e:100,t="number"==typeof t?t:4;for(var n=[],o=0;o<e;o++){for(var r={},i=0;i<t;i++)r["prop"+i]=h(i)+(o+1);n.push(r)}return n}function g(e){var t=typeof e;return"number"==t?!isNaN(e)&&isFinite(e):"string"==t?!!e.length&&(1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e)):"object"==t&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}function m(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function w(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e}function v(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function y(e,t){for(var n in t)t.hasOwnProperty(n)&&(t[n]&&"object"==typeof t[n]?(e[n]||(Array.isArray(t[n])?e[n]=[]:e[n]={}),y(e[n],t[n])):e[n]=t[n])}function b(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}function C(e,t){return JSON.stringify(e)===JSON.stringify(t)}function R(e){var t,n,o="object"==typeof e.__proto__?e.__proto__:(n=e.constructor,"function"==typeof e.constructor&&(t=n,delete e.constructor&&(n=e.constructor,e.constructor=t)),n?n.prototype:null);return o}function S(e,t){function n(){}w(n,e);for(var o=0,r=t.length;o<r;o++)n.prototype[t[o]]=void 0;return n}function E(e){for(var t,n,o=[],r=0,i=0,s=e.length;i<s;i++)for(t=0,n=e[i].length;t<n;t++)t==r&&(o.push([]),r++),o[t].push(e[i][t]);return o}function T(e){for(var t=0,n=e.length;t<n;)e[t]=[e[t]],t++}function _(e,t){for(var n=0,o=t.length;n<o;)e.push(t[n]),n++}function H(e){return-1<["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)||"true"===e.contentEditable}function k(e){return H(e)&&-1==e.className.indexOf("handsontableInput")&&-1==e.className.indexOf("copyPaste")}var M={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86};function O(e){return"[object Object]"==Object.prototype.toString.call(e)}function D(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var n=e.length,o=e[0].length,r=0;r<n;r++)for(var i=0;i<o;i++)t[i]||(t[i]=[]),t[i][r]=e[r][i];return t}function x(e,t){return function(){return e.apply(t,arguments)}}function A(o,r){return r=void 0===r||r,function(e,t){return function e(t){if(t){if(t.hasOwnProperty(o)&&void 0!==t[o])return t[o];if(t.hasOwnProperty("type")&&t.type){var n;if("string"!=typeof t.type)throw new Error("Cell type must be a string ");if((n=function(e){var t=Handsontable.cellTypes[e];if(void 0!==t)return t;throw new Error('You declared cell type "'+e+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes')}(t.type)).hasOwnProperty(o))return n[o];if(r)return}return e(R(t))}}("number"==typeof e?this.getCellMeta(e,t):e)}}function j(e){return e=e||navigator.userAgent,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}function P(){return"ontouchstart"in window}function L(e){"function"==typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function N(e){if(e.pageX)return e.pageX;var t=r.getWindowScrollLeft();return e.clientX+t}function W(e){if(e.pageY)return e.pageY;var t=r.getWindowScrollTop();return e.clientY+t}function I(e,t,n,o){o.value=n,o.writable=!1!==o.writable,o.enumerable=!1!==o.enumerable,o.configurable=!1!==o.configurable,Object.defineProperty(e,t,o)}for(var B=0,V=["ms","moz","webkit","o"],F=window.requestAnimationFrame,Y=window.cancelAnimationFrame,G=0;G<V.length&&!F;++G)F=window[V[G]+"RequestAnimationFrame"],Y=window[V[G]+"CancelAnimationFrame"]||window[V[G]+"CancelRequestAnimationFrame"];function z(e){return F.call(window,e)}function U(e){Y.call(window,e)}F=F||function(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-B)),o=window.setTimeout(function(){e(t+n)},n);return B=t+n,o},Y=Y||function(e){clearTimeout(e)},window.Handsontable=window.Handsontable||{},Handsontable.helper={cancelAnimationFrame:U,cellMethodLookupFactory:A,columnFactory:S,createSpreadsheetData:f,createSpreadsheetObjectData:p,deepClone:b,deepExtend:y,defineGetter:I,duckSchema:c,equalsIgnoreCase:d,extend:v,extendArray:_,getPrototypeOf:R,inherit:w,isCtrlKey:a,isInput:H,isMetaKey:s,isMobileBrowser:j,isNumeric:g,isObject:O,isObjectEquals:C,isOutsideInput:k,isPrintableChar:i,isTouchSupported:P,keyCode:M,pageX:N,pageY:W,pivot:D,proxy:x,randomString:m,requestAnimationFrame:z,spreadsheetColumnLabel:h,stopPropagation:L,stringify:l,to2dArray:T,toUpperCaseFirst:u,translateRowsToColumns:E}},{"./dom.js":27}],43:[function(e,t,n){"use strict";function o(){var n={arrayMap:[],weakMap:new WeakMap};return{get:function(e){return o(e)?n.arrayMap[e]:r(e)?n.weakMap.get(e):void 0},set:function(e,t){if(o(e))n.arrayMap[e]=t;else{if(!r(e))throw new Error("Invalid key type");n.weakMap.set(e,t)}},delete:function(e){o(e)?delete n.arrayMap[e]:r(e)&&n.weakMap.delete(e)}};function o(e){return null!==e&&(t=e)==t&&("string"==typeof e||"number"==typeof e);var t}function r(e){return null!==e&&("object"==typeof e||"function"==typeof e)}}Object.defineProperties(n,{MultiMap:{get:function(){return o}},__esModule:{value:!0}}),window.MultiMap=o},{}],44:[function(e,t,n){"use strict";var o;Object.defineProperties(n,{Hooks:{get:function(){return i}},__esModule:{value:!0}});var r=["afterCellMetaReset","afterChange","afterChangesObserved","afterColumnMove","afterColumnResize","afterContextMenuDefaultOptions","afterContextMenuHide","afterContextMenuShow","afterCopyLimit","afterCreateCol","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterIsMultipleSelectionCheck","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellMouseDown","afterOnCellMouseOver","afterRemoveCol","afterRemoveRow","afterRender","afterRenderer","afterRowMove","afterRowResize","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterUpdateSettings","afterValidate","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","modifyCol","modifyColWidth","modifyRow","modifyRowHeight","persistentStateLoad","persistentStateReset","persistentStateSave"],i=((o=e("./eventManager.js"))&&o.__esModule,function(){this.globalBucket=this.createEmptyBucket()});$traceurRuntime.createClass(i,{createEmptyBucket:function(){for(var e=Object.create(null),t=0,n=r.length;t<n;t++)e[r[t]]=[];return e},getBucket:function(){var e=void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket},add:function(e,t){var n=void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))for(var o=0,r=t.length;o<r;o++)this.add(e,t[o]);else{var i=this.getBucket(n);void 0===i[e]&&(this.register(e),i[e]=[]),t.skip=!1,-1===i[e].indexOf(t)&&i[e].push(t)}return this},once:function(e,t){var n=void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))for(var o=0,r=t.length;o<r;o++)t[o].runOnce=!0,this.add(e,t[o],n);else t.runOnce=!0,this.add(e,t,n)},remove:function(e,t){var n=void 0!==arguments[2]?arguments[2]:null,o=this.getBucket(n);return void 0!==o[e]&&0<=o[e].indexOf(t)&&(t.skip=!0)},run:function(e,t,n,o,r,i,s,a){for(var l,u=this.globalBucket[t],d=u?u.length:0,c=0;c<d;c++){u[c].skip||(void 0!==(l=u[c].call(e,n,o,r,i,s,a))&&(n=l),u[c].runOnce&&this.remove(t,u[c]))}for(var h,f=this.getBucket(e)[t],p=f?f.length:0,g=0;g<p;g++){f[g].skip||(void 0!==(h=f[g].call(e,n,o,r,i,s,a))&&(n=h),f[g].runOnce&&this.remove(t,f[g],e))}return n},destroy:function(){var e=void 0!==arguments[0]?arguments[0]:null,t=this.getBucket(e);for(var n in t)for(var o=0,r=t[n].length;o<r;o++)this.remove(n,t[n],e)},register:function(e){this.isRegistered(e)||r.push(e)},deregister:function(e){this.isRegistered(e)&&r.splice(r.indexOf(e),1)},isRegistered:function(e){return 0<=r.indexOf(e)},getRegistered:function(){return r}},{})},{"./eventManager.js":41}],45:[function(e,t,n){"use strict";Object.defineProperties(n,{registerPlugin:{get:function(){return r}},getPlugin:{get:function(){return i}},__esModule:{value:!0}});var o=new WeakMap;function r(t,n){Handsontable.hooks.add("beforeInit",function(){var e;t=t.toLowerCase(),o.has(this)||o.set(this,{}),(e=o.get(this))[t]||(e[t]=new n(this))}),Handsontable.hooks.add("afterDestroy",function(){var e,t;if(o.has(this)){for(e in t=o.get(this))t.hasOwnProperty(e)&&t[e].destroy();o.delete(this)}})}function i(e,t){if("string"!=typeof t)throw Error('Only strings can be passed as "plugin" parameter');var n=t.toLowerCase();if(!o.has(e)||!o.get(e)[n])throw Error('No plugin registered under name "'+t+'"');return o.get(e)[n]}},{}],46:[function(e,t,n){"use strict";var o;Object.defineProperties(n,{default:{get:function(){return s}},__esModule:{value:!0}});function r(e){i(this,"hot",e,{writable:!1})}var i=((o=e("./../helpers.js"))&&o.__esModule&&o||{default:o}).defineGetter;$traceurRuntime.createClass(r,{destroy:function(){delete this.hot}},{});var s=r},{"./../helpers.js":42}],47:[function(e,t,n){"use strict";var o,r,i;Object.defineProperties(n,{AutoColumnSize:{get:function(){return s}},__esModule:{value:!0}});var y=(o=e("./../../helpers.js"))&&o.__esModule&&o||{default:o},b=(r=e("./../../dom.js"))&&r.__esModule&&r||{default:r};(i=e("./../../plugins.js"))&&i.__esModule;function s(){var o=this;this.beforeInit=function(){var e=this;!(e.autoColumnWidths=[])!==e.getSettings().autoColumnSize?e.autoColumnSizeTmp||(e.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:!0},e.addHook("beforeRender",a.determineIfChanged),e.addHook("modifyColWidth",a.modifyColWidth),e.addHook("afterDestroy",a.afterDestroy),e.determineColumnWidth=o.determineColumnWidth):e.autoColumnSizeTmp&&(e.removeHook("beforeRender",a.determineIfChanged),e.removeHook("modifyColWidth",a.modifyColWidth),e.removeHook("afterDestroy",a.afterDestroy),delete e.determineColumnWidth,o.afterDestroy.call(e))},this.determineIfChanged=function(e){e&&a.determineColumnsWidth.apply(this,arguments)},this.determineColumnWidth=function(e){var t=this,n=t.autoColumnSizeTmp;n.container||function(e){var t=document,n=this;n.table=t.createElement("table"),n.theadTh=t.createElement("th"),n.table.appendChild(t.createElement("thead")).appendChild(t.createElement("tr")).appendChild(n.theadTh),n.tableStyle=n.table.style,n.tableStyle.tableLayout="auto",n.tableStyle.width="auto",n.tbody=t.createElement("tbody"),n.table.appendChild(n.tbody),n.container=t.createElement("div"),n.container.className=e.rootElement.className+" hidden",n.containerStyle=n.container.style,n.container.appendChild(n.table)}.call(n,t),n.container.className=t.rootElement.className+" htAutoColumnSize",n.table.className=t.table.className;for(var o=t.countRows(),r={},i=0;i<o;i++){var s=t.getDataAtCell(i,e);Array.isArray(s)||(s=y.stringify(s));var a=s.length;r[a]||(r[a]={needed:5,strings:[]}),r[a].needed&&(r[a].strings.push({value:s,row:i}),r[a].needed--)}var l=t.getSettings();for(var u in l.colHeaders&&t.view.appendColHeader(e,n.theadTh),b.empty(n.tbody),r)if(r.hasOwnProperty(u))for(var d=0,c=r[u].strings.length;d<c;d++){var h=r[u].strings[d].row,f=t.getCellMeta(h,e);f.col=e,f.row=h;var p=t.getCellRenderer(f),g=document.createElement("tr"),m=document.createElement("td");p(t,m,h,e,t.colToProp(e),r[u].strings[d].value,f),i++,g.appendChild(m),n.tbody.appendChild(g)}var w=t.rootElement.parentNode;w.appendChild(n.container);var v=b.outerWidth(n.table);return w.removeChild(n.container),v},this.determineColumnsWidth=function(){var e=this.getSettings();if(e.autoColumnSize||!e.colWidths)for(var t=this.countCols(),n=0;n<t;n++)this._getColWidthFromSettings(n)||(this.autoColumnWidths[n]=o.determineColumnWidth.call(this,n));this.view.wt&&this.view.wt.wtOverlays.adjustElementsSize(!0)},this.modifyColWidth=function(e,t){return this.autoColumnWidths[t]&&this.autoColumnWidths[t]>e?this.autoColumnWidths[t]:e},this.afterDestroy=function(){var e=this;e.autoColumnSizeTmp&&e.autoColumnSizeTmp.container&&e.autoColumnSizeTmp.container.parentNode&&e.autoColumnSizeTmp.container.parentNode.removeChild(e.autoColumnSizeTmp.container),e.autoColumnSizeTmp=null}}var a=new s;Handsontable.hooks.add("beforeInit",a.beforeInit),Handsontable.hooks.add("afterUpdateSettings",a.beforeInit)},{"./../../dom.js":27,"./../../helpers.js":42,"./../../plugins.js":45}],48:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{Autofill:{get:function(){return d}},__esModule:{value:!0}});var a=(o=e("./../../dom.js"))&&o.__esModule&&o||{default:o},l=((r=e("./../../eventManager.js"))&&r.__esModule&&r||{default:r}).eventManager,u=((i=e("./../../plugins.js"))&&i.__esModule,((s=e("./../../3rdparty/walkontable/src/cell/coords.js"))&&s.__esModule&&s||{default:s}).WalkontableCellCoords);function d(r){var t,i,e,o=this,s=!1;this.instance=r,this.addingStarted=!1,(e=l(r)).addEventListener(document,"mouseup",function(e){if(!r.autofill)return!0;r.autofill.handle&&r.autofill.handle.isDragged&&(1<r.autofill.handle.isDragged&&r.autofill.apply(),r.autofill.handle.isDragged=0,s=!1)}),e.addEventListener(document,"mousemove",function(e){var t,n;if(!o.instance.autofill)return!1;t=a.offset(o.instance.table).top-(window.pageYOffset||document.documentElement.scrollTop)+a.outerHeight(o.instance.table),n=a.offset(o.instance.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+a.outerWidth(o.instance.table),!1===o.addingStarted&&0<o.instance.autofill.handle.isDragged&&e.clientY>t&&e.clientX<=n?(o.instance.mouseDragOutside=!0,o.addingStarted=!0):o.instance.mouseDragOutside=!1,o.instance.mouseDragOutside&&setTimeout(function(){o.addingStarted=!1,o.instance.alter("insert_row")},200)}),t=this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown,this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown=function(e){r.autofill.handle.isDragged=1,s=!0,t(e)},i=this.instance.view.wt.wtSettings.settings.onCellMouseOver,this.instance.view.wt.wtSettings.settings.onCellMouseOver=function(e,t,n,o){r.autofill&&s&&!r.view.isMouseDown()&&r.autofill.handle&&r.autofill.handle.isDragged&&(r.autofill.handle.isDragged++,r.autofill.showBorder(t),r.autofill.checkIfNewRowNeeded()),i(e,t,n,o)},this.instance.view.wt.wtSettings.settings.onCellCornerDblClick=function(){r.autofill.selectAdjacent()}}d.prototype.init=function(){this.handle={}},d.prototype.disable=function(){this.handle.disabled=!0},d.prototype.selectAdjacent=function(){var e,t,n,o=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),r=this.instance.getData();e:for(e=o[2]+1;e<this.instance.countRows();e++){for(n=o[1];n<=o[3];n++)if(r[e][n])break e;(r[e][o[1]-1]||r[e][o[3]+1])&&(t=e)}t&&(this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(new u(o[0],o[1])),this.instance.view.wt.selections.fill.add(new u(t,o[3])),this.apply())},d.prototype.apply=function(){var e,t,n,o,r,i,s,a;this.handle.isDragged=0,(e=this.instance.view.wt.selections.fill.getCorners())&&(this.instance.view.wt.selections.fill.clear(),t=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),Handsontable.hooks.run(this.instance,"afterAutofillApplyValues",t,e),e[0]===t[0]&&e[1]<t[1]?(i="left",n=new u(e[0],e[1]),o=new u(e[2],t[1]-1)):e[0]===t[0]&&e[3]>t[3]?(i="right",n=new u(e[0],t[3]+1),o=new u(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(i="up",n=new u(e[0],e[1]),o=new u(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(i="down",n=new u(t[2]+1,e[1]),o=new u(e[2],e[3])),n&&-1<n.row&&-1<n.col?(a={from:this.instance.getSelectedRange().from,to:this.instance.getSelectedRange().to},s=function(e,t,n,o){var r,i,s,a=n.length,l=n?n[0].length:0,u=[],d=[],c=t.row-e.row,h=t.col-e.col;if(-1!==["down","up"].indexOf(o)){for(var f=0;f<=h;f++)r=parseInt(n[0][f],10),i=parseInt(n[a-1][f],10),s=("down"===o?i-r:r-i)/(a-1)||0,d.push(s);u.push(d)}if(-1!==["right","left"].indexOf(o))for(var p=0;p<=c;p++)r=parseInt(n[p][0],10),i=parseInt(n[p][l-1],10),(d=[]).push(s=("right"===o?i-r:r-i)/(l-1)||0),u.push(d);return u}(n,o,r=this.instance.getData(a.from.row,a.from.col,a.to.row,a.to.col),i),Handsontable.hooks.run(this.instance,"beforeAutofill",n,o,r),this.instance.populateFromArray(n.row,n.col,r,o.row,o.col,"autofill",null,i,s),this.instance.selection.setRangeStart(new u(e[0],e[1])),this.instance.selection.setRangeEnd(new u(e[2],e[3]))):this.instance.selection.refreshBorders())},d.prototype.showBorder=function(e){var t=this.instance.getSelectedRange().getTopLeftCorner(),n=this.instance.getSelectedRange().getBottomRightCorner();if("horizontal"!==this.instance.getSettings().fillHandle&&(n.row<e.row||t.row>e.row))e=new u(e.row,n.col);else{if("vertical"===this.instance.getSettings().fillHandle)return;e=new u(n.row,e.col)}this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().from),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().to),this.instance.view.wt.selections.fill.add(e),this.instance.view.render()},d.prototype.checkIfNewRowNeeded=function(){var e,t,n=this.instance.countRows(),o=this;this.instance.view.wt.selections.fill.cellRange&&!1===this.addingStarted&&(t=this.instance.getSelected(),e=this.instance.view.wt.selections.fill.getCorners(),t[2]<n-1&&e[2]===n-1&&(this.addingStarted=!0,this.instance._registerTimeout(setTimeout(function(){o.instance.alter("insert_row"),o.addingStarted=!1},200))))},Handsontable.hooks.add("afterInit",function(){var e=new d(this);void 0!==this.getSettings().fillHandle&&(e.handle&&!1===this.getSettings().fillHandle?e.disable():e.handle||!1===this.getSettings().fillHandle||(this.autofill=e,this.autofill.init()))}),Handsontable.Autofill=d},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45}],49:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{default:{get:function(){return f}},__esModule:{value:!0}});function a(e){var t=this;$traceurRuntime.superConstructor(h).call(this,e);var n=this;this.sortIndicators=[],this.hot.addHook("afterInit",function(){return t.init.call(t,"afterInit")}),this.hot.addHook("afterUpdateSettings",function(){return t.init.call(t,"afterUpdateSettings")}),this.hot.addHook("modifyRow",function(){return n.translateRow.apply(n,arguments)}),this.hot.addHook("afterGetColHeader",function(){return n.getColHeader.apply(n,arguments)}),Handsontable.hooks.register("beforeColumnSort"),Handsontable.hooks.register("afterColumnSort")}var l=(o=e("./../../dom.js"))&&o.__esModule&&o||{default:o},u=((r=e("./../../eventManager.js"))&&r.__esModule&&r||{default:r}).eventManager,d=((i=e("./../_base.js"))&&i.__esModule&&i||{default:i}).default,c=((s=e("./../../plugins.js"))&&s.__esModule&&s||{default:s}).registerPlugin,h=a;$traceurRuntime.createClass(a,{init:function(e){var t,n,o,r=this.hot.getSettings().columnSorting,i=this;this.hot.sortingEnabled=!!r,this.hot.sortingEnabled?(this.hot.sortIndex=[],o=void 0!==(t=this.loadSortingState())?(n=t.sortColumn,t.sortOrder):(n=r.column,r.sortOrder),this.sortByColumn(n,o),this.hot.sort=function(){var e=Array.prototype.slice.call(arguments);return i.sortByColumn.apply(i,e)},void 0===this.hot.getSettings().observeChanges&&this.enableObserveChangesPlugin(),"afterInit"==e&&(this.bindColumnSortingAfterClick(),this.hot.addHook("afterCreateRow",function(){i.afterCreateRow.apply(i,arguments)}),this.hot.addHook("afterRemoveRow",function(){i.afterRemoveRow.apply(i,arguments)}),this.hot.addHook("afterLoadData",function(){i.init.apply(i,arguments)}))):(this.hot.sort=void 0,this.hot.removeHook("afterCreateRow",this.afterCreateRow),this.hot.removeHook("afterRemoveRow",this.afterRemoveRow),this.hot.removeHook("afterLoadData",this.init))},setSortingColumn:function(e,t){if(void 0===e)return this.hot.sortColumn=void 0,void(this.hot.sortOrder=void 0);this.hot.sortColumn===e&&void 0===t?!1===this.hot.sortOrder?this.hot.sortOrder=void 0:this.hot.sortOrder=!this.hot.sortOrder:this.hot.sortOrder=void 0===t||t,this.hot.sortColumn=e},sortByColumn:function(e,t){this.setSortingColumn(e,t),void 0!==this.hot.sortColumn&&(Handsontable.hooks.run(this.hot,"beforeColumnSort",this.hot.sortColumn,this.hot.sortOrder),this.sort(),this.hot.render(),this.saveSortingState(),Handsontable.hooks.run(this.hot,"afterColumnSort",this.hot.sortColumn,this.hot.sortOrder))},saveSortingState:function(){var e={};void 0!==this.hot.sortColumn&&(e.sortColumn=this.hot.sortColumn),void 0!==this.hot.sortOrder&&(e.sortOrder=this.hot.sortOrder),(e.hasOwnProperty("sortColumn")||e.hasOwnProperty("sortOrder"))&&Handsontable.hooks.run(this.hot,"persistentStateSave","columnSorting",e)},loadSortingState:function(){var e={};return Handsontable.hooks.run(this.hot,"persistentStateLoad","columnSorting",e),e.value},bindColumnSortingAfterClick:function(){var e=u(this.hot),r=this;e.addEventListener(this.hot.rootElement,"click",function(e){if(l.hasClass(e.target,"columnSorting")){var t=(n=e.target,o=l.closest(n,"TH"),l.index(o)-r.hot.view.TBODY.querySelector("tr").querySelectorAll("th").length);if(t!==this.lastSortedColumn)r.sortOrderClass="ascending";else switch(r.hot.sortOrder){case void 0:r.sortOrderClass="ascending";break;case!0:r.sortOrderClass="descending";break;case!1:r.sortOrderClass=void 0}this.lastSortedColumn=t,r.sortByColumn(t)}var n,o})},enableObserveChangesPlugin:function(){var e=this;this.hot._registerTimeout(setTimeout(function(){e.hot.updateSettings({observeChanges:!0})},0))},defaultSort:function(n){return function(e,t){return"string"==typeof e[1]&&(e[1]=e[1].toLowerCase()),"string"==typeof t[1]&&(t[1]=t[1].toLowerCase()),e[1]===t[1]?0:null===e[1]||""===e[1]?1:null===t[1]||""===t[1]?-1:e[1]<t[1]?n?-1:1:e[1]>t[1]?n?1:-1:0}},dateSort:function(r){return function(e,t){if(e[1]===t[1])return 0;if(null===e[1])return 1;if(null===t[1])return-1;var n=new Date(e[1]),o=new Date(t[1]);return n<o?r?-1:1:o<n?r?1:-1:0}},sort:function(){if(void 0!==this.hot.sortOrder){var e,t;this.hot.sortingEnabled=!1,this.hot.sortIndex.length=0;for(var n=this.hot.colOffset(),o=0,r=this.hot.countRows()-this.hot.getSettings().minSpareRows;o<r;o++)this.hot.sortIndex.push([o,this.hot.getDataAtCell(o,this.hot.sortColumn+n)]);switch(e=this.hot.getCellMeta(0,this.hot.sortColumn),this.sortIndicators[this.hot.sortColumn]=e.sortIndicator,e.type){case"date":t=this.dateSort;break;default:t=this.defaultSort}this.hot.sortIndex.sort(t(this.hot.sortOrder));for(o=this.hot.sortIndex.length;o<this.hot.countRows();o++)this.hot.sortIndex.push([o,this.hot.getDataAtCell(o,this.hot.sortColumn+n)]);this.hot.sortingEnabled=!0}},translateRow:function(e){return this.hot.sortingEnabled&&void 0!==this.hot.sortOrder&&this.hot.sortIndex&&this.hot.sortIndex.length&&this.hot.sortIndex[e]?this.hot.sortIndex[e][0]:e},untranslateRow:function(e){if(this.hot.sortingEnabled&&this.hot.sortIndex&&this.hot.sortIndex.length)for(var t=0;t<this.hot.sortIndex.length;t++)if(this.hot.sortIndex[t][0]==e)return t},getColHeader:function(e,t){var n=t.querySelector(".colHeader");this.hot.getSettings().columnSorting&&0<=e&&l.addClass(n,"columnSorting"),l.removeClass(n,"descending"),l.removeClass(n,"ascending"),this.sortIndicators[e]&&e===this.hot.sortColumn&&("ascending"===this.sortOrderClass?l.addClass(n,"ascending"):"descending"===this.sortOrderClass&&l.addClass(n,"descending"))},isSorted:function(){return void 0!==this.hot.sortColumn},afterCreateRow:function(e,t){if(this.isSorted()){for(var n=0;n<this.hot.sortIndex.length;n++)this.hot.sortIndex[n][0]>=e&&(this.hot.sortIndex[n][0]+=t);for(n=0;n<t;n++)this.hot.sortIndex.splice(e+n,0,[e+n,this.hot.getData()[e+n][this.hot.sortColumn+this.hot.colOffset()]]);this.saveSortingState()}},afterRemoveRow:function(e,t){if(this.isSorted()){var n=this.translateRow(e);this.hot.sortIndex.splice(e,t);for(var o=0;o<this.hot.sortIndex.length;o++)this.hot.sortIndex[o][0]>n&&(this.hot.sortIndex[o][0]-=t);this.saveSortingState()}}},{},d);var f=a;c("columnSorting",a)},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46}],50:[function(e,t,n){"use strict";var o;Object.defineProperties(n,{CommentEditor:{get:function(){return i}},__esModule:{value:!0}});var r=(o=e("./../../dom.js"))&&o.__esModule&&o||{default:o},i=function(){this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.editorStyle.position="absolute",this.editorStyle.zIndex=100,this.hide()},s=i;$traceurRuntime.createClass(i,{setPosition:function(e,t){this.editorStyle.left=e+"px",this.editorStyle.top=t+"px"},show:function(){this.editorStyle.display="block"},hide:function(){this.editorStyle.display="none"},isVisible:function(){return"block"===this.editorStyle.display},setValue:function(){var e=(e=void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=e},getValue:function(){return this.getInputElement().value},isFocused:function(){return document.activeElement===this.getInputElement()},focus:function(){this.getInputElement().focus()},createEditor:function(){var e,t,n=document.querySelector("."+s.CLASS_EDITOR_CONTAINER);return n||(n=document.createElement("div"),r.addClass(n,s.CLASS_EDITOR_CONTAINER),document.body.appendChild(n)),e=document.createElement("div"),r.addClass(e,s.CLASS_EDITOR),t=document.createElement("textarea"),r.addClass(t,s.CLASS_INPUT),e.appendChild(t),n.appendChild(e),e},getInputElement:function(){return this.editor.querySelector("."+s.CLASS_INPUT)},destroy:function(){this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null}},{get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"},get CLASS_EDITOR(){return"htComments"},get CLASS_INPUT(){return"htCommentTextArea"},get CLASS_CELL(){return"htCommentCell"}})},{"./../../dom.js":27}],51:[function(e,t,n){"use strict";var o,r,i,s,a,l;Object.defineProperties(n,{Comments:{get:function(){return m}},__esModule:{value:!0}});var p=(o=e("./../../dom.js"))&&o.__esModule&&o||{default:o},u=((r=e("./../../eventManager.js"))&&r.__esModule&&r||{default:r}).EventManager,d=((i=e("./../../3rdparty/walkontable/src/cell/coords.js"))&&i.__esModule&&i||{default:i}).WalkontableCellCoords,c=(s=e("./../../plugins.js"))&&s.__esModule&&s||{default:s},h=c.registerPlugin,f=((a=e("./../_base.js"))&&a.__esModule&&a||{default:a}).default,g=((l=e("./commentEditor.js"))&&l.__esModule&&l||{default:l}).CommentEditor,m=function(e){var s=this;$traceurRuntime.superConstructor(w).call(this,e),this.hot.getSettings().comments&&(this.editor=new g,this.eventManager=new u(this),this.range={},this.mouseDown=!1,this.contextMenuEvent=!1,this.timer=null,this.hot.addHook("afterInit",function(){return s.registerListeners()}),this.hot.addHook("afterContextMenuDefaultOptions",function(e){return s.addToContextMenu(e)}),this.hot.addHook("afterRenderer",function(e,t,n,o,r,i){return s.onAfterRenderer(e,i)}),this.hot.addHook("afterScrollVertically",function(){return s.refreshEditorPosition()}),this.hot.addHook("afterColumnResize",function(){return s.refreshEditorPosition()}),this.hot.addHook("afterRowResize",function(){return s.refreshEditorPosition()}))},w=m;$traceurRuntime.createClass(m,{registerListeners:function(){var t=this;this.eventManager.addEventListener(document,"mouseover",function(e){return t.onMouseOver(e)}),this.eventManager.addEventListener(document,"mousedown",function(e){return t.onMouseDown(e)}),this.eventManager.addEventListener(document,"mousemove",function(e){return t.onMouseMove(e)}),this.eventManager.addEventListener(document,"mouseup",function(e){return t.onMouseUp(e)}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(e){return t.onEditorBlur(e)})},setRange:function(e){this.range=e},clearRange:function(){this.range={}},targetIsCellWithComment:function(e){return!(!p.hasClass(e.target,"htCommentCell")||!p.closest(e.target,[this.hot.rootElement]))},targetIsCommentTextArea:function(e){return this.editor.getInputElement()===e.target},saveComment:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.editor.getValue(),t=this.range.from.row,n=this.range.from.col;this.hot.setCellMeta(t,n,"comment",e),this.hot.render()},saveCommentAtCell:function(e,t){this.setRange({from:new d(e,t)}),this.saveComment()},removeComment:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.removeCellMeta(this.range.from.row,this.range.from.col,"comment"),this.hot.render(),this.hide()},removeCommentAtCell:function(e,t){this.setRange({from:new d(e,t)}),this.removeComment()},show:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditorPosition(!0),this.editor.setValue(e.comment||""),this.editor.show(),!0},showAtCell:function(e,t){return this.setRange({from:new d(e,t)}),this.show()},hide:function(){this.editor.hide()},refreshEditorPosition:function(){var e,t,n,o,r,i,s,a,l,u,d,c,h,f;(void 0!==arguments[0]&&arguments[0]||this.range.from&&this.editor.isVisible())&&(e=this.hot.view.wt.wtTable.getCell(this.range.from),t=p.offset(e),n=this.hot.getColWidth(this.range.from.col),o=t.top,r=t.left,s=i=0,this.hot.view.wt.wtViewport.hasVerticalScroll()&&(o-=this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition(),i=20),this.hot.view.wt.wtViewport.hasHorizontalScroll()&&(r-=this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition(),s=20),a=r+n,l=o,d=(u=this.hot.view.wt.wtTable.holder.getBoundingClientRect()).left+p.getWindowScrollLeft()+s,c=u.right+p.getWindowScrollLeft()-15,h=u.top+p.getWindowScrollTop()+i,f=u.bottom+p.getWindowScrollTop(),a<=d||c<a||l<=h||f<l?this.hide():this.editor.setPosition(a,l))},onMouseDown:function(e){this.mouseDown=!0,this.hot.view&&this.hot.view.wt&&(this.contextMenuEvent||this.targetIsCommentTextArea(e)||this.targetIsCellWithComment(e)||this.hide(),this.contextMenuEvent=!1)},onMouseOver:function(e){var t,n;this.mouseDown||this.editor.isFocused()||(this.targetIsCellWithComment(e)?(t=this.hot.view.wt.wtTable.getCoords(e.target),n={from:new d(t.row,t.col)},this.setRange(n),this.show()):this.targetIsCommentTextArea(e)||this.editor.isFocused()||this.hide())},onMouseMove:function(e){var t=this;this.targetIsCommentTextArea(e)&&(this.mouseDown=!0,clearTimeout(this.timer),this.timer=setTimeout(function(){t.mouseDown=!1},200))},onMouseUp:function(e){this.mouseDown=!1},onAfterRenderer:function(e,t){t.comment&&p.addClass(e,t.commentedCellClassName)},onEditorBlur:function(e){this.saveComment()},checkSelectionCommentsConsistency:function(){var e=!1,t=this.hot.getSelectedRange().from;return this.hot.getCellMeta(t.row,t.col).comment&&(e=!0),e},onContextMenuAddComment:function(){var e=this,t=this.hot.getSelectedRange();this.contextMenuEvent=!0,this.setRange({from:t.from}),this.show(),setTimeout(function(){e.hot&&(e.hot.deselectCell(),e.editor.focus())},10)},onContextMenuRemoveComment:function(e,t){this.contextMenuEvent=!0,this.removeCommentAtCell(t.start.row,t.start.col)},addToContextMenu:function(e){var n=this;e.items.push(Handsontable.ContextMenu.SEPARATOR,{key:"commentsAddEdit",name:function(){return n.checkSelectionCommentsConsistency()?"Edit Comment":"Add Comment"},callback:function(){return n.onContextMenuAddComment()},disabled:function(){return!1}},{key:"commentsRemove",name:function(){return"Delete Comment"},callback:function(e,t){return n.onContextMenuRemoveComment(e,t)},disabled:function(){return!n.checkSelectionCommentsConsistency()}})},destroy:function(){this.eventManager&&this.eventManager.clear(),this.editor&&this.editor.destroy(),$traceurRuntime.superGet(this,w.prototype,"destroy").call(this)}},{},f),h("comments",m)},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46,"./commentEditor.js":50}],52:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{ContextMenu:{get:function(){return _}},__esModule:{value:!0}});var E=(o=e("./../../helpers.js"))&&o.__esModule&&o||{default:o},T=(r=e("./../../dom.js"))&&r.__esModule&&r||{default:r},c=((i=e("./../../eventManager.js"))&&i.__esModule&&i||{default:i}).eventManager;(s=e("./../../plugins.js"))&&s.__esModule;function _(e,t){this.instance=e;var n,o,r,i,s=this;s.menus=[],s.htMenus={},s.triggerRows=[],s.eventManager=c(s),this.enabled=!0,this.instance.addHook("afterDestroy",function(){s.destroy()}),this.defaultOptions={items:[{key:"row_above",name:"Insert row above",callback:function(e,t){this.alter("insert_row",t.start.row)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]].join(",")==e.join(",");return e[0]<0||this.countRows()>=this.getSettings().maxRows||t}},{key:"row_below",name:"Insert row below",callback:function(e,t){this.alter("insert_row",t.end.row+1)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]].join(",")==e.join(",");return this.getSelected()[0]<0||this.countRows()>=this.getSettings().maxRows||t}},_.SEPARATOR,{key:"col_left",name:"Insert column on the left",callback:function(e,t){this.alter("insert_col",t.start.col)},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1].join(",")==e.join(",");return this.getSelected()[1]<0||this.countCols()>=this.getSettings().maxCols||t}},{key:"col_right",name:"Insert column on the right",callback:function(e,t){this.alter("insert_col",t.end.col+1)},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1].join(",")==e.join(",");return e[1]<0||this.countCols()>=this.getSettings().maxCols||t}},_.SEPARATOR,{key:"remove_row",name:"Remove row",callback:function(e,t){var n=t.end.row-t.start.row+1;this.alter("remove_row",t.start.row,n)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]].join(",")==e.join(",");return e[0]<0||t}},{key:"remove_col",name:"Remove column",callback:function(e,t){var n=t.end.col-t.start.col+1;this.alter("remove_col",t.start.col,n)},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1].join(",")==e.join(",");return e[1]<0||t}},_.SEPARATOR,{key:"undo",name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},{key:"redo",name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}},_.SEPARATOR,{key:"make_read_only",name:function(){var e="Read only";return s.checkSelectionReadOnlyConsistency(this)&&(e=s.markSelected(e)),e},callback:function(){var n=s.checkSelectionReadOnlyConsistency(this),o=this;this.getSelectedRange().forAll(function(e,t){o.getCellMeta(e,t).readOnly=!n}),this.render()}},_.SEPARATOR,{key:"alignment",name:"Alignment",submenu:{items:[{name:function(){var e="Left";return s.checkSelectionAlignment(this,"htLeft")&&(e=s.markSelected(e)),e},callback:function(){f.call(this,this.getSelectedRange(),"horizontal","htLeft")},disabled:!1},{name:function(){var e="Center";return s.checkSelectionAlignment(this,"htCenter")&&(e=s.markSelected(e)),e},callback:function(){f.call(this,this.getSelectedRange(),"horizontal","htCenter")},disabled:!1},{name:function(){var e="Right";return s.checkSelectionAlignment(this,"htRight")&&(e=s.markSelected(e)),e},callback:function(){f.call(this,this.getSelectedRange(),"horizontal","htRight")},disabled:!1},{name:function(){var e="Justify";return s.checkSelectionAlignment(this,"htJustify")&&(e=s.markSelected(e)),e},callback:function(){f.call(this,this.getSelectedRange(),"horizontal","htJustify")},disabled:!1},_.SEPARATOR,{name:function(){var e="Top";return s.checkSelectionAlignment(this,"htTop")&&(e=s.markSelected(e)),e},callback:function(){f.call(this,this.getSelectedRange(),"vertical","htTop")},disabled:!1},{name:function(){var e="Middle";return s.checkSelectionAlignment(this,"htMiddle")&&(e=s.markSelected(e)),e},callback:function(){f.call(this,this.getSelectedRange(),"vertical","htMiddle")},disabled:!1},{name:function(){var e="Bottom";return s.checkSelectionAlignment(this,"htBottom")&&(e=s.markSelected(e)),e},callback:function(){f.call(this,this.getSelectedRange(),"vertical","htBottom")},disabled:!1}]}}]},s.options={},E.extend(s.options,this.options),this.bindMouseEvents(),this.markSelected=function(e){return"<span class='selected'>"+String.fromCharCode(10003)+"</span>"+e},this.checkSelectionAlignment=function(o,r){var i=!1;return o.getSelectedRange().forAll(function(e,t){var n=o.getCellMeta(e,t).className;if(n&&-1!=n.indexOf(r))return!(i=!0)}),i},this.instance.getSettings().allowInsertRow||(n=h(this.defaultOptions.items,"row_above"),this.defaultOptions.items.splice(n,1),o=h(this.defaultOptions.items,"row_above"),this.defaultOptions.items.splice(o,1),this.defaultOptions.items.splice(o,1)),this.instance.getSettings().allowInsertColumn||(r=h(this.defaultOptions.items,"col_left"),this.defaultOptions.items.splice(r,1),i=h(this.defaultOptions.items,"col_right"),this.defaultOptions.items.splice(i,1),this.defaultOptions.items.splice(i,1));var a,l,u=!1,d=!1;this.instance.getSettings().allowRemoveRow||(a=h(this.defaultOptions.items,"remove_row"),this.defaultOptions.items.splice(a,1),u=!0),this.instance.getSettings().allowRemoveColumn||(l=h(this.defaultOptions.items,"remove_col"),this.defaultOptions.items.splice(l,1),d=!0),u&&d&&this.defaultOptions.items.splice(l,1),this.checkSelectionReadOnlyConsistency=function(n){var o=!1;return n.getSelectedRange().forAll(function(e,t){if(n.getCellMeta(e,t).readOnly)return!(o=!0)}),o},Handsontable.hooks.run(e,"afterContextMenuDefaultOptions",this.defaultOptions)}function a(e,t){for(var n=0,o=e.length;n<o;n++)if(e[n].key===t)return e[n]}function h(e,t){for(var n=0,o=e.length;n<o;n++)if(e[n].key===t)return n}function l(e,t,n,o){var r,i,s,a,l=this.getCellMeta(e,t),u=o;l.className&&(u="vertical"===n?(s=l.className,a=o,-1!=s.indexOf(a)?s:(s=s.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),s+=" "+a)):(r=l.className,i=o,-1!=r.indexOf(i)?r:(r=r.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),r+=" "+i))),this.setCellMeta(e,t,"className",u)}function f(e,t,n){var o=function(e){for(var t={},n=e.from.row;n<=e.to.row;n++)for(var o=e.from.col;o<=e.to.col;o++)t[n]||(t[n]=[]),t[n][o]=this.getCellMeta(n,o).className;return t}.call(this,e);if(this.runHooks("beforeCellAlignment",o,e,t,n),e.from.row==e.to.row&&e.from.col==e.to.col)l.call(this,e.from.row,e.from.col,t,n);else for(var r=e.from.row;r<=e.to.row;r++)for(var i=e.from.col;i<=e.to.col;i++)l.call(this,r,i,t,n);this.render()}function u(){var e=this,t=e.getSettings().contextMenu,n=E.isObject(t)?t:{};t?(e.contextMenu||(e.contextMenu=new _(e)),e.contextMenu.enable()):e.contextMenu&&(e.contextMenu.destroy(),delete e.contextMenu)}_.prototype.createMenu=function(e,t){var n;return(n=(e=e&&"htContextSubMenu_"+(e=e.replace(/ /g,"_")))?document.querySelector(".htContextMenu."+e):document.querySelector(".htContextMenu"))||(n=document.createElement("DIV"),T.addClass(n,"htContextMenu"),e&&T.addClass(n,e),document.getElementsByTagName("body")[0].appendChild(n)),this.menus.indexOf(n)<0&&(this.menus.push(n),t=t||0,this.triggerRows.push(t)),n},_.prototype.bindMouseEvents=function(){c(this.instance).addEventListener(this.instance.rootElement,"contextmenu",E.proxy(function(e){var t,n,o,r,i=this.instance.getSettings(),s=this.instance.getSettings().rowHeaders,a=this.instance.getSettings().colHeaders;if(t=e.realTarget,this.closeAll(),e.preventDefault(),E.stopPropagation(e),s||a){if(s&&a&&0<t.parentNode.querySelectorAll(".cornerHeader").length)return}else if(!("TD"===(r=t).nodeName||"TD"===r.parentNode.nodeName||T.hasClass(t,"current")&&T.hasClass(t,"wtBorder")))return;o=this.createMenu(),n=this.getItems(i.contextMenu),this.show(o,n),this.setMenuPosition(e,o),this.eventManager.addEventListener(document.documentElement,"mousedown",E.proxy(_.prototype.closeAll,this))},this))},_.prototype.bindTableEvents=function(){this._afterScrollCallback=function(){},this.instance.addHook("afterScrollVertically",this._afterScrollCallback),this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)},_.prototype.unbindTableEvents=function(){this._afterScrollCallback&&(this.instance.removeHook("afterScrollVertically",this._afterScrollCallback),this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},_.prototype.performAction=function(e,t){var n=t.getSelected()[0],o=t.getData()[n];if(!0!==o.disabled&&("function"!=typeof o.disabled||!0!==o.disabled.call(this.instance))&&!o.hasOwnProperty("submenu")){if("function"!=typeof o.callback)return;var r=this.instance.getSelectedRange(),i=_.utils.normalizeSelection(r);o.callback.call(this.instance,o.key,i,e),this.closeAll()}},_.prototype.unbindMouseEvents=function(){this.eventManager.clear(),c(this.instance).removeEventListener(this.instance.rootElement,"contextmenu")},_.prototype.show=function(e,t){var o=this;e.removeAttribute("style");var n={data:t,colHeaders:!(e.style.display="block"),colWidths:[200],readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:E.proxy(this.renderer,this)}],renderAllRows:!0,beforeKeyDown:function(e){o.onBeforeKeyDown(e,r)},afterOnCellMouseOver:function(e,t,n){o.onCellMouseOver(e,t,n,r)}},r=new Handsontable(e,n);r.isHotTableEnv=this.instance.isHotTableEnv,Handsontable.eventManager.isHotTableEnv=this.instance.isHotTableEnv,this.eventManager.removeEventListener(e,"mousedown"),this.eventManager.addEventListener(e,"mousedown",function(e){o.performAction(e,r)}),this.bindTableEvents(),r.listen(),this.htMenus[r.guid]=r,Handsontable.hooks.run(this.instance,"afterContextMenuShow",r)},_.prototype.close=function(e){this.hide(e),this.eventManager.clear(),this.unbindTableEvents(),this.instance.listen()},_.prototype.closeAll=function(){for(;0<this.menus.length;){var e=this.menus.pop();e&&this.close(e)}this.triggerRows=[]},_.prototype.closeLastOpenedSubMenu=function(){var e=this.menus.pop();e&&this.hide(e)},_.prototype.hide=function(e){e.style.display="none";var t=this.htMenus[e.id];Handsontable.hooks.run(this.instance,"afterContextMenuHide",t),t.destroy(),delete this.htMenus[e.id]},_.prototype.renderer=function(e,t,n,o,r,i){var s,a,l=this,u=e.getData()[n],d=document.createElement("DIV");"function"==typeof i&&(i=i.call(this.instance)),T.empty(t),t.appendChild(d),s=u,new RegExp(_.SEPARATOR.name,"i").test(s.name)?T.addClass(t,"htSeparator"):T.fastInnerHTML(d,i),!0===(a=u).disabled||"function"==typeof a.disabled&&!0===a.disabled.call(l.instance)?(T.addClass(t,"htDisabled"),this.eventManager.addEventListener(d,"mouseenter",function(){e.deselectCell()})):(u.hasOwnProperty("submenu")?T.addClass(t,"htSubmenu"):(T.removeClass(t,"htSubmenu"),T.removeClass(t,"htDisabled")),this.eventManager.addEventListener(d,"mouseenter",function(){e.selectCell(n,o)}))},_.prototype.onCellMouseOver=function(e,t,n,o){var r,i,s,a,l=this.menus.length;0<l&&this.menus[l-1].id==o.guid||this.closeLastOpenedSubMenu(),-1!=n.className.indexOf("htSubmenu")&&(r=o.getData()[t.row],i=this.getItems(r.submenu),s=this.createMenu(r.name,t.row),a=n.getBoundingClientRect(),this.show(s,i),this.setSubMenuPosition(a,s))},_.prototype.onBeforeKeyDown=function(e,t){T.enableImmediatePropagation(e);var n,o,r,i,s,a,l,u,d,c,h,f,p,g,m,w,v,y,b=this,C=t.getSelected();switch(e.keyCode){case E.keyCode.ESCAPE:b.closeAll(),e.preventDefault(),e.stopImmediatePropagation();break;case E.keyCode.ENTER:C&&b.performAction(e,t);break;case E.keyCode.ARROW_DOWN:C?R(C[0],C[1],t):(y=(v=t).getCell(0,0),_.utils.isSeparator(y)||_.utils.isDisabled(y)?R(0,0,v):v.selectCell(0,0)),e.preventDefault(),e.stopImmediatePropagation();break;case E.keyCode.ARROW_UP:C?S(C[0],C[1],t):(m=(g=t).countRows()-1,w=g.getCell(m,0),_.utils.isSeparator(w)||_.utils.isDisabled(w)?S(m,0,g):g.selectCell(m,0)),e.preventDefault(),e.stopImmediatePropagation();break;case E.keyCode.ARROW_RIGHT:C&&(n=C[0],o=t.getCell(C[0],0),_.utils.hasSubMenu(o)&&(a=b,l=o,u=n,d=t.getData()[u],c=a.getItems(d.submenu),h=a.createMenu(d.name,u),f=l.getBoundingClientRect(),p=a.show(h,c),a.setSubMenuPosition(f,h),p.selectCell(0,0))),e.preventDefault(),e.stopImmediatePropagation();break;case E.keyCode.ARROW_LEFT:C&&(-1!=t.rootElement.className.indexOf("htContextSubMenu_")&&(b.closeLastOpenedSubMenu(),0<(r=b.menus.length)&&(i=b.menus[r-1],s=b.triggerRows.pop(),(t=this.htMenus[i.id]).selectCell(s,0))),e.preventDefault(),e.stopImmediatePropagation())}function R(e,t,n){var o=e+1,r=o<n.countRows()?n.getCell(o,t):null;r&&(_.utils.isSeparator(r)||_.utils.isDisabled(r)?R(o,t,n):n.selectCell(o,t))}function S(e,t,n){var o=e-1,r=0<=o?n.getCell(o,t):null;r&&(_.utils.isSeparator(r)||_.utils.isDisabled(r)?S(o,t,n):n.selectCell(o,t))}},_.prototype.getItems=function(e){var t,n;function o(e){"string"==typeof e?this.name=e:E.extend(this,e)}for(var r in(o.prototype=e)&&e.items&&(e=e.items),!0===e&&(e=this.defaultOptions.items),1,t=[],e)e.hasOwnProperty(r)&&(n=new o(n=(n="string"==typeof e[r]?a(this.defaultOptions.items,e[r]):a(this.defaultOptions.items,r))||e[r]),"object"==typeof e[r]&&E.extend(n,e[r]),n.key||(n.key=r),t.push(n));return t},_.prototype.setSubMenuPosition=function(e,t){var n=T.getWindowScrollTop(),o=T.getWindowScrollLeft(),r={top:n+e.top,topRelative:e.top,left:e.left,leftRelative:e.left-o,scrollTop:n,scrollLeft:o,cellHeight:e.height,cellWidth:e.width};!this.menuFitsBelowCursor(r,t,document.body.clientWidth)&&this.menuFitsAboveCursor(r,t)?this.positionMenuAboveCursor(r,t,!0):this.positionMenuBelowCursor(r,t,!0),this.menuFitsOnRightOfCursor(r,t,document.body.clientWidth)?this.positionMenuOnRightOfCursor(r,t,!0):this.positionMenuOnLeftOfCursor(r,t,!0)},_.prototype.setMenuPosition=function(e,t){var n=T.getWindowScrollTop(),o=T.getWindowScrollLeft(),r=e.pageY||e.clientY+n,i=e.pageX||e.clientX+o,s={top:r,topRelative:r-n,left:i,leftRelative:i-o,scrollTop:n,scrollLeft:o,cellHeight:e.target.clientHeight,cellWidth:e.target.clientWidth};!this.menuFitsBelowCursor(s,t,document.body.clientHeight)&&this.menuFitsAboveCursor(s,t)?this.positionMenuAboveCursor(s,t):this.positionMenuBelowCursor(s,t),this.menuFitsOnRightOfCursor(s,t,document.body.clientWidth)?this.positionMenuOnRightOfCursor(s,t):this.positionMenuOnLeftOfCursor(s,t)},_.prototype.menuFitsAboveCursor=function(e,t){return e.topRelative>=t.offsetHeight},_.prototype.menuFitsBelowCursor=function(e,t,n){return e.topRelative+t.offsetHeight<=n},_.prototype.menuFitsOnRightOfCursor=function(e,t,n){return e.leftRelative+t.offsetWidth<=n},_.prototype.positionMenuBelowCursor=function(e,t){t.style.top=e.top+"px"},_.prototype.positionMenuAboveCursor=function(e,t,n){t.style.top=n?e.top+e.cellHeight-t.offsetHeight+"px":e.top-t.offsetHeight+"px"},_.prototype.positionMenuOnRightOfCursor=function(e,t,n){t.style.left=n?1+e.left+e.cellWidth+"px":1+e.left+"px"},_.prototype.positionMenuOnLeftOfCursor=function(e,t,n){t.style.left=e.left-t.offsetWidth+"px"},(_.utils={}).normalizeSelection=function(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}},_.utils.isSeparator=function(e){return T.hasClass(e,"htSeparator")},_.utils.hasSubMenu=function(e){return T.hasClass(e,"htSubmenu")},_.utils.isDisabled=function(e){return T.hasClass(e,"htDisabled")},_.prototype.enable=function(){this.enabled||(this.enabled=!0,this.bindMouseEvents())},_.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.closeAll(),this.unbindMouseEvents(),this.unbindTableEvents())},_.prototype.destroy=function(){for(this.closeAll();0<this.menus.length;){var e=this.menus.pop();this.triggerRows.pop(),e&&(this.close(e),this.isMenuEnabledByOtherHotInstance()||this.removeMenu(e))}this.unbindMouseEvents(),this.unbindTableEvents()},_.prototype.isMenuEnabledByOtherHotInstance=function(){for(var e=document.querySelectorAll(".handsontable"),t=!1,n=0,o=e.length;n<o;n++){var r=this.htMenus[e[n].id];if(r&&r.getSettings().contextMenu){t=!0;break}}return t},_.prototype.removeMenu=function(e){e.parentNode&&this.menu.parentNode.removeChild(e)},_.prototype.align=function(e,t,n){f.call(this,e,t,n)},_.SEPARATOR={name:"---------"},Handsontable.hooks.add("afterInit",u),Handsontable.hooks.add("afterUpdateSettings",u),Handsontable.hooks.add("afterInit",function(){if(!this.rootElement.className.indexOf("htContextMenu")){for(var e=0,t=0,n=this.getSettings().data.length,o=parseInt(this.view.wt.wtTable.hider.style.width,10),r=0;r<n;r++)this.getSettings().data[r].name==_.SEPARATOR.name?e+=1:t+=26;this.view.wt.wtTable.holder.style.width=o+22+"px",this.view.wt.wtTable.holder.style.height=t+e+4+"px"}}),Handsontable.hooks.register("afterContextMenuDefaultOptions"),Handsontable.hooks.register("afterContextMenuShow"),Handsontable.hooks.register("afterContextMenuHide"),Handsontable.ContextMenu=_},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],53:[function(e,t,n){"use strict";var o,r,i,s,a;Object.defineProperties(n,{ContextMenuCopyPaste:{get:function(){return f}},__esModule:{value:!0}});var l=(o=e("./../../dom.js"))&&o.__esModule&&o||{default:o},u=((r=e("./../../eventManager.js"))&&r.__esModule&&r||{default:r}).eventManager,d=((i=e("./../../plugins.js"))&&i.__esModule&&i||{default:i}).registerPlugin,c=((s=e("./../_base.js"))&&s.__esModule&&s||{default:s}).default,h=((a=e("zeroclipboard"))&&a.__esModule&&a||{default:a}).default,f=function(e){var t=this;$traceurRuntime.superConstructor(p).call(this,e),this.swfPath=null,this.hotContextMenu=null,this.outsideClickDeselectsCache=null,this.hot.addHook("afterContextMenuShow",function(e){return t.setupZeroClipboard(e)}),this.hot.addHook("afterInit",function(){return t.afterInit()}),this.hot.addHook("afterContextMenuDefaultOptions",function(e){return t.addToContextMenu(e)})},p=f;$traceurRuntime.createClass(f,{afterInit:function(){if(this.hot.getSettings().contextMenuCopyPaste){if("object"==typeof this.hot.getSettings().contextMenuCopyPaste&&(this.swfPath=this.hot.getSettings().contextMenuCopyPaste.swfPath),void 0===h)throw new Error("To be able to use the Copy/Paste feature from the context menu, you need to manualy include ZeroClipboard.js file to your website.");try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){if(void 0===navigator.mimeTypes["application/x-shockwave-flash"])throw new Error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.")}this.prepareZeroClipboard()}},prepareZeroClipboard:function(){this.swfPath&&h.config({swfPath:this.swfPath})},getCopyValue:function(){return this.hot.copyPaste.setCopyableText(),this.hot.copyPaste.copyPasteInstance.elTextarea.value},addToContextMenu:function(e){this.hot.getSettings().contextMenuCopyPaste&&e.items.unshift({key:"copy",name:"Copy"},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste()}},Handsontable.ContextMenu.SEPARATOR)},setupZeroClipboard:function(e){var t,n,o=this;if(this.hot.getSettings().contextMenuCopyPaste){this.hotContextMenu=e;for(var r=0,i=(t=this.hotContextMenu.getData()).length;r<i;r++)if("copy"===t[r].key){(n=new h(this.hotContextMenu.getCell(r,0))).off(),n.on("copy",function(e){e.clipboardData.setData("text/plain",o.getCopyValue()),o.hot.getSettings().outsideClickDeselects=o.outsideClickDeselectsCache}),this.bindEvents();break}}},removeCurrentClass:function(){var e;!this.hotContextMenu.rootElement||(e=this.hotContextMenu.rootElement.querySelector("td.current"))&&l.removeClass(e,"current"),this.outsideClickDeselectsCache=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1},removeZeroClipboardClass:function(){var e;!this.hotContextMenu.rootElement||(e=this.hotContextMenu.rootElement.querySelector("td.zeroclipboard-is-hover"))&&l.removeClass(e,"zeroclipboard-is-hover"),this.hot.getSettings().outsideClickDeselects=this.outsideClickDeselectsCache},bindEvents:function(){var e=this,t=u(this.hotContextMenu);t.addEventListener(document,"mouseenter",function(){return e.removeCurrentClass()}),t.addEventListener(document,"mouseleave",function(){return e.removeZeroClipboardClass()})}},{},c),d("contextMenuCopyPaste",f)},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46,zeroclipboard:"zeroclipboard"}],54:[function(e,t,n){"use strict";var o,r,i,s,a,l;Object.defineProperties(n,{CopyPaste:{get:function(){return CopyPaste}},__esModule:{value:!0}});var u=(o=e("./../../helpers.js"))&&o.__esModule&&o||{default:o},d=((r=e("copyPaste"))&&r.__esModule&&r||{default:r}).default,c=((i=e("SheetClip"))&&i.__esModule&&i||{default:i}).default,f=((s=e("./../../plugins.js"))&&s.__esModule,((a=e("./../../3rdparty/walkontable/src/cell/coords.js"))&&a.__esModule&&a||{default:a}).WalkontableCellCoords),p=((l=e("./../../3rdparty/walkontable/src/cell/range.js"))&&l.__esModule&&l||{default:l}).WalkontableCellRange;function h(h){var n=this;function e(){h.isListening()&&h.selection.empty()}function t(e){var t,n,o,r,i,s,a,l,u;h.isListening()&&h.selection.isSelected()&&(t=c.parse(e),n=h.getSelected(),o=new f(n[0],n[1]),r=new f(n[2],n[3]),s=(i=new p(o,o,r)).getTopLeftCorner(),a=i.getBottomRightCorner(),l=s,u=new f(Math.max(a.row,t.length-1+s.row),Math.max(a.col,t[0].length-1+s.col)),h.addHookOnce("afterChange",function(e,t){e&&e.length&&this.selectCell(l.row,l.col,u.row,u.col)}),h.populateFromArray(l.row,l.col,t,u.row,u.col,"paste",h.getSettings().pasteMode))}function o(e){var t;if(h.getSelected()&&h.getActiveEditor()&&!h.getActiveEditor().isOpened()){if(u.isCtrlKey(e.keyCode))return n.setCopyableText(),void e.stopImmediatePropagation();t=(e.ctrlKey||e.metaKey)&&!e.altKey,e.keyCode==u.keyCode.A&&t&&h._registerTimeout(setTimeout(u.proxy(n.setCopyableText,n),0))}}this.copyPasteInstance=d(),this.copyPasteInstance.onCut(e),this.copyPasteInstance.onPaste(t),h.addHook("beforeKeyDown",o),this.destroy=function(){this.copyPasteInstance.removeCallback(e),this.copyPasteInstance.removeCallback(t),this.copyPasteInstance.destroy(),h.removeHook("beforeKeyDown",o)},h.addHook("afterDestroy",u.proxy(this.destroy,this)),this.triggerPaste=u.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance),this.triggerCut=u.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance),this.setCopyableText=function(){var e=h.getSettings(),t=e.copyRowsLimit,n=e.copyColsLimit,o=h.getSelectedRange(),r=o.getTopLeftCorner(),i=o.getBottomRightCorner(),s=r.row,a=r.col,l=i.row,u=i.col,d=Math.min(l,s+t-1),c=Math.min(u,a+n-1);h.copyPaste.copyPasteInstance.copyable(h.getCopyableData(s,a,d,c)),l===d&&u===c||Handsontable.hooks.run(h,"afterCopyLimit",l-s+1,u-a+1,t,n)}}function g(){var e=this,t=!1!==e.getSettings().copyPaste;t&&!e.copyPaste?e.copyPaste=new h(e):!t&&e.copyPaste&&(e.copyPaste.destroy(),delete e.copyPaste)}Handsontable.hooks.add("afterInit",g),Handsontable.hooks.add("afterUpdateSettings",g),Handsontable.hooks.register("afterCopyLimit")},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../3rdparty/walkontable/src/cell/range.js":6,"./../../helpers.js":42,"./../../plugins.js":45,SheetClip:"SheetClip",copyPaste:"copyPaste"}],55:[function(e,t,n){"use strict";(o=e("./../../plugins.js"))&&o.__esModule;var o,r,i,s,a=((r=e("./../../3rdparty/walkontable/src/cell/range.js"))&&r.__esModule&&r||{default:r}).WalkontableCellRange,l=((i=e("./../../3rdparty/walkontable/src/selection.js"))&&i.__esModule&&i||{default:i}).WalkontableSelection;function u(){}function d(e){var t={row:e.row,col:e.col},n=new l(e,new a(t,t,t)),o=function(e){for(var t=0;t<s.view.wt.selections.length;t++)if(s.view.wt.selections[t].settings.className==e)return t;return-1}(e.className);0<=o?s.view.wt.selections[o]=n:s.view.wt.selections.push(n)}function c(e,t,n){var o=C(e,t),o=R(o,n);this.setCellMeta(e,t,"borders",o),d(o)}function h(e){for(var t=e.range,n=t.from.row;n<=t.to.row;n++)for(var o=t.from.col;o<=t.to.col;o++){var r=C(n,o),i=0;n==t.from.row&&(i++,e.hasOwnProperty("top")&&(r.top=e.top)),n==t.to.row&&(i++,e.hasOwnProperty("bottom")&&(r.bottom=e.bottom)),o==t.from.col&&(i++,e.hasOwnProperty("left")&&(r.left=e.left)),o==t.to.col&&(i++,e.hasOwnProperty("right")&&(r.right=e.right)),0<i&&(this.setCellMeta(n,o,"borders",r),d(r))}}function f(e,t){return"border_row"+e+"col"+t}function p(){return{hide:!0}}function g(e){for(var t,n=document.querySelectorAll("."+e),o=0;o<n.length;o++){n[o]&&("TD"==n[o].nodeName||(t=n[o].parentNode).parentNode&&t.parentNode.removeChild(t))}}function m(e,t){var n=f(e,t);g(n),this.removeCellMeta(e,t,"borders")}function w(e,t,n,o){var r=this.getCellMeta(e,t).borders;r&&null!=r.border||(r=C(e,t)),r[n]=o?p():{width:1,color:"#000"},this.setCellMeta(e,t,"borders",r);var i=f(e,t);g(i),d(r),this.render()}function v(e,t,n){if(e.from.row==e.to.row&&e.from.col==e.to.col)"noBorders"==t?m.call(this,e.from.row,e.from.col):w.call(this,e.from.row,e.from.col,t,n);else switch(t){case"noBorders":for(var o=e.from.col;o<=e.to.col;o++)for(var r=e.from.row;r<=e.to.row;r++)m.call(this,r,o);break;case"top":for(var i=e.from.col;i<=e.to.col;i++)w.call(this,e.from.row,i,t,n);break;case"right":for(var s=e.from.row;s<=e.to.row;s++)w.call(this,s,e.to.col,t);break;case"bottom":for(var a=e.from.col;a<=e.to.col;a++)w.call(this,e.to.row,a,t);break;case"left":for(var l=e.from.row;l<=e.to.row;l++)w.call(this,l,e.from.col,t)}}function y(o,r){var i=!1;return o.getSelectedRange().forAll(function(e,t){var n=o.getCellMeta(e,t).borders;if(n){if(!r)return!(i=!0);if(!n[r].hasOwnProperty("hide"))return!(i=!0)}}),i}function b(e){return"<span class='selected'>"+String.fromCharCode(10003)+"</span>"+e}var C=function(e,t){return{className:f(e,t),border:{width:1,color:"#000",cornerVisible:!1},row:e,col:t,top:p(),right:p(),bottom:p(),left:p()}},R=function(e,t){return t.hasOwnProperty("border")&&(e.border=t.border),t.hasOwnProperty("top")&&(e.top=t.top),t.hasOwnProperty("right")&&(e.right=t.right),t.hasOwnProperty("bottom")&&(e.bottom=t.bottom),t.hasOwnProperty("left")&&(e.left=t.left),e};Handsontable.hooks.add("beforeInit",function(){var e;("boolean"==typeof(e=this.getSettings().customBorders)&&!0===e||"object"==typeof e&&0<e.length)&&(this.customBorders||((s=this).customBorders=new u))}),Handsontable.hooks.add("afterContextMenuDefaultOptions",function(e){this.getSettings().customBorders&&(e.items.push(Handsontable.ContextMenu.SEPARATOR),e.items.push({key:"borders",name:"Borders",submenu:{items:{top:{name:function(){var e="Top";return y(this,"top")&&(e=b(e)),e},callback:function(){var e=y(this,"top");v.call(this,this.getSelectedRange(),"top",e)},disabled:!1},right:{name:function(){var e="Right";return y(this,"right")&&(e=b(e)),e},callback:function(){var e=y(this,"right");v.call(this,this.getSelectedRange(),"right",e)},disabled:!1},bottom:{name:function(){var e="Bottom";return y(this,"bottom")&&(e=b(e)),e},callback:function(){var e=y(this,"bottom");v.call(this,this.getSelectedRange(),"bottom",e)},disabled:!1},left:{name:function(){var e="Left";return y(this,"left")&&(e=b(e)),e},callback:function(){var e=y(this,"left");v.call(this,this.getSelectedRange(),"left",e)},disabled:!1},remove:{name:"Remove border(s)",callback:function(){v.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!y(this)}}}}}))}),Handsontable.hooks.add("afterInit",function(){var e=this.getSettings().customBorders;if(e){for(var t=0;t<e.length;t++)e[t].range?h.call(this,e[t]):c.call(this,e[t].row,e[t].col,e[t]);this.render(),this.view.wt.draw(!0)}}),Handsontable.CustomBorders=u},{"./../../3rdparty/walkontable/src/cell/range.js":6,"./../../3rdparty/walkontable/src/selection.js":18,"./../../plugins.js":45}],56:[function(e,t,n){"use strict";var o,r;Object.defineProperties(n,{DragToScroll:{get:function(){return l}},__esModule:{value:!0}});var i,s,a=((o=e("./../../eventManager.js"))&&o.__esModule&&o||{default:o}).eventManager;(r=e("./../../plugins.js"))&&r.__esModule;function l(){this.boundaries=null,this.callback=null}(Handsontable.plugins.DragToScroll=l).prototype.setBoundaries=function(e){this.boundaries=e},l.prototype.setCallback=function(e){this.callback=e},l.prototype.check=function(e,t){var n=0,o=0;t<this.boundaries.top?o=t-this.boundaries.top:t>this.boundaries.bottom&&(o=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,o)},"undefined"!=typeof Handsontable&&(s=function(e){e.dragToScrollListening=!1;var n=e.view.wt.wtTable.holder;i=new l,n!==window&&(i.setBoundaries(n.getBoundingClientRect()),i.setCallback(function(e,t){e<0?n.scrollLeft-=50:0<e&&(n.scrollLeft+=50),t<0?n.scrollTop-=20:0<t&&(n.scrollTop+=20)}),e.dragToScrollListening=!0)}),Handsontable.hooks.add("afterInit",function(){var t=this,e=a(this);e.addEventListener(document,"mouseup",function(){t.dragToScrollListening=!1}),e.addEventListener(document,"mousemove",function(e){t.dragToScrollListening&&i.check(e.clientX,e.clientY)})}),Handsontable.hooks.add("afterDestroy",function(){a(this).clear()}),Handsontable.hooks.add("afterOnCellMouseDown",function(){s(this)}),Handsontable.hooks.add("afterOnCellCornerMouseDown",function(){s(this)}),Handsontable.plugins.DragToScroll=l},{"./../../eventManager.js":41,"./../../plugins.js":45}],57:[function(e,t,n){"use strict";var o,r,D=(o=e("./../../dom.js"))&&o.__esModule&&o||{default:o};(r=e("./../../plugins.js"))&&r.__esModule;function i(C){function s(n,o){return function(e,t){return void 0===o||"asc"===o?e[n]-t[n]:t[n]-e[n]}}function a(e,t){for(var n=[];e<=t;)n.push(e++);return n}function l(e,t,n){var o=[],r={row:null,col:null};if("cols"==e)for(;t<=n;)r={row:-1,col:t++},o.push(r);else for(;t<=n;)r={row:t++,col:-1},o.push(r);for(var i=h(o),s=0,a=0,l=0;l<i.length;l++)s+=i[l].filter(function(e){return e.rows}).length,a+=i[l].filter(function(e){return e.cols}).length;return{total:{rows:s,cols:a},groups:i}}function R(e){for(var t=0,n=T.length;t<n;t++)if(T[t].id==e)return T[t];return!1}function w(e,t){for(var n=0,o=T.length;n<o;n++)if(T[n].level==t&&T[n].rows&&-1<T[n].rows.indexOf(e))return T[n];return!1}function v(e,t){for(var n=0,o=T.length;n<o;n++)if(T[n].level==t&&T[n].cols&&-1<T[n].cols.indexOf(e))return T[n];return!1}function u(e,t){var n,o,r=l("cols",e,t),i=(n=r.groups,o=0,n.length&&n.forEach(function(e){var t;(e=e.filter(function(e){return e.cols})).length&&(t=e.sort(s("level","desc"))[0].level,o<t&&(o=t))}),o);i===H.cols?H.cols++:i>H.cols&&(H.cols=i+1),_.cols||(_.cols=p().length),_.cols++,T.push({id:"c"+_.cols,level:i+1,cols:a(e,t),hidden:0})}function d(e,t){var n,o,r=l("rows",e,t),i=(n=r.groups,o=0,n.length&&n.forEach(function(e){var t;(e=e.filter(function(e){return e.rows})).length&&(t=e.sort(s("level","desc"))[0].level,o<t&&(o=t))}),o);H.rows=Math.max(H.rows,i+1),_.rows||(_.rows=g().length),_.rows++,T.push({id:"r"+_.rows,level:i+1,rows:a(e,t),hidden:0})}function S(e,t){for(var n,o=0,r=t.length;o<r;o++)if(t[o].hidden=e,n=t[o].level,k[n]||(k[n]=[]),M[n]||(M[n]=[]),t[o].rows)for(var i=0,s=t[o].rows.length;i<s;i++)k[n][t[o].rows[i]]=0<e||void 0;else if(t[o].cols)for(var i=0,a=t[o].cols.length;i<a;i++)M[n][t[o].cols[i]]=0<e||void 0}function y(e,t,n,o){var r,i;switch(e){case"rows":r=w(t+1,n).id,i=Handsontable.Grouping.getGroupLevelsByRows();break;case"cols":r=v(t+1,n).id,i=Handsontable.Grouping.getGroupLevelsByCols()}return!!(i[t+1]&&-1<i[t+1].indexOf(n)&&o==r)}function b(e,t,n,o){var r,i;switch(e){case"rows":r=w(t-1,n).id,i=Handsontable.Grouping.getGroupLevelsByRows();break;case"cols":r=v(t-1,n).id,i=Handsontable.Grouping.getGroupLevelsByCols()}return!!(i[t-1]&&-1<i[t-1].indexOf(n)&&o==r)}function E(e,r,t,n){function o(e){for(var t=!1,n="rows"==e?k:M,o=0;o<=H[e];o++){for(a=r;-1<l[e].indexOf(a);)t=!(!n[o]||!n[o][a]),a--;if(t)break}return t}var i,s,a,l=R(n),u=!1,d=b(e,r,t,n),c=y(e,r,t,n);switch(e){case"rows":i=Handsontable.Grouping.getGroupLevelsByRows(),s=C.countRows(),u=o(e);break;case"cols":i=Handsontable.Grouping.getGroupLevelsByCols(),s=C.countCols(),u=o(e)}if(r!=s-1)if(0===r){if(c)return 1}else if(!d||d&&u){if(c)return 1}else if(!i[r-1]&&c)return 1}function c(e){for(var t=g(),n=p(),o=0,r=t.length;o<r;o++)if(-1<t[o].rows.indexOf(e.row)&&t[o].hidden)return 1;if(null!==e.col)for(var o=0,i=n.length;o<i;o++)if(-1<n[o].cols.indexOf(e.col)&&n[o].hidden)return 1}var T=[],_={rows:0,cols:0},H={rows:0,cols:0},k=[],M=[],O={groupIndicatorContainer:"htGroupIndicatorContainer",groupIndicator:function(e){return"ht"+e+"Group"},groupStart:"htGroupStart",collapseButton:"htCollapseButton",expandButton:"htExpandButton",collapseGroupId:function(e){return"htCollapse-"+e},collapseFromLevel:function(e,t){return"htCollapse"+e+"FromLevel-"+t},clickable:"clickable",levelTrigger:"htGroupLevelTrigger"},h=function(e){for(var t=[],n=0;n<e.length;n++)t.push(o(e[n]));return t},o=function(e,t,n){for(var o=e.row,r=e.col,i=-1===o?0:o,s=-1===r?0:r,a=[],l=0;l<T.length;l++){var u=T[l],d=u.id,c=(u.level,u.rows||[]),h=u.cols||[];-1===a.indexOf(d)&&(-1===c.indexOf(i)&&-1===h.indexOf(s)||a.push(u))}-1===r?a=a.concat(p()):-1===o&&(a=a.concat(g())),t&&(a=a.filter(function(e){return e.level===t})),n&&("cols"===n?a=a.filter(function(e){return e.cols}):"rows"===n&&(a=a.filter(function(e){return e.rows})));var f=[];return a.filter(function(e){if(-1===f.indexOf(e.id))return f.push(e.id),e})},p=function(){for(var e=[],t=0,n=T.length;t<n;t++)Array.isArray(T[t].cols)&&e.push(T[t]);return e},g=function(){for(var e=[],t=0,n=T.length;t<n;t++)Array.isArray(T[t].rows)&&e.push(T[t]);return e};return{getGroups:function(){return T},getLevels:function(){return H},instance:C,baseSpareRows:C.getSettings().minSpareRows,baseSpareCols:C.getSettings().minSpareCols,getRowGroups:g,getColGroups:p,init:function(){var e=C.getSettings().groups;e&&Array.isArray(e)&&Handsontable.Grouping.initGroups(e)},initGroups:function(e){T=[],e.forEach(function(e){var t=[],n=!1,o=!1;Array.isArray(e.rows)?(t=e.rows,n=!0):Array.isArray(e.cols)&&(t=e.cols,o=!0);var r=t[0],i=t[t.length-1];n?d(r,i):o&&u(r,i)})},resetGroups:function(){var e;for(var t in T=[],_={rows:0,cols:0},H={rows:0,cols:0},O)if("function"!=typeof O[t])for(var n=0,o=(e=document.querySelectorAll("."+O[t])).length;n<o;n++)D.removeClass(e[n],O[t]);for(var r=["htGroupColClosest","htGroupCol"],t=0,i=r.length;t<i;t++)for(n=0,o=(e=document.querySelectorAll("."+r[t])).length;n<o;n++)D.removeClass(e[n],r[t])},updateGroups:function(){var e=this.getSettings().groups;Handsontable.Grouping.resetGroups(),Handsontable.Grouping.initGroups(e)},afterGetRowHeader:function(e,t){for(var n=!1,o=0,r=k.length;o<r;o++)k[o]&&!0===k[o][e]&&(n=!0);n?D.addClass(t.parentNode,"hidden"):!n&&D.hasClass(t.parentNode,"hidden")&&D.removeClass(t.parentNode,"hidden")},afterGetColHeader:function(e,t){var n=this.view.wt.wtSettings.getSetting("rowHeaders").length,o=C.rootElement.querySelectorAll("colgroup col:nth-child("+parseInt(e+n+1,10)+")");if(0!==o.length){for(var r=!1,i=0,s=M.length;i<s;i++)M[i]&&!0===M[i][e]&&(r=!0);if(r)for(var i=0,a=o.length;i<a;i++)D.addClass(o[i],"hidden");else if(!r&&D.hasClass(o[0],"hidden"))for(i=0,a=o.length;i<a;i++)D.removeClass(o[i],"hidden")}},groupIndicatorsFactory:function(e,t){var c,h,f,p,n,g;switch(t){case"horizontal":c=Handsontable.Grouping.getGroupLevelsByCols(),h=function(e,t){return v(e,t).id},f="cols",p=function(e,t){return v(e-1,t)},n=function(e){var o;return 1===e.length&&(o=e[0],e[0]=function(e,t,n){e<-1?r()(e,t,n):(D.removeClass(t,O.groupIndicatorContainer),o(e,t,n))}),function(){return e}},g=!0;break;case"vertical":c=Handsontable.Grouping.getGroupLevelsByRows(),h=function(e,t){return w(e,t).id},f="rows",p=function(e,t){return w(e-1,t)},n=function(e){return e}}function m(e){var t=document.createElement("div");return e.appendChild(t),{button:t,addClass:function(e){D.addClass(t,e)}}}var r=function(){var d=t.charAt(0).toUpperCase()+t.slice(1);return function(e,t,n){var o;for(n++;o=t.lastChild;)t.removeChild(o);D.addClass(t,O.groupIndicatorContainer);var r,i,s,a=h(e,n);-1<e&&c[e]&&-1<c[e].indexOf(n)&&((s=m(t)).addClass(O.groupIndicator(d)),E(f,e,n,a)&&s.addClass(O.groupStart),function(e,t,n,o){if(0===t)return!1;var r,i,s=b(e,t,n,o),a=y(e,t,n,o),l=!1;switch(e){case"rows":r=Handsontable.Grouping.getGroupLevelsByRows(),i=C.countRows();for(var u=0;u<=H.rows;u++)if(k[u]&&k[u][t+1]){l=!0;break}break;case"cols":r=Handsontable.Grouping.getGroupLevelsByCols(),i=C.countCols();for(u=0;u<=H.cols;u++)if(M[u]&&M[u][t+1]){l=!0;break}}if(s){if(t==i-1)return!0;if(!a||a&&l)return!0;if(!r[t+1])return!0}return!1}(f,e,n,a)&&(s.button.appendChild(document.createTextNode("-")),s.addClass(O.collapseButton),s.button.id=O.collapseGroupId(a),s.button.setAttribute("data-level",n),s.button.setAttribute("data-type",f))),g&&(r=D.index(t.parentNode),(-1===e||e<-1&&r===Handsontable.Grouping.getLevels().cols+1||0===r&&0===Handsontable.Grouping.getLevels().cols)&&((s=m(t)).addClass(O.levelTrigger),-1===e?(s.button.id=O.collapseFromLevel("Cols",n),s.button.appendChild(document.createTextNode(n))):(e<-1&&r===Handsontable.Grouping.getLevels().cols+1||0===r&&0===Handsontable.Grouping.getLevels().cols)&&(i=D.index(t)+1,s.button.id=O.collapseFromLevel("Rows",i),s.button.appendChild(document.createTextNode(i)))));var l,u=function(e,t,n,o,r){var i;switch(e){case"rows":i=w(t-1,n).id;break;case"cols":i=v(t-1,n).id}if(!i)return null;if(0<t&&b(e,t-1,n,i)&&i!=o){var s=document.createElement("DIV");return D.addClass(s,O.expandButton),s.id="htExpand-"+i,s.appendChild(document.createTextNode("+")),s.setAttribute("data-level",n),s.setAttribute("data-type",e),s.setAttribute("data-hidden","1"),r.appendChild(s),s}return null}(f,e,n,a,t);0<e&&(l=p(e-1,n),u&&l.hidden&&D.addClass(u,O.clickable)),x()}};if(e=n(e),0<_[f])for(var o=0;o<H[f]+1;o++)Array.isArray(e)||(e="function"==typeof e?e():new Array(e)),e.unshift(r())},getGroupLevelsByRows:function(){for(var e=g(),t=[],n=0,o=e.length;n<o;n++)if(e[n].rows)for(var r=0,i=e[n].rows.length;r<i;r++)t[e[n].rows[r]]||(t[e[n].rows[r]]=[]),t[e[n].rows[r]].push(e[n].level);return t},getGroupLevelsByCols:function(){for(var e=p(),t=[],n=0,o=e.length;n<o;n++)if(e[n].cols)for(var r=0,i=e[n].cols.length;r<i;r++)t[e[n].cols[r]]||(t[e[n].cols[r]]=[]),t[e[n].cols[r]].push(e[n].level);return t},toggleGroupVisibility:function(e,t,n){if(D.hasClass(e.target,O.expandButton)||D.hasClass(e.target,O.collapseButton)||D.hasClass(e.target,O.levelTrigger)){var o,r,i,s=e.target,a=s.id.split("-"),l=[];if(-1<s.className.indexOf(O.levelTrigger)){for(var u,d=[],c=[],h=-1<s.id.indexOf("Rows")?"rows":"cols",f=1,p=H[h];f<=p;f++)if(u=("rows"==h?function(e){for(var t=[],n=0,o=T.length;n<o;n++)T[n].rows&&T[n].level===e&&t.push(T[n]);return t}:function(e){for(var t=[],n=0,o=T.length;n<o;n++)T[n].cols&&T[n].level===e&&t.push(T[n]);return t})(f),f>=parseInt(a[1],10))for(var g=0,m=u.length;g<m;g++)c.push(u[g]);else for(g=0,m=u.length;g<m;g++)d.push(u[g]);S(!0,c),S(!1,d)}else b&&(s=b),a=s.id.split("-"),o=a[1],parseInt(s.getAttribute("data-level"),10),r=s.getAttribute("data-type"),i=parseInt(s.getAttribute("data-hidden")),i=!isNaN(i)&&i?0:1,s.setAttribute("data-hidden",i.toString()),l.push(R(o)),S(i,l);var w=function(e){var t;switch(e){case"rows":t=H.rows;for(var n=0;n<=t;n++)if(k[n]&&k[n][C.countRows()-1])return!0;break;case"cols":t=H.cols;for(n=0;n<=t;n++)if(M[n]&&M[n][C.countCols()-1])return!0}return!1}(r=r||h),v=r.charAt(0).toUpperCase()+r.slice(1),y=Handsontable.Grouping["baseSpare"+v];w?0==y&&(C.alter("insert_"+r.slice(0,-1),C["count"+v]()),Handsontable.Grouping["dummy"+r.slice(0,-1)]=!0):0==y&&Handsontable.Grouping["dummy"+r.slice(0,-1)]&&(C.alter("remove_"+r.slice(0,-1),C["count"+v]()-1),Handsontable.Grouping["dummy"+r.slice(0,-1)]=!1),C.render(),e.stopImmediatePropagation()}var b},modifySelectionFactory:function(e){function n(e,t){var n=0;switch(e){case"down":for(;c(t);)n++,t.row+=1;break;case"up":for(;c(t);)n--,--t.row;break;case"right":for(;c(t);)n++,t.col+=1;break;case"left":for(;c(t);)n--,--t.col}return n}function t(e,t){0<e.row?c(t)&&(e.row+=n("down",t)):e.row<0&&c(t)&&(e.row+=n("up",t)),0<e.col?c(t)&&(e.col+=n("right",t)):e.col<0&&c(t)&&(e.col+=n("left",t))}var o,r=this.instance,i=new WalkontableCellCoords(0,0);switch(e){case"start":return function(e){o=r.getSelected(),i.row=o[0]+e.row,i.col=o[1]+e.col,t(e,i)};case"end":return function(e){o=r.getSelected(),i.row=o[2]+e.row,i.col=o[3]+e.col,t(e,i)}}},modifyRowHeight:function(e,t){if(C.view.wt.wtTable.rowFilter&&c({row:t,col:null}))return 0},validateGroups:function(){for(var e=function(e,t){if(e[0]<t[0]&&e[1]<t[1]&&t[0]<=e[1]||e[0]>t[0]&&t[1]<e[1]&&e[0]<=t[1])return!0},t=C.getSettings().groups,n=[],o=[],r=0,i=t.length;r<i;r++)if(t[r].rows){if(1===t[r].rows.length)throw new Error("Grouping error:  Group {"+t[r].rows[0]+"} is invalid. Cannot define single-entry groups.");if(0===t[r].rows.length)throw new Error("Grouping error:  Cannot define empty groups.");o.push(t[r].rows);for(var s=0,a=o.length;s<a;s++)if(e(t[r].rows,o[s]))throw new Error("Grouping error:  ranges {"+t[r].rows[0]+", "+t[r].rows[1]+"} and {"+o[s][0]+", "+o[s][1]+"} are overlapping.")}else if(t[r].cols){if(1===t[r].cols.length)throw new Error("Grouping error:  Group {"+t[r].cols[0]+"} is invalid. Cannot define single-entry groups.");if(0===t[r].cols.length)throw new Error("Grouping error:  Cannot define empty groups.");n.push(t[r].cols);for(var s=0,l=n.length;s<l;s++)if(e(t[r].cols,n[s]))throw new Error("Grouping error:  ranges {"+t[r].cols[0]+", "+t[r].cols[1]+"} and {"+n[s][0]+", "+n[s][1]+"} are overlapping.")}return!0},afterGetRowHeaderRenderers:function(e){Handsontable.Grouping.groupIndicatorsFactory(e,"vertical")},afterGetColumnHeaderRenderers:function(e){Handsontable.Grouping.groupIndicatorsFactory(e,"horizontal")},hookProxy:function(e,t){return function(){return C.getSettings().groups?t?Handsontable.Grouping[e](t).apply(this,arguments):Handsontable.Grouping[e].apply(this,arguments):void 0}}}}i.prototype.beforeInit=function(){};function s(){var e=this;if(!!e.getSettings().groups){var t={};if(Handsontable.Grouping=new i(e),e.getSettings().rowHeaders||(t.rowHeaders=!0),e.getSettings().colHeaders||(t.colHeaders=!0),(t.colHeaders||t.rowHeaders)&&e.updateSettings(t),!Handsontable.Grouping.validateGroups())return;e.addHook("beforeInit",Handsontable.Grouping.hookProxy("init")),e.addHook("afterUpdateSettings",Handsontable.Grouping.hookProxy("updateGroups")),e.addHook("afterGetColumnHeaderRenderers",Handsontable.Grouping.hookProxy("afterGetColumnHeaderRenderers")),e.addHook("afterGetRowHeaderRenderers",Handsontable.Grouping.hookProxy("afterGetRowHeaderRenderers")),e.addHook("afterGetRowHeader",Handsontable.Grouping.hookProxy("afterGetRowHeader")),e.addHook("afterGetColHeader",Handsontable.Grouping.hookProxy("afterGetColHeader")),e.addHook("beforeOnCellMouseDown",Handsontable.Grouping.hookProxy("toggleGroupVisibility")),e.addHook("modifyTransformStart",Handsontable.Grouping.hookProxy("modifySelectionFactory","start")),e.addHook("modifyTransformEnd",Handsontable.Grouping.hookProxy("modifySelectionFactory","end")),e.addHook("modifyRowHeight",Handsontable.Grouping.hookProxy("modifyRowHeight"))}}var x=function(){for(var e=document.querySelectorAll("colgroup"),t=0,n=e.length;t<n;t++){var o=e[t].querySelectorAll("col.rowHeader");if(0===o.length)return;for(var r=0,i=o.length+1;r<i;r++){if(2==i)return;r<Handsontable.Grouping.getLevels().rows+1&&(r==Handsontable.Grouping.getLevels().rows?D.addClass(o[r],"htGroupColClosest"):D.addClass(o[r],"htGroupCol"))}}};Handsontable.hooks.add("beforeInit",s),Handsontable.hooks.add("afterUpdateSettings",function(){this.getSettings().groups&&!Handsontable.Grouping?s.call(this,arguments):!this.getSettings().groups&&Handsontable.Grouping&&(Handsontable.Grouping.resetGroups(),Handsontable.Grouping=void 0)}),Handsontable.plugins.Grouping=i},{"./../../dom.js":27,"./../../plugins.js":45}],58:[function(e,t,n){"use strict";var o;Object.defineProperties(n,{ManualColumnFreeze:{get:function(){return r}},__esModule:{value:!0}});(o=e("./../../plugins.js"))&&o.__esModule;function r(r){var i=r.getSettings().fixedColumnsLeft;function e(e){e.items.push(Handsontable.ContextMenu.SEPARATOR,{key:"freeze_column",name:function(){var e=r.getSelected()[1];return i-1<e?"Freeze this column":"Unfreeze this column"},disabled:function(){var e=r.getSelected();return e[1]!==e[3]},callback:function(){var e=r.getSelected()[1];(i-1<e?u:d)(e)}})}function n(){r.updateSettings({fixedColumnsLeft:i+1}),i++}function o(){r.updateSettings({fixedColumnsLeft:i-1}),i--}function s(e){r.manualColumnPositions&&0!==r.manualColumnPositions.length||r.manualColumnPositions||(r.manualColumnPositions=[]),e?r.manualColumnPositions[e]||t(e+1):t(r.countCols())}function t(e){if(r.manualColumnPositions.length<e)for(var t=r.manualColumnPositions.length;t<e;t++)r.manualColumnPositions[t]=t}function a(e,t,n,o){null==n&&(n=e),"freeze"===o?r.manualColumnPositions.splice(i,0,r.manualColumnPositions.splice(t,1)[0]):"unfreeze"===o&&r.manualColumnPositions.splice(n,0,r.manualColumnPositions.splice(t,1)[0])}function l(e){for(var t=i,n=c(t),o=c(e);n<o;)n=c(++t);return t-1}function u(e){var t;e<=i-1||(s(t=c(e)||e),a(t,e,null,"freeze"),n(),r.view.wt.wtOverlays.leftOverlay.refresh(),r.view.wt.wtOverlays.adjustElementsSize())}function d(e){var t,n;i-1<e||(t=l(e),s(n=c(e)||e),a(n,e,t,"unfreeze"),o(),r.view.wt.wtOverlays.leftOverlay.refresh())}function c(e){return r.manualColumnPositions[e]}function h(e){return 1<this.manualColumnPositionsPluginUsages.length?e:c(e)}return{init:function(){void 0!==r.manualColumnPositionsPluginUsages?r.manualColumnPositionsPluginUsages.push("manualColumnFreeze"):r.manualColumnPositionsPluginUsages=["manualColumnFreeze"],r.addHook("modifyCol",h),r.addHook("afterContextMenuDefaultOptions",e)},freezeColumn:u,unfreezeColumn:d,helpers:{addFixedColumn:n,removeFixedColumn:o,checkPositionData:s,modifyColumnOrder:a,getBestColumnReturnPosition:l}}}Handsontable.hooks.add("beforeInit",function(){this.getSettings().manualColumnFreeze&&(Handsontable.plugins.manualColumnFreeze=r,this.manualColumnFreeze=new r(this),this.manualColumnFreeze.init.call(this))})},{"./../../plugins.js":45}],59:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{ManualColumnMove:{get:function(){return l}},__esModule:{value:!0}});var w=(o=e("./../../helpers.js"))&&o.__esModule&&o||{default:o},v=(r=e("./../../dom.js"))&&r.__esModule&&r||{default:r},a=((i=e("./../../eventManager.js"))&&i.__esModule&&i||{default:i}).eventManager;(s=e("./../../plugins.js"))&&s.__esModule;function l(){var l,u,n,o,r,i,d,c=document.createElement("DIV"),h=document.createElement("DIV"),e=a(this);c.className="manualColumnMover",h.className="manualColumnMoverGuide";function f(e){d=e;var t,n=(i=this).view.wt.wtTable.getCoords(e).col;0<=n&&(r=n,t=d.getBoundingClientRect(),o=t.left,c.style.top=t.top+"px",c.style.left=o+"px",i.rootElement.appendChild(c))}function s(){var s,a=this;e.addEventListener(a.rootElement,"mouseover",function(e){var t,n,o,r,i;!p(e.target)||(t=g(e.target))&&(s?0<=(n=a.view.wt.wtTable.getCoords(t).col)&&(u=n,o=e.target,r=u-l,i=o.getBoundingClientRect(),c.style.left=0<r?i.left+i.width-6+"px":i.left+"px"):f.call(a,t))}),e.addEventListener(a.rootElement,"mousedown",function(e){v.hasClass(e.target,"manualColumnMover")&&(n=w.pageX(e),function(){v.addClass(c,"active"),v.addClass(h,"active");var e=d.getBoundingClientRect();h.style.width=e.width+"px",h.style.height=this.view.maximumVisibleElementHeight(0)+"px",h.style.top=c.style.top,h.style.left=o+"px",this.rootElement.appendChild(h)}.call(a),s=a,u=l=r)}),e.addEventListener(window,"mousemove",function(e){var t;s&&(t=w.pageX(e)-n,h.style.left=o+t+"px")}),e.addEventListener(window,"mouseup",function(e){s&&(v.removeClass(c,"active"),v.removeClass(h,"active"),s=!1,t(a.manualColumnPositions,a.countCols()),a.manualColumnPositions.splice(u,0,a.manualColumnPositions.splice(l,1)[0]),a.forceFullRender=!0,a.view.render(),function(){Handsontable.hooks.run(this,"persistentStateSave","manualColumnPositions",this.manualColumnPositions)}.call(a),Handsontable.hooks.run(a,"afterColumnMove",l,u),f.call(a,d))}),a.addHook("afterDestroy",m)}var p=function(e){return"BODY"!=e.tagName&&("THEAD"==e.parentNode.tagName||(e=e.parentNode,p(e)))},g=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:g(e.parentNode):null},m=function(){e.clear()},t=function(e,t){if(e.length<t)for(var n=e.length;n<t;n++)e[n]=n};this.beforeInit=function(){this.manualColumnPositions=[]},this.init=function(e){var t,n,o;!!this.getSettings().manualColumnMove?(t=this.getSettings().manualColumnMove,void 0!==(n=function(){var e={};return Handsontable.hooks.run(this,"persistentStateLoad","manualColumnPositions",e),e.value}.call(this))?this.manualColumnPositions=n:Array.isArray(t)?this.manualColumnPositions=t:this.manualColumnPositions=[],"afterInit"==e&&(void 0!==this.manualColumnPositionsPluginUsages?this.manualColumnPositionsPluginUsages.push("manualColumnMove"):this.manualColumnPositionsPluginUsages=["manualColumnMove"],s.call(this),0<this.manualColumnPositions.length&&(this.forceFullRender=!0,this.render()))):-1<(o=this.manualColumnPositionsPluginUsages?this.manualColumnPositionsPluginUsages.indexOf("manualColumnMove"):-1)&&(m.call(this),this.manualColumnPositions=[],this.manualColumnPositionsPluginUsages[o]=void 0)},this.modifyCol=function(e){return this.getSettings().manualColumnMove?(void 0===this.manualColumnPositions[e]&&t(this.manualColumnPositions,e+1),this.manualColumnPositions[e]):e},this.afterRemoveCol=function(e,t){var o,n;this.getSettings().manualColumnMove&&(o=(n=this.manualColumnPositions).splice(e,t),n=n.map(function(e){for(var t=e,n=0;n<o.length;n++)e>o[n]&&t--;return t}),this.manualColumnPositions=n)},this.afterCreateCol=function(t,n){if(this.getSettings().manualColumnMove){var e=this.manualColumnPositions;if(e.length){for(var o=[],r=0;r<n;r++)o.push(t+r);t>=e.length?e.concat(o):(e=e.map(function(e){return t<=e?e+n:e})).splice.apply(e,[t,0].concat(o)),this.manualColumnPositions=e}}}}var u=new l;Handsontable.hooks.add("beforeInit",u.beforeInit),Handsontable.hooks.add("afterInit",function(){u.init.call(this,"afterInit")}),Handsontable.hooks.add("afterUpdateSettings",function(){u.init.call(this,"afterUpdateSettings")}),Handsontable.hooks.add("modifyCol",u.modifyCol),Handsontable.hooks.add("afterRemoveCol",u.afterRemoveCol),Handsontable.hooks.add("afterCreateCol",u.afterCreateCol),Handsontable.hooks.register("afterColumnMove")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],60:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{ManualColumnResize:{get:function(){return a}},__esModule:{value:!0}});var y=(o=e("./../../helpers.js"))&&o.__esModule&&o||{default:o},b=(r=e("./../../dom.js"))&&r.__esModule&&r||{default:r},C=((i=e("./../../eventManager.js"))&&i.__esModule&&i||{default:i}).eventManager;(s=e("./../../plugins.js"))&&s.__esModule;function a(){var i,s,a,o,l,u,d,c,h=document.createElement("DIV"),f=document.createElement("DIV"),e=C(this);h.className="manualColumnResizer",f.className="manualColumnResizerGuide";function p(e){i=e;var t,n=(o=this).view.wt.wtTable.getCoords(e).col;0<=n&&(s=n,t=i.getBoundingClientRect(),c=t.left-6,d=parseInt(t.width,10),h.style.top=t.top+"px",h.style.left=c+d+"px",o.rootElement.appendChild(h))}function r(){var n,o=this,t=0,r=null;e.addEventListener(o.rootElement,"mouseover",function(e){var t;!g(e.target)||(t=m(e.target))&&(n||p.call(o,t))}),e.addEventListener(o.rootElement,"mousedown",function(e){b.hasClass(e.target,"manualColumnResizer")&&(function(){b.addClass(h,"active"),b.addClass(f,"active"),f.style.top=h.style.top,f.style.left=h.style.left,f.style.height=this.view.maximumVisibleElementHeight(0)+"px",this.rootElement.appendChild(f)}.call(o),n=o,null==r&&(r=setTimeout(function(){2<=t&&(l=o.determineColumnWidth.call(o,s),v(s,l),o.forceFullRender=!0,o.view.render(),Handsontable.hooks.run(o,"afterColumnResize",s,l)),t=0,r=null},500),o._registerTimeout(r)),t++,u=y.pageX(e),l=d)}),e.addEventListener(window,"mousemove",function(e){n&&(a=d+(y.pageX(e)-u),l=v(s,a),h.style.left=c+a+"px",f.style.left=h.style.left)}),e.addEventListener(window,"mouseup",function(){n&&(b.removeClass(h,"active"),b.removeClass(f,"active"),n=!1,l!=d&&(o.forceFullRender=!0,o.view.render(),o.view.wt.wtOverlays.adjustElementsSize(),function(){Handsontable.hooks.run(this,"persistentStateSave","manualColumnWidths",this.manualColumnWidths)}.call(o),Handsontable.hooks.run(o,"afterColumnResize",s,l)),p.call(o,i))}),o.addHook("afterDestroy",w)}var g=function(e){return"BODY"!=e.tagName&&("THEAD"==e.parentNode.tagName||(e=e.parentNode,g(e)))},m=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:m(e.parentNode):null},w=function(){e.clear()};this.beforeInit=function(){this.manualColumnWidths=[]},this.init=function(e){var t,n;!!this.getSettings().manualColumnResize?(t=this.getSettings().manualColumnResize,n=function(){var e={};return Handsontable.hooks.run(this,"persistentStateLoad","manualColumnWidths",e),e.value}.call(this),void 0!==this.manualColumnWidthsPluginUsages?this.manualColumnWidthsPluginUsages.push("manualColumnResize"):this.manualColumnWidthsPluginUsages=["manualColumnResize"],void 0!==n?this.manualColumnWidths=n:Array.isArray(t)?this.manualColumnWidths=t:this.manualColumnWidths=[],"afterInit"==e&&(r.call(this),0<this.manualColumnWidths.length&&(this.forceFullRender=!0,this.render()))):-1<(this.manualColumnWidthsPluginUsages?this.manualColumnWidthsPluginUsages.indexOf("manualColumnResize"):-1)&&(w.call(this),this.manualColumnWidths=[])};var v=function(e,t){return t=Math.max(t,20),e=Handsontable.hooks.run(o,"modifyCol",e),o.manualColumnWidths[e]=t};this.modifyColWidth=function(e,t){return t=this.runHooks("modifyCol",t),this.getSettings().manualColumnResize&&this.manualColumnWidths[t]?this.manualColumnWidths[t]:e}}var l=new a;Handsontable.hooks.add("beforeInit",l.beforeInit),Handsontable.hooks.add("afterInit",function(){l.init.call(this,"afterInit")}),Handsontable.hooks.add("afterUpdateSettings",function(){l.init.call(this,"afterUpdateSettings")}),Handsontable.hooks.add("modifyColWidth",l.modifyColWidth),Handsontable.hooks.register("afterColumnResize")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],61:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{ManualRowMove:{get:function(){return a}},__esModule:{value:!0}});var m=(o=e("./../../helpers.js"))&&o.__esModule&&o||{default:o},w=(r=e("./../../dom.js"))&&r.__esModule&&r||{default:r},v=((i=e("./../../eventManager.js"))&&i.__esModule&&i||{default:i}).eventManager;(s=e("./../../plugins.js"))&&s.__esModule;function a(){var s,a,n,o,l,u,d=document.createElement("DIV"),c=document.createElement("DIV"),e=v(this);d.className="manualRowMover",c.className="manualRowMoverGuide";function h(e){u=e;var t,n=this.view.wt.wtTable.getCoords(e).row;0<=n&&(l=n,t=u.getBoundingClientRect(),o=t.top,d.style.top=o+"px",d.style.left=t.left+"px",this.rootElement.appendChild(d))}function i(){var r,i=this;e.addEventListener(i.rootElement,"mouseover",function(e){var t,n,o;!f(e.target)||(t=p(e.target))&&(r?(a=i.view.wt.wtTable.getCoords(t).row,n=a-s,o=t.getBoundingClientRect(),d.style.top=0<n?o.top+o.height-6+"px":o.top+"px"):h.call(i,t))}),e.addEventListener(i.rootElement,"mousedown",function(e){w.hasClass(e.target,"manualRowMover")&&(n=m.pageY(e),function(){w.addClass(d,"active"),w.addClass(c,"active");var e=u.getBoundingClientRect();c.style.width=this.view.maximumVisibleElementWidth(0)+"px",c.style.height=e.height+"px",c.style.top=o+"px",c.style.left=d.style.left,this.rootElement.appendChild(c)}.call(i),r=i,a=s=l)}),e.addEventListener(window,"mousemove",function(e){var t;r&&(t=m.pageY(e)-n,c.style.top=o+t+"px")}),e.addEventListener(window,"mouseup",function(e){r&&(w.removeClass(d,"active"),w.removeClass(c,"active"),r=!1,t(i.manualRowPositions,i.countRows()),i.manualRowPositions.splice(a,0,i.manualRowPositions.splice(s,1)[0]),i.forceFullRender=!0,i.view.render(),function(){Handsontable.hooks.run(this,"persistentStateSave","manualRowPositions",this.manualRowPositions)}.call(i),Handsontable.hooks.run(i,"afterRowMove",s,a),h.call(i,u))}),i.addHook("afterDestroy",g)}var f=function(e){return"BODY"!=e.tagName&&("TBODY"==e.parentNode.tagName||(e=e.parentNode,f(e)))},p=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:p(e.parentNode):null},g=function(){e.clear()},t=function(e,t){if(e.length<t)for(var n=e.length;n<t;n++)e[n]=n};this.beforeInit=function(){this.manualRowPositions=[]},this.init=function(e){var t,n,o,r=this;!!r.getSettings().manualRowMove?(t=r.getSettings().manualRowMove,n=function(){var e={};return Handsontable.hooks.run(this,"persistentStateLoad","manualRowPositions",e),e.value}.call(r),void 0!==r.manualRowPositionsPluginUsages?r.manualRowPositionsPluginUsages.push("manualColumnMove"):r.manualRowPositionsPluginUsages=["manualColumnMove"],void 0!==n?this.manualRowPositions=n:Array.isArray(t)?this.manualRowPositions=t:this.manualRowPositions=[],"afterInit"===e&&(i.call(this),0<this.manualRowPositions.length&&(r.forceFullRender=!0,r.render()))):-1<(o=r.manualRowPositionsPluginUsages?r.manualRowPositionsPluginUsages.indexOf("manualColumnMove"):-1)&&(g.call(this),r.manualRowPositions=[],r.manualRowPositionsPluginUsages[o]=void 0)},this.modifyRow=function(e){return this.getSettings().manualRowMove?(void 0===this.manualRowPositions[e]&&t(this.manualRowPositions,e+1),this.manualRowPositions[e]):e}}var l=new a;Handsontable.hooks.add("beforeInit",l.beforeInit),Handsontable.hooks.add("afterInit",function(){l.init.call(this,"afterInit")}),Handsontable.hooks.add("afterUpdateSettings",function(){l.init.call(this,"afterUpdateSettings")}),Handsontable.hooks.add("modifyRow",l.modifyRow),Handsontable.hooks.register("afterRowMove")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],62:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{ManualRowResize:{get:function(){return a}},__esModule:{value:!0}});var y=(o=e("./../../helpers.js"))&&o.__esModule&&o||{default:o},b=(r=e("./../../dom.js"))&&r.__esModule&&r||{default:r},C=((i=e("./../../eventManager.js"))&&i.__esModule&&i||{default:i}).eventManager;(s=e("./../../plugins.js"))&&s.__esModule;function a(){var i,s,a,o,l,u,d,c,h=document.createElement("DIV"),f=document.createElement("DIV"),e=C(this);h.className="manualRowResizer",f.className="manualRowResizerGuide";function p(e){i=e;var t,n=(o=this).view.wt.wtTable.getCoords(e).row;0<=n&&(s=n,t=i.getBoundingClientRect(),c=t.top-6,d=parseInt(t.height,10),h.style.left=t.left+"px",h.style.top=c+d+"px",o.rootElement.appendChild(h))}function r(){var n,o=this,t=0,r=null;e.addEventListener(o.rootElement,"mouseover",function(e){var t;!g(e.target)||(t=m(e.target))&&(n||p.call(o,t))}),e.addEventListener(o.rootElement,"mousedown",function(e){b.hasClass(e.target,"manualRowResizer")&&(function(){b.addClass(h,"active"),b.addClass(f,"active"),f.style.top=h.style.top,f.style.left=h.style.left,f.style.width=this.view.maximumVisibleElementWidth(0)+"px",this.rootElement.appendChild(f)}.call(o),n=o,null==r&&(r=setTimeout(function(){2<=t&&(v(s,null),o.forceFullRender=!0,o.view.render(),Handsontable.hooks.run(o,"afterRowResize",s,l)),t=0,r=null},500),o._registerTimeout(r)),t++,u=y.pageY(e),l=d)}),e.addEventListener(window,"mousemove",function(e){n&&(a=d+(y.pageY(e)-u),l=v(s,a),h.style.top=c+a+"px",f.style.top=h.style.top)}),e.addEventListener(window,"mouseup",function(e){n&&(b.removeClass(h,"active"),b.removeClass(f,"active"),n=!1,l!=d&&(o.forceFullRender=!0,o.view.render(),function(){Handsontable.hooks.run(this,"persistentStateSave","manualRowHeights",this.manualRowHeights)}.call(o),Handsontable.hooks.run(o,"afterRowResize",s,l)),p.call(o,i))}),o.addHook("afterDestroy",w)}var g=function(e){return"BODY"!=e.tagName&&("TBODY"==e.parentNode.tagName||(e=e.parentNode,g(e)))},m=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:m(e.parentNode):null},w=function(){e.clear()};this.beforeInit=function(){this.manualRowHeights=[]},this.init=function(e){var t,n,o;!!this.getSettings().manualRowResize?(t=this.getSettings().manualRowResize,n=function(){var e={};return Handsontable.hooks.run(this,"persistentStateLoad","manualRowHeights",e),e.value}.call(this),void 0!==this.manualRowHeightsPluginUsages?this.manualRowHeightsPluginUsages.push("manualRowResize"):this.manualRowHeightsPluginUsages=["manualRowResize"],void 0!==n?this.manualRowHeights=n:Array.isArray(t)?this.manualRowHeights=t:this.manualRowHeights=[],"afterInit"===e?(r.call(this),0<this.manualRowHeights.length&&(this.forceFullRender=!0,this.render())):(this.forceFullRender=!0,this.render())):-1<(o=this.manualRowHeightsPluginUsages?this.manualRowHeightsPluginUsages.indexOf("manualRowResize"):-1)&&(w.call(this),this.manualRowHeights=[],this.manualRowHeightsPluginUsages[o]=void 0)};var v=function(e,t){return e=Handsontable.hooks.run(o,"modifyRow",e),o.manualRowHeights[e]=t};this.modifyRowHeight=function(e,t){return this.getSettings().manualRowResize&&(t=this.runHooks("modifyRow",t),void 0!==this.manualRowHeights[t])?this.manualRowHeights[t]:e}}var l=new a;Handsontable.hooks.add("beforeInit",l.beforeInit),Handsontable.hooks.add("afterInit",function(){l.init.call(this,"afterInit")}),Handsontable.hooks.add("afterUpdateSettings",function(){l.init.call(this,"afterUpdateSettings")}),Handsontable.hooks.add("modifyRowHeight",l.modifyRowHeight),Handsontable.hooks.register("afterRowResize")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],63:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{MergeCells:{get:function(){return u}},__esModule:{value:!0}});(o=e("./../../plugins.js"))&&o.__esModule;var E=((r=e("./../../3rdparty/walkontable/src/cell/coords.js"))&&r.__esModule&&r||{default:r}).WalkontableCellCoords,T=((i=e("./../../3rdparty/walkontable/src/cell/range.js"))&&i.__esModule&&i||{default:i}).WalkontableCellRange,a=((s=e("./../../3rdparty/walkontable/src/table.js"))&&s.__esModule&&s||{default:s}).WalkontableTable;function l(){var e=[];return e.getInfo=function(e,t){for(var n=0,o=this.length;n<o;n++)if(this[n].row<=e&&this[n].row+this[n].rowspan-1>=e&&this[n].col<=t&&this[n].col+this[n].colspan-1>=t)return this[n]},e.setInfo=function(e){for(var t=0,n=this.length;t<n;t++)if(this[t].row===e.row&&this[t].col===e.col)return void(this[t]=e);this.push(e)},e.removeInfo=function(e,t){for(var n=0,o=this.length;n<o;n++)if(this[n].row===e&&this[n].col===t){this.splice(n,1);break}},e}function u(e){if(this.mergedCellInfoCollection=new l,Array.isArray(e))for(var t=0,n=e.length;t<n;t++)this.mergedCellInfoCollection.setInfo(e[t])}u.prototype.canMergeRange=function(e){return!e.isSingle()},u.prototype.mergeRange=function(e){var t,n,o;this.canMergeRange(e)&&(t=e.getTopLeftCorner(),n=e.getBottomRightCorner(),(o={}).row=t.row,o.col=t.col,o.rowspan=n.row-t.row+1,o.colspan=n.col-t.col+1,this.mergedCellInfoCollection.setInfo(o))},u.prototype.mergeOrUnmergeSelection=function(e){this.mergedCellInfoCollection.getInfo(e.from.row,e.from.col)?this.unmergeSelection(e.from):this.mergeSelection(e)},u.prototype.mergeSelection=function(e){this.mergeRange(e)},u.prototype.unmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.row,e.col);this.mergedCellInfoCollection.removeInfo(t.row,t.col)},u.prototype.applySpanProperties=function(e,t,n){var o=this.mergedCellInfoCollection.getInfo(t,n);o?o.row===t&&o.col===n?(e.setAttribute("rowspan",o.rowspan),e.setAttribute("colspan",o.colspan)):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"))},u.prototype.modifyTransform=function(e,t,n){var o,r,i,s,a,l={row:n.row,col:n.col};if("modifyTransformStart"==e){this.lastDesiredCoords||(this.lastDesiredCoords=new E(null,null));for(var u=new E(t.highlight.row,t.highlight.col),d=this.mergedCellInfoCollection.getInfo(u.row,u.col),c=0,h=this.mergedCellInfoCollection.length;c<h;c++){var f=this.mergedCellInfoCollection[c],f=new E(f.row+f.rowspan-1,f.col+f.colspan-1);if(t.includes(f)){0;break}}d&&(v=new E(d.row,d.col),y=new E(d.row+d.rowspan-1,d.col+d.colspan-1),new T(v,v,y).includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new E(null,null)),l.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-u.row:l.row,l.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-u.col:l.col,0<n.row?l.row=d.row+d.rowspan-1-u.row+n.row:n.row<0&&(l.row=u.row-d.row+n.row),0<n.col?l.col=d.col+d.colspan-1-u.col+n.col:n.col<0&&(l.col=u.col-d.col+n.col));var p=new E(t.highlight.row+l.row,t.highlight.col+l.col),g=this.mergedCellInfoCollection.getInfo(p.row,p.col);g&&(this.lastDesiredCoords=p,l={row:g.row-u.row,col:g.col-u.col})}else if("modifyTransformEnd"==e)for(c=0,h=this.mergedCellInfoCollection.length;c<h;c++){var m,w=this.mergedCellInfoCollection[c],v=new E(w.row,w.col),y=new E(w.row+w.rowspan-1,w.col+w.colspan-1),b=new T(v,v,y),C=t.getBordersSharedWith(b);b.isEqual(t)?t.setDirection("NW-SE"):0<C.length&&(m=t.highlight.isEqual(b.from),-1<C.indexOf("top")?t.to.isSouthEastOf(b.from)&&m?t.setDirection("NW-SE"):t.to.isSouthWestOf(b.from)&&m&&t.setDirection("NE-SW"):-1<C.indexOf("bottom")&&(t.to.isNorthEastOf(b.from)&&m?t.setDirection("SW-NE"):t.to.isNorthWestOf(b.from)&&m&&t.setDirection("SE-NW")));var p=(a=l,new E(t.to.row+a.row,t.to.col+a.col)),R=(i=w,(s=p).row>=i.row&&s.row<=i.row+i.rowspan-1),S=(o=w,(r=p).col>=o.col&&r.col<=o.col+o.colspan-1);t.includesRange(b)&&(b.includes(p)||R||S)&&(R&&(l.row<0?l.row-=w.rowspan-1:0<l.row&&(l.row+=w.rowspan-1)),S&&(l.col<0?l.col-=w.colspan-1:0<l.col&&(l.col+=w.colspan-1)))}0!==l.row&&(n.row=l.row),0!==l.col&&(n.col=l.col)};function d(r){return function(e){var t,n,o;this.getSettings().mergeCells&&(t=this.getSelectedRange(),this.mergeCells.modifyTransform(r,t,e),"modifyTransformEnd"===r&&(n=this.countRows(),o=this.countCols(),t.from.row<0?t.from.row=0:0<t.from.row&&t.from.row>=n&&(t.from.row=t.from-1),t.from.col<0?t.from.col=0:0<t.from.col&&t.from.col>=o&&(t.from.col=o-1)))}}var c=function(e){if(this.getSettings().mergeCells)for(var t,n=this.countCols(),o=0;o<n;o++){if((t=this.mergeCells.mergedCellInfoCollection.getInfo(e.startRow,o))&&t.row<e.startRow)return e.startRow=t.row,c.call(this,e);if(t=this.mergeCells.mergedCellInfoCollection.getInfo(e.endRow,o)){var r=t.row+t.rowspan-1;if(r>e.endRow)return e.endRow=r,c.call(this,e)}}},h=function(e){if(this.getSettings().mergeCells)for(var t,n=this.countRows(),o=0;o<n;o++){if((t=this.mergeCells.mergedCellInfoCollection.getInfo(o,e.startColumn))&&t.col<e.startColumn)return e.startColumn=t.col,h.call(this,e);if(t=this.mergeCells.mergedCellInfoCollection.getInfo(o,e.endColumn)){var r=t.col+t.colspan-1;if(r>e.endColumn)return e.endColumn=r,h.call(this,e)}}};Handsontable.hooks.add("beforeInit",function(){var e=this.getSettings().mergeCells;e&&(this.mergeCells||(this.mergeCells=new u(e)))}),Handsontable.hooks.add("afterInit",function(){var n=this;n.mergeCells&&(n.view.wt.wtTable.getCell=function(e){var t;return!n.getSettings().mergeCells||(t=n.mergeCells.mergedCellInfoCollection.getInfo(e.row,e.col))&&(e=t),a.prototype.getCell.call(this,e)})}),Handsontable.hooks.add("beforeKeyDown",function(e){this.mergeCells&&(e.ctrlKey||e.metaKey)&&!e.altKey&&77===e.keyCode&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),e.stopImmediatePropagation())}),Handsontable.hooks.add("modifyTransformStart",d("modifyTransformStart")),Handsontable.hooks.add("modifyTransformEnd",d("modifyTransformEnd")),Handsontable.hooks.add("beforeSetRangeEnd",function(e){if(this.lastDesiredCoords=null,this.getSettings().mergeCells){var t=this.getSelectedRange();t.highlight=new E(t.highlight.row,t.highlight.col),t.to=e;var n=!1;do{n=!1;for(var o=0,r=this.mergeCells.mergedCellInfoCollection.length;o<r;o++){var i=this.mergeCells.mergedCellInfoCollection[o],s=new E(i.row,i.col),a=new E(i.row+i.rowspan-1,i.col+i.colspan-1),l=new T(s,s,a);t.expandByRange(l)&&(e.row=t.to.row,e.col=t.to.col,n=!0)}}while(n)}}),Handsontable.hooks.add("beforeDrawBorders",function(e,t){if(t&&"area"==t&&this.getSettings().mergeCells)for(var n=this.getSelectedRange(),o=new T(n.from,n.from,n.from),r=new T(n.to,n.to,n.to),i=0,s=this.mergeCells.mergedCellInfoCollection.length;i<s;i++){var a=this.mergeCells.mergedCellInfoCollection[i],l=new E(a.row,a.col),u=new E(a.row+a.rowspan-1,a.col+a.colspan-1),d=new T(l,l,u);o.expandByRange(d)&&(e[0]=o.from.row,e[1]=o.from.col),r.expandByRange(d)&&(e[2]=r.from.row,e[3]=r.from.col)}}),Handsontable.hooks.add("afterIsMultipleSelection",function(e){if(e&&this.mergeCells){var t=this.mergeCells.mergedCellInfoCollection,n=this.getSelectedRange();for(var o in t)if(n.highlight.row==t[o].row&&n.highlight.col==t[o].col&&n.to.row==t[o].row+t[o].rowspan-1&&n.to.col==t[o].col+t[o].colspan-1)return!1}return e}),Handsontable.hooks.add("afterRenderer",function(e,t,n,o,r,i){this.mergeCells&&this.mergeCells.applySpanProperties(e,t,n)}),Handsontable.hooks.add("afterContextMenuDefaultOptions",function(e){this.getSettings().mergeCells&&(e.items.push(Handsontable.ContextMenu.SEPARATOR),e.items.push({key:"mergeCells",name:function(){var e=this.getSelected();return this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1])?"Unmerge cells":"Merge cells"},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render()},disabled:function(){return!1}}))}),Handsontable.hooks.add("afterGetCellMeta",function(e,t,n){var o;this.getSettings().mergeCells&&(!(o=this.mergeCells.mergedCellInfoCollection.getInfo(e,t))||o.row==e&&o.col==t||(n.copyable=!1))}),Handsontable.hooks.add("afterViewportRowCalculatorOverride",c),Handsontable.hooks.add("afterViewportColumnCalculatorOverride",h),Handsontable.hooks.add("afterAutofillApplyValues",function(e,t){var n;!this.getSettings().mergeCells||this.selection.isMultiple()||(n=this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1]))&&(e[0]=n.row,e[1]=n.col,e[2]=n.row+n.rowspan-1,e[3]=n.col+n.colspan-1)}),Handsontable.MergeCells=u},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../3rdparty/walkontable/src/cell/range.js":6,"./../../3rdparty/walkontable/src/table.js":20,"./../../plugins.js":45}],64:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{default:{get:function(){return f}},__esModule:{value:!0}});function a(e){var t=this;$traceurRuntime.superConstructor(h).call(this,e),this.dragged=[],this.eventManager=u(this.hot),this.bindTouchEvents(),this.hot.addHook("afterInit",function(){return t.init()})}var c=(o=e("./../../dom.js"))&&o.__esModule&&o||{default:o},l=((r=e("./../_base.js"))&&r.__esModule&&r||{default:r}).default,u=((i=e("./../../eventManager.js"))&&i.__esModule&&i||{default:i}).eventManager,d=((s=e("./../../plugins.js"))&&s.__esModule&&s||{default:s}).registerPlugin,h=a;$traceurRuntime.createClass(a,{init:function(){this.lastSetCell=null,Handsontable.plugins.multipleSelectionHandles=new h(this.hot)},bindTouchEvents:function(){var d=this;function t(e){if(1===d.dragged.length)return d.dragged.splice(0,d.dragged.length),!0;var t=d.dragged.indexOf(e);if(-1==t)return!1;0===t?d.dragged=d.dragged.slice(0,1):1==t&&(d.dragged=d.dragged.slice(-1))}this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(e){var t;return c.hasClass(e.target,"topLeftSelectionHandle-HitArea")?(t=d.hot.getSelectedRange(),d.dragged.push("topLeft"),d.touchStartRange={width:t.getWidth(),height:t.getHeight(),direction:t.getDirection()},e.preventDefault(),!1):c.hasClass(e.target,"bottomRightSelectionHandle-HitArea")?(t=d.hot.getSelectedRange(),d.dragged.push("bottomRight"),d.touchStartRange={width:t.getWidth(),height:t.getHeight(),direction:t.getDirection()},e.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(e){return c.hasClass(e.target,"topLeftSelectionHandle-HitArea")?(t.call(d,"topLeft"),d.touchStartRange=void 0,e.preventDefault(),!1):c.hasClass(e.target,"bottomRightSelectionHandle-HitArea")?(t.call(d,"bottomRight"),d.touchStartRange=void 0,e.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(e){var t,n,o,r,i,s,a,l=c.getWindowScrollTop(),u=c.getWindowScrollLeft();0!==d.dragged.length&&(t=document.elementFromPoint(e.touches[0].screenX-u,e.touches[0].screenY-l))&&t!==d.lastSetCell&&("TD"!=t.nodeName&&"TH"!=t.nodeName||(-1==(n=d.hot.getCoords(t)).col&&(n.col=0),r=(o=d.hot.getSelectedRange()).getWidth(),i=o.getHeight(),s=o.getDirection(),1==r&&1==i&&d.hot.selection.setRangeEnd(n),null!==(a=d.getCurrentRangeCoords(o,n,d.touchStartRange.direction,s,d.dragged[0])).start&&d.hot.selection.setRangeStart(a.start),d.hot.selection.setRangeEnd(a.end),d.lastSetCell=t),e.preventDefault())})},getCurrentRangeCoords:function(e,t,n,o,r){var i=e.getTopLeftCorner(),s=e.getBottomRightCorner(),a=e.getBottomLeftCorner(),l=e.getTopRightCorner(),u={start:null,end:null};switch(n){case"NE-SW":switch(o){case"NE-SW":case"NW-SE":u="topLeft"==r?{start:new WalkontableCellCoords(t.row,e.highlight.col),end:new WalkontableCellCoords(a.row,t.col)}:{start:new WalkontableCellCoords(e.highlight.row,t.col),end:new WalkontableCellCoords(t.row,i.col)};break;case"SE-NW":"bottomRight"==r&&(u={start:new WalkontableCellCoords(s.row,t.col),end:new WalkontableCellCoords(t.row,i.col)})}break;case"NW-SE":switch(o){case"NE-SW":"topLeft"==r?u={start:t,end:a}:u.end=t;break;case"NW-SE":"topLeft"==r?u={start:t,end:s}:u.end=t;break;case"SE-NW":"topLeft"==r?u={start:t,end:i}:u.end=t;break;case"SW-NE":"topLeft"==r?u={start:t,end:l}:u.end=t}break;case"SW-NE":switch(o){case"NW-SE":u="bottomRight"==r?{start:new WalkontableCellCoords(t.row,i.col),end:new WalkontableCellCoords(a.row,t.col)}:{start:new WalkontableCellCoords(i.row,t.col),end:new WalkontableCellCoords(t.row,s.col)};break;case"SW-NE":u="topLeft"==r?{start:new WalkontableCellCoords(e.highlight.row,t.col),end:new WalkontableCellCoords(t.row,s.col)}:{start:new WalkontableCellCoords(t.row,i.col),end:new WalkontableCellCoords(i.row,t.col)};break;case"SE-NW":"bottomRight"==r?u={start:new WalkontableCellCoords(t.row,l.col),end:new WalkontableCellCoords(i.row,t.col)}:"topLeft"==r&&(u={start:a,end:t})}break;case"SE-NW":switch(o){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"==r&&(u.end=t);break;case"SE-NW":"topLeft"==r?u.end=t:u={start:t,end:i}}}return u},isDragged:function(){return 0<this.dragged.length}},{},l);var f=a;d("multipleSelectionHandles",a)},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46}],65:[function(e,t,n){"use strict";var o,r;Object.defineProperties(n,{ObserveChanges:{get:function(){return s}},__esModule:{value:!0}});(o=e("./../../plugins.js"))&&o.__esModule;var i=((r=e("jsonpatch"))&&r.__esModule&&r||{default:r}).default;function s(){}function a(){var e=this.getSettings().observeChanges;e?(this.observer&&l.call(this),function(){var t=this;t.observeChangesActive=!0,t.pauseObservingChanges=function(){t.observeChangesActive=!1},t.resumeObservingChanges=function(){t.observeChangesActive=!0},t.observedData=t.getData(),t.observer=i.observe(t.observedData,function(e){t.observeChangesActive&&(function(e){for(var t=function(e){return function(e){var n=[];return e.filter(function(e){var t=s(e.path);if(-1!=["add","remove"].indexOf(e.op)&&!isNaN(t.col)){if(-1!=n.indexOf(t.col))return!1;n.push(t.col)}return!0})}(function(e){return e.filter(function(e){return!/[/]length/gi.test(e.path)})}(e))}(e),n=0,o=t.length;n<o;n++){var r=t[n],i=s(r.path);switch(r.op){case"add":isNaN(i.col)?this.runHooks("afterCreateRow",i.row):this.runHooks("afterCreateCol",i.col);break;case"remove":isNaN(i.col)?this.runHooks("afterRemoveRow",i.row,1):this.runHooks("afterRemoveCol",i.col,1);break;case"replace":this.runHooks("afterChange",[i.row,i.col,null,r.value],"external")}}function s(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(t[1],10),col:/^\d*$/.test(t[2])?parseInt(t[2],10):t[2]}}}.call(t,e),t.render()),t.runHooks("afterChangesObserved")})}.call(this),function(){this.addHook("afterDestroy",l),this.addHook("afterCreateRow",u),this.addHook("afterRemoveRow",u),this.addHook("afterCreateCol",u),this.addHook("afterRemoveCol",u),this.addHook("afterChange",function(e,t){"loadData"!=t&&u.call(this)})}.call(this)):e||l.call(this)}function l(){this.observer&&(function(){i.unobserve(this.observedData,this.observer),delete this.observeChangesActive,delete this.pauseObservingChanges,delete this.resumeObservingChanges}.call(this),function(){this.removeHook("afterDestroy",l),this.removeHook("afterCreateRow",u),this.removeHook("afterRemoveRow",u),this.removeHook("afterCreateCol",u),this.removeHook("afterRemoveCol",u),this.removeHook("afterChange",u)}.call(this))}function u(){var e=this;e.pauseObservingChanges(),e.addHookOnce("afterChangesObserved",function(){e.resumeObservingChanges()})}Handsontable.hooks.add("afterLoadData",a),Handsontable.hooks.add("afterUpdateSettings",a),Handsontable.hooks.register("afterChangesObserved")},{"./../../plugins.js":45,jsonpatch:"jsonpatch"}],66:[function(e,t,n){"use strict";var o;Object.defineProperties(n,{HandsontablePersistentState:{get:function(){return i}},__esModule:{value:!0}});(o=e("./../../plugins.js"))&&o.__esModule;function r(o){function n(){window.localStorage[o+"__persistentStateKeys"]=JSON.stringify(r)}var r,e,t;e=window.localStorage[o+"__persistentStateKeys"],t="string"==typeof e?JSON.parse(e):void 0,r=t||[],this.saveValue=function(e,t){window.localStorage[o+"_"+e]=JSON.stringify(t),-1==r.indexOf(e)&&(r.push(e),n())},this.loadValue=function(e,t){e=void 0!==e?e:t;var n=window.localStorage[o+"_"+e];return void 0===n?void 0:JSON.parse(n)},this.reset=function(e){window.localStorage.removeItem(o+"_"+e)},this.resetAll=function(){for(var e=0;e<r.length;e++)window.localStorage.removeItem(o+"_"+r[e]);r=[],n()}}function i(){var t=this;this.init=function(){var e=this.getSettings().persistentState;t.enabled=!!e,t.enabled?(this.storage||(this.storage=new r(this.rootElement.id)),this.resetState=t.resetValue,function(){for(var e in n)n.hasOwnProperty(e)&&this.addHook(e,n[e])}.call(this)):function(){for(var e in n)n.hasOwnProperty(e)&&this.removeHook(e,n[e])}.call(this)},this.saveValue=function(e,t){this.storage.saveValue(e,t)},this.loadValue=function(e,t){t.value=this.storage.loadValue(e)},this.resetValue=function(e){void 0!==e?this.storage.reset(e):this.storage.resetAll()};var n={persistentStateSave:t.saveValue,persistentStateLoad:t.loadValue,persistentStateReset:t.resetValue};for(var e in n)n.hasOwnProperty(e)&&Handsontable.hooks.register(e)}var s=new i;Handsontable.hooks.add("beforeInit",s.init),Handsontable.hooks.add("afterUpdateSettings",s.init)},{"./../../plugins.js":45}],67:[function(e,t,n){"use strict";var o,r,i,s,a,l=(o=e("./../../dom.js"))&&o.__esModule&&o||{default:o},u=(r=e("./../../renderers.js"))&&r.__esModule&&r||{default:r},d=u.registerRenderer,c=u.getRenderer;Handsontable.Search=function(f){this.query=function(e,t,n){var o=f.countRows(),r=f.countCols(),i=[];t=t||Handsontable.Search.global.getDefaultCallback(),n=n||Handsontable.Search.global.getDefaultQueryMethod();for(var s=0;s<o;s++)for(var a=0;a<r;a++){var l,u=f.getDataAtCell(s,a),d=f.getCellMeta(s,a),c=d.search.callback||t,h=(d.search.queryMethod||n)(e,u);h&&(l={row:s,col:a,data:u},i.push(l)),c&&c(f,s,a,u,h)}return i}},Handsontable.Search.DEFAULT_CALLBACK=function(e,t,n,o,r){e.getCellMeta(t,n).isSearchResult=r},Handsontable.Search.DEFAULT_QUERY_METHOD=function(e,t){return!(void 0===e||null==e||!e.toLowerCase||0===e.length)&&(void 0!==t&&null!=t&&-1!=t.toString().toLowerCase().indexOf(e.toLowerCase()))},Handsontable.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",Handsontable.Search.global=(i=Handsontable.Search.DEFAULT_CALLBACK,s=Handsontable.Search.DEFAULT_QUERY_METHOD,a=Handsontable.Search.DEFAULT_SEARCH_RESULT_CLASS,{getDefaultCallback:function(){return i},setDefaultCallback:function(e){i=e},getDefaultQueryMethod:function(){return s},setDefaultQueryMethod:function(e){s=e},getDefaultSearchResultClass:function(){return a},setDefaultSearchResultClass:function(e){a=e}}),Handsontable.SearchCellDecorator=function(e,t,n,o,r,i,s){var a=null!==s.search&&"object"==typeof s.search&&s.search.searchResultClass||Handsontable.Search.global.getDefaultSearchResultClass();s.isSearchResult?l.addClass(t,a):l.removeClass(t,a)};var h=c("base");function f(){!!this.getSettings().search?this.search=new Handsontable.Search(this):delete this.search}d("base",function(e,t,n,o,r,i,s){h.apply(this,arguments),Handsontable.SearchCellDecorator.apply(this,arguments)}),Handsontable.hooks.add("afterInit",f),Handsontable.hooks.add("afterUpdateSettings",f)},{"./../../dom.js":27,"./../../renderers.js":70}],68:[function(e,t,n){"use strict";var o,r,i;Object.defineProperties(n,{TouchScroll:{get:function(){return u}},__esModule:{value:!0}});var a=(o=e("./../../dom.js"))&&o.__esModule&&o||{default:o},s=((r=e("./../_base.js"))&&r.__esModule&&r||{default:r}).default,l=((i=e("./../../plugins.js"))&&i.__esModule&&i||{default:i}).registerPlugin,u=function(e){var t=this;$traceurRuntime.superConstructor(d).call(this,e),this.hot.addHook("afterInit",function(){return t.init()}),this.hot.addHook("afterUpdateSettings",function(){return t.onAfterUpdateSettings()}),this.scrollbars=[],this.clones=[]},d=u;$traceurRuntime.createClass(u,{init:function(){this.registerEvents(),this.onAfterUpdateSettings()},onAfterUpdateSettings:function(){var t=this;this.hot.addHookOnce("afterRender",function(){var e=t.hot.view.wt.wtOverlays;t.scrollbars=[],t.scrollbars.push(e.topOverlay),t.scrollbars.push(e.leftOverlay),e.topLeftCornerOverlay&&t.scrollbars.push(e.topLeftCornerOverlay),t.clones=[],e.topOverlay.needFullRender&&t.clones.push(e.topOverlay.clone.wtTable.holder.parentNode),e.leftOverlay.needFullRender&&t.clones.push(e.leftOverlay.clone.wtTable.holder.parentNode),e.topLeftCornerOverlay&&t.clones.push(e.topLeftCornerOverlay.clone.wtTable.holder.parentNode)})},registerEvents:function(){var e=this;this.hot.addHook("beforeTouchScroll",function(){return e.onBeforeTouchScroll()}),this.hot.addHook("afterMomentumScroll",function(){return e.onAfterMomentumScroll()})},onBeforeTouchScroll:function(){Handsontable.freezeOverlays=!0;for(var e=0,t=this.clones.length;e<t;e++)a.addClass(this.clones[e],"hide-tween")},onAfterMomentumScroll:function(){Handsontable.freezeOverlays=!1;for(var n=this,e=0,t=this.clones.length;e<t;e++)a.removeClass(this.clones[e],"hide-tween");for(var o=0,r=this.clones.length;o<r;o++)a.addClass(this.clones[o],"show-tween");setTimeout(function(){for(var e=0,t=n.clones.length;e<t;e++)a.removeClass(n.clones[e],"show-tween")},400);for(var i=0,s=this.scrollbars.length;i<s;i++)this.scrollbars[i].refresh(),this.scrollbars[i].resetFixedPosition();this.hot.view.wt.wtOverlays.syncScrollWithMaster()}},{},s),l("touchScroll",u)},{"./../../dom.js":27,"./../../plugins.js":45,"./../_base.js":46}],69:[function(e,t,n){"use strict";var o,a=(o=e("./../../helpers.js"))&&o.__esModule&&o||{default:o};function r(){var e,t,n=this;void 0===n.getSettings().undo||n.getSettings().undo?n.undoRedo||(n.undoRedo=new Handsontable.UndoRedo(n),(t=n).undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()},n.addHook("beforeKeyDown",i),n.addHook("afterChange",s)):n.undoRedo&&(delete n.undoRedo,delete(e=n).undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo,n.removeHook("beforeKeyDown",i),n.removeHook("afterChange",s))}function i(e){!e.ctrlKey&&!e.metaKey||e.altKey||(89===e.keyCode||e.shiftKey&&90===e.keyCode?(this.undoRedo.redo(),e.stopImmediatePropagation()):90===e.keyCode&&(this.undoRedo.undo(),e.stopImmediatePropagation()))}function s(e,t){if("loadData"==t)return this.undoRedo.clear()}Handsontable.UndoRedo=function(l){var u=this;this.instance=l,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,l.addHook("afterChange",function(e,t){var n;e&&(n=new Handsontable.UndoRedo.ChangeAction(e),u.done(n))}),l.addHook("afterCreateRow",function(e,t,n){var o;n||(o=new Handsontable.UndoRedo.CreateRowAction(e,t),u.done(o))}),l.addHook("beforeRemoveRow",function(e,t){var n=u.instance.getData();e=(n.length+e)%n.length;var o=n.slice(e,e+t),r=new Handsontable.UndoRedo.RemoveRowAction(e,o);u.done(r)}),l.addHook("afterCreateCol",function(e,t,n){var o;n||(o=new Handsontable.UndoRedo.CreateColumnAction(e,t),u.done(o))}),l.addHook("beforeRemoveCol",function(e,t){var n=u.instance.getData();e=(u.instance.countCols()+e)%u.instance.countCols();for(var o,r=[],i=0,s=n.length;i<s;i++)r[i]=n[i].slice(e,e+t);Array.isArray(l.getSettings().colHeaders)&&(o=l.getSettings().colHeaders.slice(e,e+r.length));var a=new Handsontable.UndoRedo.RemoveColumnAction(e,r,o);u.done(a)}),l.addHook("beforeCellAlignment",function(e,t,n,o){var r=new Handsontable.UndoRedo.CellAlignmentAction(e,t,n,o);u.done(r)})},Handsontable.UndoRedo.prototype.done=function(e){this.ignoreNewActions||(this.doneActions.push(e),this.undoneActions.length=0)},Handsontable.UndoRedo.prototype.undo=function(){var e,t;this.isUndoAvailable()&&(e=this.doneActions.pop(),this.ignoreNewActions=!0,t=this,e.undo(this.instance,function(){t.ignoreNewActions=!1,t.undoneActions.push(e)}))},Handsontable.UndoRedo.prototype.redo=function(){var e,t;this.isRedoAvailable()&&(e=this.undoneActions.pop(),this.ignoreNewActions=!0,t=this,e.redo(this.instance,function(){t.ignoreNewActions=!1,t.doneActions.push(e)}))},Handsontable.UndoRedo.prototype.isUndoAvailable=function(){return 0<this.doneActions.length},Handsontable.UndoRedo.prototype.isRedoAvailable=function(){return 0<this.undoneActions.length},Handsontable.UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},Handsontable.UndoRedo.Action=function(){},Handsontable.UndoRedo.Action.prototype.undo=function(){},Handsontable.UndoRedo.Action.prototype.redo=function(){},Handsontable.UndoRedo.ChangeAction=function(e){this.changes=e},a.inherit(Handsontable.UndoRedo.ChangeAction,Handsontable.UndoRedo.Action),Handsontable.UndoRedo.ChangeAction.prototype.undo=function(e,t){for(var n=a.deepClone(this.changes),o=e.countEmptyRows(!0),r=e.countEmptyCols(!0),i=0,s=n.length;i<s;i++)n[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtRowProp(n,null,null,"undo");for(i=0,s=n.length;i<s;i++)e.getSettings().minSpareRows&&n[i][0]+1+e.getSettings().minSpareRows===e.countRows()&&o==e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(n[i][0]+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&n[i][1]+1+e.getSettings().minSpareCols===e.countCols()&&r==e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(n[i][1]+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())},Handsontable.UndoRedo.ChangeAction.prototype.redo=function(e,t){for(var n=a.deepClone(this.changes),o=0,r=n.length;o<r;o++)n[o].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtRowProp(n,null,null,"redo")},Handsontable.UndoRedo.CreateRowAction=function(e,t){this.index=e,this.amount=t},a.inherit(Handsontable.UndoRedo.CreateRowAction,Handsontable.UndoRedo.Action),Handsontable.UndoRedo.CreateRowAction.prototype.undo=function(e,t){var n=e.countRows(),o=e.getSettings().minSpareRows;this.index>=n&&this.index-o<n&&(this.index-=o),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount)},Handsontable.UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index+1,this.amount)},Handsontable.UndoRedo.RemoveRowAction=function(e,t){this.index=e,this.data=t},a.inherit(Handsontable.UndoRedo.RemoveRowAction,Handsontable.UndoRedo.Action),Handsontable.UndoRedo.RemoveRowAction.prototype.undo=function(e,t){var n=[this.index,0];Array.prototype.push.apply(n,this.data),Array.prototype.splice.apply(e.getData(),n),e.addHookOnce("afterRender",t),e.render()},Handsontable.UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length)},Handsontable.UndoRedo.CreateColumnAction=function(e,t){this.index=e,this.amount=t},a.inherit(Handsontable.UndoRedo.CreateColumnAction,Handsontable.UndoRedo.Action),Handsontable.UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)},Handsontable.UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index+1,this.amount)},Handsontable.UndoRedo.CellAlignmentAction=function(e,t,n,o){this.stateBefore=e,this.range=t,this.type=n,this.alignment=o},Handsontable.UndoRedo.CellAlignmentAction.prototype.undo=function(e,t){if(e.contextMenu){for(var n=this.range.from.row;n<=this.range.to.row;n++)for(var o=this.range.from.col;o<=this.range.to.col;o++)e.setCellMeta(n,o,"className",this.stateBefore[n][o]||" htLeft");e.addHookOnce("afterRender",t),e.render()}},Handsontable.UndoRedo.CellAlignmentAction.prototype.redo=function(e,t){if(e.contextMenu){for(var n=this.range.from.row;n<=this.range.to.row;n++)for(var o=this.range.from.col;o<=this.range.to.col;o++)e.contextMenu.align.call(e,this.range,this.type,this.alignment);e.addHookOnce("afterRender",t),e.render()}},Handsontable.UndoRedo.RemoveColumnAction=function(e,t,n){this.index=e,this.data=t,this.amount=this.data[0].length,this.headers=n},a.inherit(Handsontable.UndoRedo.RemoveColumnAction,Handsontable.UndoRedo.Action),Handsontable.UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){for(var n,o,r=0,i=e.getData().length;r<i;r++)n=e.getSourceDataAtRow(r),o=[this.index,0],Array.prototype.push.apply(o,this.data[r]),Array.prototype.splice.apply(n,o);void 0!==this.headers&&(o=[this.index,0],Array.prototype.push.apply(o,this.headers),Array.prototype.splice.apply(e.getSettings().colHeaders,o)),e.addHookOnce("afterRender",t),e.render()},Handsontable.UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)},Handsontable.hooks.add("afterInit",r),Handsontable.hooks.add("afterUpdateSettings",r)},{"./../../helpers.js":42}],70:[function(e,t,n){"use strict";var o;Object.defineProperties(n,{registerRenderer:{get:function(){return s}},getRenderer:{get:function(){return a}},hasRenderer:{get:function(){return l}},__esModule:{value:!0}});var r=(o=e("./helpers.js"))&&o.__esModule&&o||{default:o},i={};function s(e,t){var n;i[e]=t,n=r.toUpperCaseFirst(e)+"Renderer",Handsontable.renderers[n]=t,Handsontable[n]=t}function a(e){if("function"==typeof e)return e;if("string"!=typeof e)throw Error('Only strings and functions can be passed as "renderer" parameter');if(!(e in i))throw Error('No editor registered under name "'+e+'"');return i[e]}function l(e){return e in i}Handsontable.renderers=Handsontable.renderers||{},Handsontable.renderers.registerRenderer=s,Handsontable.renderers.getRenderer=a},{"./helpers.js":42}],71:[function(e,t,n){"use strict";var o,r;Object.defineProperties(n,{cellDecorator:{get:function(){return i}},__esModule:{value:!0}});var a=(o=e("./../dom.js"))&&o.__esModule&&o||{default:o};function i(e,t,n,o,r,i,s){s.className&&(t.className?t.className=t.className+" "+s.className:t.className=s.className),s.readOnly&&a.addClass(t,s.readOnlyCellClassName),!1===s.valid&&s.invalidCellClassName?a.addClass(t,s.invalidCellClassName):a.removeClass(t,s.invalidCellClassName),!1===s.wordWrap&&s.noWordWrapClassName&&a.addClass(t,s.noWordWrapClassName),!i&&s.placeholder&&a.addClass(t,s.placeholderCellClassName)}(0,((r=e("./../renderers.js"))&&r.__esModule&&r||{default:r}).registerRenderer)("base",i),Handsontable.renderers.cellDecorator=i},{"./../dom.js":27,"./../renderers.js":70}],72:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{autocompleteRenderer:{get:function(){return g}},__esModule:{value:!0}});var u=(o=e("./../dom.js"))&&o.__esModule&&o||{default:o},d=((r=e("./../eventManager.js"))&&r.__esModule&&r||{default:r}).eventManager,a=(i=e("./../renderers.js"))&&i.__esModule&&i||{default:i},c=a.getRenderer,l=a.registerRenderer,h=((s=e("./../3rdparty/walkontable/src/cell/coords.js"))&&s.__esModule&&s||{default:s}).WalkontableCellCoords,f=document.createElement("DIV");f.className="htAutocompleteWrapper";var p=document.createElement("DIV");p.className="htAutocompleteArrow",p.appendChild(document.createTextNode(String.fromCharCode(9660)));function g(t,n,o,r,e,i,s){f.cloneNode(!0);var a,l=p.cloneNode(!0);c("text")(t,n,o,r,e,i,s),n.appendChild(l),u.addClass(n,"htAutocomplete"),n.firstChild||n.appendChild(document.createTextNode(String.fromCharCode(160))),t.acArrowListener||(a=d(t),t.acArrowListener=function(e){u.hasClass(e.target,"htAutocompleteArrow")&&t.view.wt.getSetting("onCellDblClick",null,new h(o,r),n)},a.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",function(){a.clear()}))}l("autocomplete",g)},{"./../3rdparty/walkontable/src/cell/coords.js":5,"./../dom.js":27,"./../eventManager.js":41,"./../renderers.js":70}],73:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{checkboxRenderer:{get:function(){return u}},__esModule:{value:!0}});var h=(o=e("./../dom.js"))&&o.__esModule&&o||{default:o},f=(r=e("./../helpers.js"))&&r.__esModule&&r||{default:r},p=((i=e("./../eventManager.js"))&&i.__esModule&&i||{default:i}).EventManager,a=(s=e("./../renderers.js"))&&s.__esModule&&s||{default:s},l=a.registerRenderer,g=document.createElement("INPUT");g.className="htCheckboxRendererInput",g.type="checkbox",g.setAttribute("autocomplete","off");var m=new WeakMap;function u(u,e,t,n,o,r,i){var s=new p(u),a=g.cloneNode(!1);function l(e){var o=void 0!==e?e:null;d(function(e){for(var t=0,n=e.length;t<n;t++)!function(e){var t=void 0!==arguments[1]?arguments[1]:null;e.checked=null===t?!e.checked:t;s.fireEvent(e,"change")}(e[t],o)})}function d(e){for(var t=u.getSelectedRange(),n=t.getTopLeftCorner(),o=t.getBottomRightCorner(),r=n.row;r<=o.row;r++)for(var i=n.col;i<=o.col;i++){var s=u.getCell(r,i),a=u.getCellMeta(r,i),l=s.querySelectorAll("input[type=checkbox]");0<l.length&&!a.readOnly&&e(l)}}function c(e){f.stopPropagation(e)}void 0===i.checkedTemplate&&(i.checkedTemplate=!0),void 0===i.uncheckedTemplate&&(i.uncheckedTemplate=!1),h.empty(e),r===i.checkedTemplate||f.equalsIgnoreCase(r,i.checkedTemplate)?(a.checked=!0,e.appendChild(a)):r===i.uncheckedTemplate||f.equalsIgnoreCase(r,i.uncheckedTemplate)?e.appendChild(a):null===r?(h.addClass(a,"noValue"),e.appendChild(a)):h.fastInnerText(e,"#bad value#"),i.readOnly?s.addEventListener(a,"click",function(e){e.preventDefault()}):(s.addEventListener(a,"mousedown",c),s.addEventListener(a,"mouseup",c),s.addEventListener(a,"change",function(e){u.setDataAtRowProp(t,o,e.target.checked?i.checkedTemplate:i.uncheckedTemplate)})),m.has(u)||(m.set(u,!0),u.addHook("beforeKeyDown",function(e){var t=[f.keyCode.SPACE,f.keyCode.ENTER,f.keyCode.DELETE,f.keyCode.BACKSPACE];h.enableImmediatePropagation(e),-1===t.indexOf(e.keyCode)||e.isImmediatePropagationStopped()||d(function(){e.stopImmediatePropagation(),e.preventDefault()});e.keyCode!=f.keyCode.SPACE&&e.keyCode!=f.keyCode.ENTER||l();e.keyCode!=f.keyCode.DELETE&&e.keyCode!=f.keyCode.BACKSPACE||l(!1)}))}l("checkbox",u)},{"./../dom.js":27,"./../eventManager.js":41,"./../helpers.js":42,"./../renderers.js":70}],74:[function(e,t,n){"use strict";var o,r;Object.defineProperties(n,{htmlRenderer:{get:function(){return s}},__esModule:{value:!0}});var a=(o=e("./../dom.js"))&&o.__esModule&&o||{default:o},i=(r=e("./../renderers.js"))&&r.__esModule&&r||{default:r},l=i.getRenderer;function s(e,t,n,o,r,i,s){l("base").apply(this,arguments),a.fastInnerHTML(t,i)}(0,i.registerRenderer)("html",s)},{"./../dom.js":27,"./../renderers.js":70}],75:[function(e,t,n){"use strict";var o,r,i,s;Object.defineProperties(n,{numericRenderer:{get:function(){return h}},__esModule:{value:!0}});var a=(o=e("./../dom.js"))&&o.__esModule&&o||{default:o},l=(r=e("./../helpers.js"))&&r.__esModule&&r||{default:r},u=((i=e("numeral"))&&i.__esModule&&i||{default:i}).default,d=(s=e("./../renderers.js"))&&s.__esModule&&s||{default:s},c=d.getRenderer;function h(e,t,n,o,r,i,s){l.isNumeric(i)&&(void 0!==s.language&&u.language(s.language),i=u(i).format(s.format||"0"),a.addClass(t,"htNumeric")),c("text")(e,t,n,o,r,i,s)}(0,d.registerRenderer)("numeric",h)},{"./../dom.js":27,"./../helpers.js":42,"./../renderers.js":70,numeral:"numeral"}],76:[function(e,t,n){"use strict";var o,r;Object.defineProperties(n,{passwordRenderer:{get:function(){return s}},__esModule:{value:!0}});var d=(o=e("./../dom.js"))&&o.__esModule&&o||{default:o},i=(r=e("./../renderers.js"))&&r.__esModule&&r||{default:r},c=i.getRenderer;function s(e,t,n,o,r,i,s){c("text").apply(this,arguments),i=t.innerHTML;for(var a=s.hashLength||i.length,l=s.hashSymbol||"*",u="";u.split(l).length-1<a;u+=l);d.fastInnerHTML(t,u)}(0,i.registerRenderer)("password",s)},{"./../dom.js":27,"./../renderers.js":70}],77:[function(e,t,n){"use strict";var o,r,i;Object.defineProperties(n,{textRenderer:{get:function(){return a}},__esModule:{value:!0}});var u=(o=e("./../dom.js"))&&o.__esModule&&o||{default:o},d=(r=e("./../helpers.js"))&&r.__esModule&&r||{default:r},s=(i=e("./../renderers.js"))&&i.__esModule&&i||{default:i},c=s.getRenderer;function a(e,t,n,o,r,i,s){c("base").apply(this,arguments),!i&&s.placeholder&&(i=s.placeholder);var a,l=d.stringify(i);e.getSettings().trimWhitespace||(l=l.replace(/ /g,String.fromCharCode(160))),s.rendererTemplate?(u.empty(t),(a=document.createElement("TEMPLATE")).setAttribute("bind","{{}}"),a.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(a),a.model=e.getSourceDataAtRow(n),t.appendChild(a)):u.fastInnerText(t,l)}(0,s.registerRenderer)("text",a)},{"./../dom.js":27,"./../helpers.js":42,"./../renderers.js":70}],78:[function(e,t,n){"use strict";Array.prototype.filter||(Array.prototype.filter=function(e,t){if(null==this)throw new TypeError;if("function"!=typeof e)throw new TypeError;/NodeList/i.test((t=t||this).item)&&(t=function(e){for(var t=[],n=0,o=e.length;n<o;n++)t[n]=e[n];return t}(t));for(var n,o=t.length,r=[],i=0;i<o;i+=1)t.hasOwnProperty(i)&&(n=t[i],e.call(t,n,i,t)&&r.push(n));return r})},{}],79:[function(e,t,n){"use strict";Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,n=Number(arguments[1])||0;for((n=n<0?Math.ceil(n):Math.floor(n))<0&&(n+=t);n<t;n++)if(n in this&&this[n]===e)return n;return-1})},{}],80:[function(e,t,n){"use strict";Array.isArray||(Array.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)})},{}],81:[function(n,e,t){"use strict";function o(e){return{configurable:!0,enumerable:!1,value:e,writable:!0}}function r(){return"__$"+Math.floor(1e9*Math.random())+"$"+ ++I+"$__"}function i(){var e=r();return G[e]=!0,e}function s(e){return"object"==typeof e&&e instanceof l}function a(e){var t=new l(e);if(!(this instanceof a))return t;throw new TypeError("Symbol cannot be new'ed")}function l(e){var t=r();M(this,F,{value:this}),M(this,B,{value:t}),M(this,V,{value:e}),d(this),Y[t]=this}function u(e){var t=e[z];return t&&t.self===e?t:N(e)?($.hash.value=X++,$.self.value=e,U.value=H(null,$),M(e,z,U),U.value):void 0}function d(e){return u(e),O.apply(this,arguments)}function c(e){return u(e),P.apply(this,arguments)}function h(e){return u(e),L.apply(this,arguments)}function f(e){return Y[e]||G[e]}function p(e){return s(e)?e[B]:e}function g(e){for(var t=[],n=0;n<e.length;n++)f(e[n])||t.push(e[n]);return t}function m(e){return g(x(e))}function w(e){return g(A(e))}function v(e){for(var t=[],n=x(e),o=0;o<n.length;o++){var r=Y[n[o]];r&&t.push(r)}return t}function y(e,t){return D(e,p(t))}function b(e){return j.call(this,p(e))}function C(e){return E.traceur&&E.traceur.options[e]}function R(e,t,n){return s(t)&&(t=t[B]),M(e,t,n),e}function S(e){var t,n,o;n=a,(t=e).Symbol||(t.Symbol=n,Object.getOwnPropertySymbols=v),t.Symbol.iterator||(t.Symbol.iterator=n("Symbol.iterator")),e.Reflect=e.Reflect||{},e.Reflect.global=e.Reflect.global||e,o=e.Object,M(o,"defineProperty",{value:R}),M(o,"getOwnPropertyNames",{value:m}),M(o,"getOwnPropertyDescriptor",{value:y}),M(o.prototype,"hasOwnProperty",{value:b}),M(o,"freeze",{value:d}),M(o,"preventExtensions",{value:c}),M(o,"seal",{value:h}),M(o,"keys",{value:w})}var E,T,_,H,k,M,O,D,x,A,j,P,L,N,W,I,B,V,F,Y,G,z,U,$,X,K,q,Z,J,Q,ee,te,ne,oe,re,ie;function se(e,t){var n=ne(e);do{var o=te(n,t);if(o)return o;n=ne(n)}while(n)}function ae(e,t,n,o){return le(e,t,n).apply(e,o)}function le(e,t,n){var o=se(t,n);if(o)return o.get?o.get.call(e):o.value}function ue(e){for(var t={},n=re(e),o=0;o<n.length;o++){var r=n[o];t[r]=te(e,r)}for(var i=ie(e),o=0;o<i.length;o++){var s=i[o];t[$traceurRuntime.toProperty(s)]=te(e,$traceurRuntime.toProperty(s))}return t}(E=window).$traceurRuntime||(T=Object,_=TypeError,H=T.create,k=T.defineProperties,M=T.defineProperty,O=T.freeze,D=T.getOwnPropertyDescriptor,x=T.getOwnPropertyNames,A=T.keys,j=T.prototype.hasOwnProperty,T.prototype.toString,P=Object.preventExtensions,L=Object.seal,N=Object.isExtensible,W=o,I=0,B=r(),V=r(),F=r(),Y=H(null),G=H(null),M(a.prototype,"constructor",o(a)),M(a.prototype,"toString",W(function(){var e=this[F];if(!C("symbols"))return e[B];if(!e)throw TypeError("Conversion from symbol to string");var t=e[V];return void 0===t&&(t=""),"Symbol("+t+")"})),M(a.prototype,"valueOf",W(function(){var e=this[F];if(!e)throw TypeError("Conversion from symbol to string");return C("symbols")?e:e[B]})),M(l.prototype,"constructor",o(a)),M(l.prototype,"toString",{value:a.prototype.toString,enumerable:!1}),M(l.prototype,"valueOf",{value:a.prototype.valueOf,enumerable:!1}),z=i(),U={value:void 0},$={hash:{value:void 0},self:{value:void 0}},X=0,d(l.prototype),S(E),E.$traceurRuntime={checkObjectCoercible:function(e){if(null==e)throw new TypeError("Value cannot be converted to an Object");return e},createPrivateName:i,defineProperties:k,defineProperty:M,exportStar:function(n){for(var e=1;e<arguments.length;e++)for(var t=x(arguments[e]),o=0;o<t.length;o++){f(t[o])||function(e,t){M(n,t,{get:function(){return e[t]},enumerable:!0})}(arguments[e],t[o])}return n},getOwnHashObject:u,getOwnPropertyDescriptor:D,getOwnPropertyNames:x,isObject:function(e){return null!=e&&("object"==typeof e||"function"==typeof e)},isPrivateName:function(e){return G[e]},isSymbolString:f,keys:A,setupGlobals:S,toObject:function(e){if(null==e)throw _();return T(e)},toProperty:p,typeof:function(e){return s(e)?"symbol":typeof e}}),$traceurRuntime.require=function(e,t){if(K=K||void 0!==n&&n("path"),"/"!==t.slice(-1)&&"/"!==t[0])return"."===t[0]?n(K.resolve(K.dirname(e),t)):n(t)},$traceurRuntime.spread=function(){for(var e,t=[],n=0,o=0;o<arguments.length;o++){var r=$traceurRuntime.checkObjectCoercible(arguments[o]);if("function"!=typeof r[$traceurRuntime.toProperty(Symbol.iterator)])throw new TypeError("Cannot spread non-iterable object.");for(var i=r[$traceurRuntime.toProperty(Symbol.iterator)]();!(e=i.next()).done;)t[n++]=e.value}return t},q=Object,Z=TypeError,J=q.create,Q=$traceurRuntime.defineProperties,ee=$traceurRuntime.defineProperty,te=$traceurRuntime.getOwnPropertyDescriptor,$traceurRuntime.getOwnPropertyNames,ne=Object.getPrototypeOf,oe=Object,re=oe.getOwnPropertyNames,ie=oe.getOwnPropertySymbols,$traceurRuntime.createClass=function(e,t,n,o){return ee(t,"constructor",{value:e,configurable:!0,enumerable:!1,writable:!0}),3<arguments.length?("function"==typeof o&&(e.__proto__=o),e.prototype=J(function(e){if("function"==typeof e){var t=e.prototype;if(q(t)===t||null===t)return e.prototype;throw new Z("super prototype must be an Object or null")}if(null===e)return null;throw new Z("Super expression must either be null or a function, not "+typeof e+".")}(o),ue(t))):e.prototype=t,ee(e,"prototype",{configurable:!1,writable:!1}),Q(e,ue(n))},$traceurRuntime.defaultSuperCall=function(e,t,n){null!==ne(t)&&ae(e,t,"constructor",n)},$traceurRuntime.superCall=ae,$traceurRuntime.superConstructor=function(e){return e.__proto__},$traceurRuntime.superGet=le,$traceurRuntime.superSet=function(e,t,n,o){var r=se(t,n);if(r&&r.set)return r.set.call(e,o),o;throw Z("super has no setter '"+n+"'.")}},{path:void 0}],82:[function(e,t,n){"use strict";var r,i,s,a;Object.keys||(Object.keys=(r=Object.prototype.hasOwnProperty,i=!{toString:null}.propertyIsEnumerable("toString"),a=(s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var t,n,o=[];for(t in e)r.call(e,t)&&o.push(t);if(i)for(n=0;n<a;n++)r.call(e,s[n])&&o.push(s[n]);return o}))},{}],83:[function(e,t,n){"use strict";var o;String.prototype.trim||(o=/^\s+|\s+$/g,String.prototype.trim=function(){return this.replace(o,"")})},{}],84:[function(e,t,n){"use strict";"undefined"==typeof WeakMap&&function(){var o=Object.defineProperty;try{var t=!0;o(function(){},"foo",{})}catch(e){t=!1}function e(){this.name="__st"+(1e9*Math.random()>>>0)+n+++"__",t||(this._wmCache=[])}var n=+new Date%1e9;e.prototype=t?{set:function(e,t){var n=e[this.name];n&&n[0]===e?n[1]=t:o(e,this.name,{value:[e,t],writable:!0})},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},has:function(e){return!!this.get(e)},delete:function(e){this.set(e,void 0)}}:{set:function(e,t){if(void 0!==e&&void 0!==t){for(var n=0,o=this._wmCache.length;n<o;n++)if(this._wmCache[n].key==e)return void(this._wmCache[n].value=t);this._wmCache.push({key:e,value:t})}},get:function(e){if(void 0!==e)for(var t=0,n=this._wmCache.length;t<n;t++)if(this._wmCache[t].key==e)return this._wmCache[t].value},has:function(e){return!!this.get(e)},delete:function(e){if(void 0!==e)for(var t=0,n=this._wmCache.length;t<n;t++)this._wmCache[t].key==e&&Array.prototype.slice.call(this._wmCache,t,1)}},window.WeakMap=e}()},{}],85:[function(e,t,n){"use strict";var o,r,i,s,a,l;Object.defineProperties(n,{TableView:{get:function(){return g}},__esModule:{value:!0}});var u=(o=e("./dom.js"))&&o.__esModule&&o||{default:o},d=(r=e("./helpers.js"))&&r.__esModule&&r||{default:r},c=((i=e("./eventManager.js"))&&i.__esModule&&i||{default:i}).eventManager,h=((s=e("./3rdparty/walkontable/src/cell/coords.js"))&&s.__esModule&&s||{default:s}).WalkontableCellCoords,f=((a=e("./3rdparty/walkontable/src/selection.js"))&&a.__esModule&&a||{default:a}).WalkontableSelection,p=((l=e("./3rdparty/walkontable/src/core.js"))&&l.__esModule&&l||{default:l}).Walkontable;function g(i){var a=this;this.eventManager=c(i),this.instance=i,this.settings=i.getSettings();var e=i.rootElement.getAttribute("style");e&&i.rootElement.setAttribute("data-originalstyle",e),u.addClass(i.rootElement,"handsontable");var s,t=document.createElement("TABLE");t.className="htCore",this.THEAD=document.createElement("THEAD"),t.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),t.appendChild(this.TBODY),i.table=t,i.container.insertBefore(t,i.container.firstChild),this.eventManager.addEventListener(i.rootElement,"mousedown",function(e){a.isTextSelectionAllowed(e.target)||(n(),e.preventDefault(),window.focus())}),this.eventManager.addEventListener(document.documentElement,"keyup",function(e){i.selection.isInProgress()&&!e.shiftKey&&i.selection.finish()}),this.isMouseDown=function(){return s},this.eventManager.addEventListener(document.documentElement,"mouseup",function(e){i.selection.isInProgress()&&1===e.which&&i.selection.finish(),s=!1,d.isOutsideInput(document.activeElement)&&i.unlisten()}),this.eventManager.addEventListener(document.documentElement,"mousedown",function(e){var t=e.target,n=e.x||e.clientX,o=e.y||e.clientY;if(!s){if(t!==i.view.wt.wtTable.holder)for(;t!==document.documentElement;){if(null===t){if(e.isTargetWebComponent)break;return}if(t===i.rootElement)return;t=t.parentNode}else{var r=Handsontable.Dom.getScrollbarWidth();if(document.elementFromPoint(n+r,o)!==i.view.wt.wtTable.holder||document.elementFromPoint(n,o+r)!==i.view.wt.wtTable.holder)return}a.settings.outsideClickDeselects?i.deselectCell():i.destroyEditor()}}),this.eventManager.addEventListener(t,"selectstart",function(e){a.settings.fragmentSelection||e.preventDefault()});var n=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},o=[new f({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return a.settings.fillHandle&&!a.isCellEdited()&&!i.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!a.isCellEdited()&&!i.selection.isMultiple()}}}),new f({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return a.settings.fillHandle&&!a.isCellEdited()&&i.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!a.isCellEdited()&&i.selection.isMultiple()}}}),new f({className:"highlight",highlightRowClassName:a.settings.currentRowClassName,highlightColumnClassName:a.settings.currentColClassName}),new f({className:"fill",border:{width:1,color:"red"}})];o.current=o[0],o.area=o[1],o.highlight=o[2],o.fill=o[3];var r={debug:function(){return a.settings.debug},table:t,stretchH:this.settings.stretchH,data:i.getDataAtCell,totalRows:i.countRows,totalColumns:i.countCols,fixedColumnsLeft:function(){return a.settings.fixedColumnsLeft},fixedRowsTop:function(){return a.settings.fixedRowsTop},renderAllRows:a.settings.renderAllRows,rowHeaders:function(){var e=[];return i.hasRowHeaders()&&e.push(function(e,t){a.appendRowHeader(e,t)}),Handsontable.hooks.run(i,"afterGetRowHeaderRenderers",e),e},columnHeaders:function(){var e=[];return i.hasColHeaders()&&e.push(function(e,t){a.appendColHeader(e,t)}),Handsontable.hooks.run(i,"afterGetColumnHeaderRenderers",e),e},columnWidth:i.getColWidth,rowHeight:i.getRowHeight,cellRenderer:function(e,t,n){var o=a.instance.colToProp(t),r=a.instance.getCellMeta(e,t),i=a.instance.getCellRenderer(r),s=a.instance.getDataAtRowProp(e,o);i(a.instance,n,e,t,o,s,r),Handsontable.hooks.run(a.instance,"afterRenderer",n,e,t,o,s,r)},selections:o,hideBorderOnMouseDownOver:function(){return a.settings.fragmentSelection},onCellMouseDown:function(e,t,n,o){i.listen(),a.activeWt=o,s=!0,u.enableImmediatePropagation(e),Handsontable.hooks.run(i,"beforeOnCellMouseDown",e,t,n),e.isImmediatePropagationStopped()||(2===e.button&&i.selection.inInSelection(t)||(e.shiftKey?0<=t.row&&0<=t.col&&i.selection.setRangeEnd(t):(t.row<0||t.col<0)&&(0<=t.row||0<=t.col)?(t.row<0&&(i.selectCell(0,t.col,i.countRows()-1,t.col),i.selection.setSelectedHeaders(!1,!0)),t.col<0&&(i.selectCell(t.row,0,t.row,i.countCols()-1),i.selection.setSelectedHeaders(!0,!1))):(t.row=t.row<0?0:t.row,t.col=t.col<0?0:t.col,i.selection.setRangeStart(t))),Handsontable.hooks.run(i,"afterOnCellMouseDown",e,t,n),a.activeWt=a.wt)},onCellMouseOver:function(e,t,n,o){a.activeWt=o,0<=t.row&&0<=t.col?s&&i.selection.setRangeEnd(t):s&&(t.row<0&&(i.selection.setRangeEnd(new h(i.countRows()-1,t.col)),i.selection.setSelectedHeaders(!1,!0)),t.col<0&&(i.selection.setRangeEnd(new h(t.row,i.countCols()-1)),i.selection.setSelectedHeaders(!0,!1))),Handsontable.hooks.run(i,"afterOnCellMouseOver",e,t,n),a.activeWt=a.wt},onCellCornerMouseDown:function(e){e.preventDefault(),Handsontable.hooks.run(i,"afterOnCellCornerMouseDown",e)},beforeDraw:function(e){a.beforeRender(e)},onDraw:function(e){a.onDraw(e)},onScrollVertically:function(){i.runHooks("afterScrollVertically")},onScrollHorizontally:function(){i.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(e,t){i.runHooks("beforeDrawBorders",e,t)},onBeforeTouchScroll:function(){i.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){i.runHooks("afterMomentumScroll")},viewportRowCalculatorOverride:function(e){a.settings.viewportRowRenderingOffset&&(e.startRow=Math.max(e.startRow-a.settings.viewportRowRenderingOffset,0),e.endRow=Math.min(e.endRow+a.settings.viewportRowRenderingOffset,i.countRows()-1)),i.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:function(e){a.settings.viewportColumnRenderingOffset&&(e.startColumn=Math.max(e.startColumn-a.settings.viewportColumnRenderingOffset,0),e.endColumn=Math.min(e.endColumn+a.settings.viewportColumnRenderingOffset,i.countCols()-1)),i.runHooks("afterViewportColumnCalculatorOverride",e)}};Handsontable.hooks.run(i,"beforeInitWalkontable",r),this.wt=new p(r),this.activeWt=this.wt,this.eventManager.addEventListener(a.wt.wtTable.spreader,"mousedown",function(e){e.target===a.wt.wtTable.spreader&&3===e.which&&d.stopPropagation(e)}),this.eventManager.addEventListener(a.wt.wtTable.spreader,"contextmenu",function(e){e.target===a.wt.wtTable.spreader&&3===e.which&&d.stopPropagation(e)}),this.eventManager.addEventListener(document.documentElement,"click",function(){a.settings.observeDOMVisibility&&a.wt.drawInterrupted&&(a.instance.forceFullRender=!0,a.render())})}(Handsontable.TableView=g).prototype.isTextSelectionAllowed=function(e){return!!d.isInput(e)||!(!this.settings.fragmentSelection||!u.isChildOf(e,this.TBODY))},g.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()},g.prototype.beforeRender=function(e){e&&Handsontable.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender)},g.prototype.onDraw=function(e){e&&Handsontable.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)},g.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1},g.prototype.getCellAtCoords=function(e,t){var n=this.wt.getCell(e,t);return n<0?null:n},g.prototype.scrollViewport=function(e){this.wt.scrollViewport(e)},g.prototype.appendRowHeader=function(e,t){if(t.firstChild){var n=t.firstChild;if(!u.hasClass(n,"relative"))return u.empty(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.firstChild,e,this.instance.getRowHeader)}else{var o=document.createElement("div"),r=document.createElement("span");o.className="relative",r.className="colHeader",this.updateCellHeader(r,e,this.instance.getRowHeader),o.appendChild(r),t.appendChild(o)}Handsontable.hooks.run(this.instance,"afterGetRowHeader",e,t)},g.prototype.appendColHeader=function(e,t){if(t.firstChild){var n=t.firstChild;if(!u.hasClass(n,"relative"))return u.empty(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.firstChild,e,this.instance.getColHeader)}else{var o=document.createElement("div"),r=document.createElement("span");o.className="relative",r.className="colHeader",this.updateCellHeader(r,e,this.instance.getColHeader),o.appendChild(r),t.appendChild(o)}Handsontable.hooks.run(this.instance,"afterGetColHeader",e,t)},g.prototype.updateCellHeader=function(e,t,n){-1<t?u.fastInnerHTML(e,n(t)):(u.fastInnerText(e,String.fromCharCode(160)),u.addClass(e,"cornerHeader"))},g.prototype.maximumVisibleElementWidth=function(e){var t=this.wt.wtViewport.getWorkspaceWidth()-e;return 0<t?t:0},g.prototype.maximumVisibleElementHeight=function(e){var t=this.wt.wtViewport.getWorkspaceHeight()-e;return 0<t?t:0},g.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},g.prototype.destroy=function(){this.wt.destroy(),this.eventManager.clear()}},{"./3rdparty/walkontable/src/cell/coords.js":5,"./3rdparty/walkontable/src/core.js":7,"./3rdparty/walkontable/src/selection.js":18,"./dom.js":27,"./eventManager.js":41,"./helpers.js":42}],86:[function(e,t,n){"use strict";function o(e,r){var i=e,s="string"==typeof i?i.toLowerCase():null;return function(e){for(var t=!1,n=0,o=e.length;n<o;n++){if(i===e[n]){t=!0;break}if(s===Handsontable.helper.stringify(e[n]).toLowerCase()){t=!0;break}}r(t)}}Handsontable.AutocompleteValidator=function(e,t){this.strict&&this.source?"function"==typeof this.source?this.source(e,o(e,t)):o(e,t)(this.source):t(!0)}},{}],87:[function(e,t,n){"use strict";var o,r,a=((o=e("moment"))&&o.__esModule&&o||{default:o}).default,l=((r=e("./../editors.js"))&&r.__esModule&&r||{default:r}).getEditor;Handsontable.DateValidator=function(e,t){var n=!0,o=l("date",this.instance);null===e&&(e="");var r,i=a(new Date(e)).isValid(),s=a(e,this.dateFormat||o.defaultDateFormat,!0).isValid();i||(n=!1),!i&&s&&(n=!0),i&&!s&&(n=!0===this.correctFormat&&(r=u(e,this.dateFormat),this.instance.setDataAtCell(this.row,this.col,r,"dateValidator"),!0)),t(n)};var u=function(e,t){var n=a(new Date(e));return 4<n.format("YYYY").length&&n.year((n.year()+"").substr(0,4)),n.format(t)}},{"./../editors.js":29,moment:"moment"}],88:[function(e,t,n){"use strict";Handsontable.NumericValidator=function(e,t){null===e&&(e=""),t(/^-?\d*(\.|\,)?\d*$/.test(e))}},{}],SheetClip:[function(e,t,n){"use strict";function d(e){return e.split('"').length-1}var o,r;o=window,r={parse:function(e){var t,n,o,r,i,s,a=[],l=0,u=e.split("\n");for(1<u.length&&""===u[u.length-1]&&u.pop(),t=0,n=u.length;t<n;t+=1){for(u[t]=u[t].split("\t"),o=0,r=u[t].length;o<r;o+=1)a[l]||(a[l]=[]),i&&0===o?(s=a[l].length-1,a[l][s]=a[l][s]+"\n"+u[t][0],i&&1&d(u[t][0])&&(i=!1,a[l][s]=a[l][s].substring(0,a[l][s].length-1).replace(/""/g,'"'))):i=o===r-1&&0===u[t][o].indexOf('"')&&1&d(u[t][o])?(a[l].push(u[t][o].substring(1).replace(/""/g,'"')),!0):(a[l].push(u[t][o].replace(/""/g,'"')),!1);i||(l+=1)}return a},stringify:function(e){for(var t,n,o,r="",i=0,s=e.length;i<s;i+=1){for(n=e[i].length,t=0;t<n;t+=1)0<t&&(r+="\t"),"string"==typeof(o=e[i][t])?-1<o.indexOf("\n")?r+='"'+o.replace(/"/g,'""')+'"':r+=o:r+=null==o?"":o;r+="\n"}return r}},void 0!==n?(n.parse=r.parse,n.stringify=r.stringify):o.SheetClip=r},{}],autoResize:[function(e,t,n){"use strict";void 0!==n&&(t.exports=function(){function l(e,t,n){window.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)}function e(e,t,n){window.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)}function u(e){var t,n;e?/^[a-zA-Z \.,\\\/\|0-9]$/.test(e)||(e="."):e="",void 0!==f.textContent?f.textContent=c.value+e:f.data=c.value+e,p.style.fontSize=Handsontable.Dom.getComputedStyle(c).fontSize,p.style.fontFamily=Handsontable.Dom.getComputedStyle(c).fontFamily,p.style.whiteSpace="pre",r.appendChild(p),t=p.clientWidth+2,r.removeChild(p),c.style.height=h.minHeight+"px",h.minWidth>t?c.style.width=h.minWidth+"px":t>h.maxWidth?c.style.width=h.maxWidth+"px":c.style.width=t+"px",n=c.scrollHeight?c.scrollHeight-1:0,h.minHeight>n?c.style.height=h.minHeight+"px":h.maxHeight<n?(c.style.height=h.maxHeight+"px",c.style.overflowY="visible"):c.style.height=n+"px"}function d(){window.setTimeout(u,0)}function o(e,t,n){var o,r,i,s,a;c=e,(o=t)&&o.minHeight&&("inherit"==o.minHeight?h.minHeight=c.clientHeight:(r=parseInt(o.minHeight),isNaN(r)||(h.minHeight=r))),o&&o.maxHeight&&("inherit"==o.maxHeight?h.maxHeight=c.clientHeight:(i=parseInt(o.maxHeight),isNaN(i)||(h.maxHeight=i))),o&&o.minWidth&&("inherit"==o.minWidth?h.minWidth=c.clientWidth:(s=parseInt(o.minWidth),isNaN(s)||(h.minWidth=s))),o&&o.maxWidth&&("inherit"==o.maxWidth?h.maxWidth=c.clientWidth:(a=parseInt(o.maxWidth),isNaN(a)||(h.maxWidth=a))),p.firstChild||(p.className="autoResize",p.style.display="inline-block",p.appendChild(f)),"TEXTAREA"==c.nodeName&&(c.style.resize="none",c.style.overflowY="",c.style.height=h.minHeight+"px",c.style.minWidth=h.minWidth+"px",c.style.maxWidth=h.maxWidth+"px",c.style.overflowY="hidden"),n&&(l(c,"change",u),l(c,"cut",d),l(c,"paste",d),l(c,"drop",d),l(c,"keydown",d)),u()}var c,h={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},r=document.body,f=document.createTextNode(""),p=document.createElement("SPAN");return{init:function(e,t,n){o(e,t,n)},unObserve:function(){e(c,"change",u),e(c,"cut",d),e(c,"paste",d),e(c,"drop",d),e(c,"keydown",d)},resize:u}})},{}],copyPaste:[function(e,t,n){"use strict";var o;function r(){this.refCounter=0,this.init()}void 0!==n&&(t.exports=function(){return o?o.hasBeenDestroyed()&&o.init():o=new r,o.refCounter++,o}),r.prototype.init=function(){var e,t;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],t=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("div"),this.elDiv.id="CopyPasteDiv",(e=this.elDiv.style).position="fixed",e.top="-10000px",e.left="-10000px",t.appendChild(this.elDiv),this.elTextarea=document.createElement("textarea"),this.elTextarea.className="copyPaste",this.elTextarea.onpaste=function(e){var t,n;if("WebkitAppearance"in document.documentElement.style)return t=e.clipboardData.getData("Text"),-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&((n=t.split("\n")).pop(),t=n.join("\n")),this.value=t,!1},(e=this.elTextarea.style).width="10000px",e.height="10000px",e.overflow="hidden",this.elDiv.appendChild(this.elTextarea),void 0!==e.opacity&&(e.opacity=0)),this.onKeyDownRef=this.onKeyDown.bind(this),document.documentElement.addEventListener("keydown",this.onKeyDownRef,!1)},r.prototype.onKeyDown=function(e){var t,n=this,o=!1;if((e.metaKey||e.ctrlKey&&-1===navigator.userAgent.indexOf("Mac"))&&(o=!0),o){if(document.activeElement!==this.elTextarea&&(""!==this.getSelectionText()||((t=document.activeElement).shadowRoot&&t.shadowRoot.activeElement&&(t=t.shadowRoot.activeElement),-1<["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)||"true"===t.contentEditable)))return;this.selectNodeText(this.elTextarea),setTimeout(function(){document.activeElement!==n.elTextarea&&n.selectNodeText(n.elTextarea)},0)}!o||67!==e.keyCode&&86!==e.keyCode&&88!==e.keyCode||(88===e.keyCode?setTimeout(function(){n.triggerCut(e)},0):86===e.keyCode&&setTimeout(function(){n.triggerPaste(e)},0))},r.prototype.selectNodeText=function(e){e&&e.select()},r.prototype.getSelectionText=function(){var e="";return window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(e=document.selection.createRange().text),e},r.prototype.copyable=function(e){if("string"!=typeof e&&void 0===e.toString)throw new Error("copyable requires string parameter");this.elTextarea.value=e,this.selectNodeText(this.elTextarea)},r.prototype.onCut=function(e){this.cutCallbacks.push(e)},r.prototype.onPaste=function(e){this.pasteCallbacks.push(e)},r.prototype.removeCallback=function(e){for(var t=0,n=this.copyCallbacks.length;t<n;t++)if(this.copyCallbacks[t]===e)return this.copyCallbacks.splice(t,1),!0;for(t=0,n=this.cutCallbacks.length;t<n;t++)if(this.cutCallbacks[t]===e)return this.cutCallbacks.splice(t,1),!0;for(t=0,n=this.pasteCallbacks.length;t<n;t++)if(this.pasteCallbacks[t]===e)return this.pasteCallbacks.splice(t,1),!0;return!1},r.prototype.triggerCut=function(n){var o=this;o.cutCallbacks&&setTimeout(function(){for(var e=0,t=o.cutCallbacks.length;e<t;e++)o.cutCallbacks[e](n)},50)},r.prototype.triggerPaste=function(o,r){var i=this;i.pasteCallbacks&&setTimeout(function(){for(var e=r||i.elTextarea.value,t=0,n=i.pasteCallbacks.length;t<n;t++)i.pasteCallbacks[t](e,o)},50)},r.prototype.destroy=function(){this.hasBeenDestroyed()||0!=--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&(this.elDiv.parentNode.removeChild(this.elDiv),this.elDiv=null,this.elTextarea=null),document.documentElement.removeEventListener("keydown",this.onKeyDownRef))},r.prototype.hasBeenDestroyed=function(){return!this.refCounter}},{}],jsonpatch:[function(e,t,n){"use strict";var o;!function(e){var h={add:function(e,t){return e[t]=this.value,!0},remove:function(e,t){return delete e[t],!0},replace:function(e,t){return e[t]=this.value,!0},move:function(e,t,n){var o={op:"_get",path:this.from};return r(n,[o]),r(n,[{op:"remove",path:this.from}]),r(n,[{op:"add",path:this.path,value:o.value}]),!0},copy:function(e,t,n){var o={op:"_get",path:this.from};return r(n,[o]),r(n,[{op:"add",path:this.path,value:o.value}]),!0},test:function(e,t){return JSON.stringify(e[t])===JSON.stringify(this.value)},_get:function(e,t){this.value=e[t]}},f={add:function(e,t){return e.splice(t,0,this.value),!0},remove:function(e,t){return e.splice(t,1),!0},replace:function(e,t){return e[t]=this.value,!0},move:h.move,copy:h.copy,test:h.test,_get:h._get},c={add:function(e,t){var n={op:"add",path:t+p(this.name),value:this.object[this.name]};e.push(n)},delete:function(e,t){var n={op:"remove",path:t+p(this.name)};e.push(n)},update:function(e,t){var n={op:"replace",path:t+p(this.name),value:this.object[this.name]};e.push(n)}};function p(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function g(e,t){if(e===t)return"/";var n=function e(t,n){var o;for(var r in t)if(t.hasOwnProperty(r)){if(t[r]===n)return p(r)+"/";if("object"==typeof t[r]&&""!=(o=e(t[r],n)))return p(r)+"/"+o}return""}(e,t);if(""===n)throw new Error("Object not found in root");return"/"+n}var m=[];e.intervals;var w,v,y=function(e){this.observers=[],this.obj=e},b=function(e,t){this.callback=e,this.observer=t};function C(e){for(var t=0,n=m.length;t<n;t++)if(m[t].obj===e)return m[t]}function R(e,t){if(Object.observe)for(var n in Object.observe(t,e),t){var o;!t.hasOwnProperty(n)||(o=t[n])&&"object"==typeof o&&R(e,o)}return e}function S(e,t){if(Object.observe)for(var n in Object.unobserve(t,e),t){var o;!t.hasOwnProperty(n)||(o=t[n])&&"object"==typeof o&&S(e,o)}return e}function E(e){if(Object.observe)Object.deliverChangeRecords(e);else{for(var t,n=0,o=m.length;n<o;n++)if(m[n].obj===e.object){t=m[n];break}!function e(t,n,o,r){var i=w(n);var s=w(t);var a=!1;for(var l=s.length-1;0<=l;l--){var u,d=s[l],c=t[d];n.hasOwnProperty(d)?(u=n[d],c instanceof Object?e(c,u,o,r+"/"+p(d)):c!=u&&(o.push({op:"replace",path:r+"/"+p(d),value:u}),t[d]=u)):(o.push({op:"remove",path:r+"/"+p(d)}),delete t[d],a=!0)}if(!a&&i.length==s.length)return;for(var l=0;l<i.length;l++){var d=i[l];t.hasOwnProperty(d)||(o.push({op:"add",path:r+"/"+p(d),value:n[d]}),t[d]=JSON.parse(JSON.stringify(n[d])))}}(t.value,e.object,e.patches,"")}var r=e.patches;return 0<r.length&&(e.patches=[],e.callback&&e.callback(r)),r}function r(e,t){for(var n,o=!1,r=0,i=t.length;r<i;){for(var s=(n=t[r]).path.split("/"),a=e,l=1,u=s.length;;)if(v(a)){var d=parseInt(s[l],10);if(u<=++l){o=f[n.op].call(n,a,d,e);break}a=a[d]}else{var c=s[l];if(-1!=c.indexOf("~")&&(c=c.replace(/~1/g,"/").replace(/~0/g,"~")),u<=++l){o=h[n.op].call(n,a,c,e);break}a=a[c]}r++}return o}e.unobserve=function(e,t){E(t),Object.observe?S(t,e):clearTimeout(t.next),function(e,t){for(var n=0,o=e.observers.length;n<o;n++)if(e.observers[n].observer===t)return e.observers.splice(n,1)}(C(e),t)},e.observe=function(r,i){var e,t,n,o,s,a,l=[],u=r,d=C(r);return d?a=function(e,t){for(var n=0,o=e.observers.length;n<o;n++)if(e.observers[n].callback===t)return e.observers[n].observer}(d,i):(d=new y(r),m.push(d)),a||(Object.observe?a=function(e){S(a,r),R(a,r);for(var t=0,n=e.length;t<n;){if(("length"!==e[t].name||!v(e[t].object))&&"__Jasmine_been_here_before__"!==e[t].name){var o=e[t].type;switch(o){case"new":o="add";break;case"deleted":o="delete";break;case"updated":o="update"}c[o].call(e[t],l,g(u,e[t].object))}t++}l&&i&&i(l),a.patches=l,l=[]}:(a={},d.value=JSON.parse(JSON.stringify(r)),i&&(a.callback=i,a.next=null,e=this.intervals||[100,1e3,1e4,6e4],t=0,n=function(){E(a)},o=function(){clearTimeout(a.next),a.next=setTimeout(function(){n(),t=0,a.next=setTimeout(s,e[t++])},0)},s=function(){n(),t==e.length&&(t=e.length-1),a.next=setTimeout(s,e[t++])},"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mousedown",o),window.addEventListener("mouseup",o),window.addEventListener("keydown",o)):(window.attachEvent("onmousedown",o),window.attachEvent("onmouseup",o),window.attachEvent("onkeydown",o))),a.next=setTimeout(s,e[t++]))),a.patches=l,a.object=r,d.observers.push(new b(i,a)),R(a,r))},e.generate=E,w=Object.keys?Object.keys:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},v=Array.isArray?Array.isArray:function(e){return e.push&&"number"==typeof e.length},e.apply=r}(o=o||{}),void 0!==n&&(n.apply=o.apply,n.observe=o.observe,n.unobserve=o.unobserve,n.generate=o.generate)},{}],moment:[function(en,tn,e){var t,n;t=this,n=function(){"use strict";var e;function h(){return e.apply(null,arguments)}function s(e){return"[object Array]"===Object.prototype.toString.call(e)}function a(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function f(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function l(e,t){for(var n in t)f(t,n)&&(e[n]=t[n]);return f(t,"toString")&&(e.toString=t.toString),f(t,"valueOf")&&(e.valueOf=t.valueOf),e}function u(e,t,n,o){return Pe(e,t,n,o,!0).utc()}function p(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}),e._pf}function d(e){var t;return null==e._isValid&&(t=p(e),e._isValid=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour)),e._isValid}function c(e){var t=u(NaN);return null!=e?l(p(t),e):p(t).userInvalidated=!0,t}var i=h.momentProperties=[];function g(e,t){var n,o,r;if(void 0!==t._isAMomentObject&&(e._isAMomentObject=t._isAMomentObject),void 0!==t._i&&(e._i=t._i),void 0!==t._f&&(e._f=t._f),void 0!==t._l&&(e._l=t._l),void 0!==t._strict&&(e._strict=t._strict),void 0!==t._tzm&&(e._tzm=t._tzm),void 0!==t._isUTC&&(e._isUTC=t._isUTC),void 0!==t._offset&&(e._offset=t._offset),void 0!==t._pf&&(e._pf=p(t)),void 0!==t._locale&&(e._locale=t._locale),0<i.length)for(n in i)void 0!==(r=t[o=i[n]])&&(e[o]=r);return e}var t=!1;function m(e){g(this,e),this._d=new Date(+e._d),!1===t&&(t=!0,h.updateOffset(this),t=!1)}function w(e){return e instanceof m||null!=e&&null!=e._isAMomentObject}function v(e){var t=+e,n=0;return 0!=t&&isFinite(t)&&(n=0<=t?Math.floor(t):Math.ceil(t)),n}function y(e,t,n){for(var o=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),i=0,s=0;s<o;s++)(n&&e[s]!==t[s]||!n&&v(e[s])!==v(t[s]))&&i++;return i+r}function n(){}var o,r={};function b(e){return e?e.toLowerCase().replace("_","-"):e}function C(e){var t=null;if(!r[e]&&void 0!==tn&&tn&&tn.exports)try{t=o._abbr,en("./locale/"+e),R(t)}catch(e){}return r[e]}function R(e,t){var n;return e&&(n=void 0===t?E(e):S(e,t))&&(o=n),o._abbr}function S(e,t){return null!==t?(t.abbr=e,r[e]||(r[e]=new n),r[e].set(t),R(e),r[e]):(delete r[e],null)}function E(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return o;if(!s(e)){if(t=C(e))return t;e=[e]}return function(e){for(var t,n,o,r,i=0;i<e.length;){for(t=(r=b(e[i]).split("-")).length,n=(n=b(e[i+1]))?n.split("-"):null;0<t;){if(o=C(r.slice(0,t).join("-")))return o;if(n&&n.length>=t&&y(r,n,!0)>=t-1)break;t--}i++}return null}(e)}var T={};function _(e,t){var n=e.toLowerCase();T[n]=T[n+"s"]=T[t]=e}function H(e){return"string"==typeof e?T[e]||T[e.toLowerCase()]:void 0}function k(e){var t,n,o={};for(n in e)f(e,n)&&(t=H(n))&&(o[t]=e[n]);return o}function M(t,n){return function(e){return null!=e?(D(this,t,e),h.updateOffset(this,n),this):O(this,t)}}function O(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function D(e,t,n){return e._d["set"+(e._isUTC?"UTC":"")+t](n)}function x(e,t){var n;if("object"==typeof e)for(n in e)this.set(n,e[n]);else if("function"==typeof this[e=H(e)])return this[e](t);return this}function A(e,t,n){for(var o=""+Math.abs(e),r=0<=e;o.length<t;)o="0"+o;return(r?n?"+":"":"-")+o}var j=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,P=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,L={},N={};function W(e,t,n,o){var r="string"==typeof o?function(){return this[o]()}:o;e&&(N[e]=r),t&&(N[t[0]]=function(){return A(r.apply(this,arguments),t[1],t[2])}),n&&(N[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),e)})}function I(e,t){return e.isValid()?(t=B(t,e.localeData()),L[t]||(L[t]=function(n){for(var e,o=n.match(j),r=0,i=o.length;r<i;r++)N[o[r]]?o[r]=N[o[r]]:o[r]=(e=o[r]).match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"");return function(e){var t="";for(r=0;r<i;r++)t+=o[r]instanceof Function?o[r].call(e,n):o[r];return t}}(t)),L[t](e)):e.localeData().invalidDate()}function B(e,t){var n=5;function o(e){return t.longDateFormat(e)||e}for(P.lastIndex=0;0<=n&&P.test(e);)e=e.replace(P,o),P.lastIndex=0,--n;return e}var V=/\d/,F=/\d\d/,Y=/\d{3}/,G=/\d{4}/,z=/[+-]?\d{6}/,U=/\d\d?/,$=/\d{1,3}/,X=/\d{1,4}/,K=/[+-]?\d{1,6}/,q=/[+-]?\d+/,Z=/Z|[+-]\d\d:?\d\d/gi,J=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Q={};function ee(e,t,n){Q[e]="function"==typeof t?t:function(e){return e&&n?n:t}}function te(e,t){return f(Q,e)?Q[e](t._strict,t._locale):new RegExp(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,o,r){return t||n||o||r}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))}var ne={};function oe(e,n){var t,o=n;for("string"==typeof e&&(e=[e]),"number"==typeof n&&(o=function(e,t){t[n]=v(e)}),t=0;t<e.length;t++)ne[e[t]]=o}function re(e,r){oe(e,function(e,t,n,o){n._w=n._w||{},r(e,n._w,n,o)})}var ie=0,se=1,ae=2,le=3,ue=4,de=5,ce=6;function he(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}W("M",["MM",2],"Mo",function(){return this.month()+1}),W("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),W("MMMM",0,0,function(e){return this.localeData().months(this,e)}),_("month","M"),ee("M",U),ee("MM",U,F),ee("MMM",J),ee("MMMM",J),oe(["M","MM"],function(e,t){t[se]=v(e)-1}),oe(["MMM","MMMM"],function(e,t,n,o){var r=n._locale.monthsParse(e,o,n._strict);null!=r?t[se]=r:p(n).invalidMonth=e});var fe="January_February_March_April_May_June_July_August_September_October_November_December".split("_");var pe="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function ge(e,t){var n;return"string"==typeof t&&"number"!=typeof(t=e.localeData().monthsParse(t))||(n=Math.min(e.date(),he(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n)),e}function me(e){return null!=e?(ge(this,e),h.updateOffset(this,!0),this):O(this,"Month")}function we(e){var t,n=e._a;return n&&-2===p(e).overflow&&(t=n[se]<0||11<n[se]?se:n[ae]<1||n[ae]>he(n[ie],n[se])?ae:n[le]<0||24<n[le]||24===n[le]&&(0!==n[ue]||0!==n[de]||0!==n[ce])?le:n[ue]<0||59<n[ue]?ue:n[de]<0||59<n[de]?de:n[ce]<0||999<n[ce]?ce:-1,p(e)._overflowDayOfYear&&(t<ie||ae<t)&&(t=ae),p(e).overflow=t),e}function ve(e){!1===h.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function ye(e,t){var n=!0,o=e+"\n"+(new Error).stack;return l(function(){return n&&(ve(o),n=!1),t.apply(this,arguments)},t)}var be={};h.suppressDeprecationWarnings=!1;var Ce=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Re=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],Se=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Ee=/^\/?Date\((\-?\d+)/i;function Te(e){var t,n,o=e._i,r=Ce.exec(o);if(r){for(p(e).iso=!0,t=0,n=Re.length;t<n;t++)if(Re[t][1].exec(o)){e._f=Re[t][0]+(r[6]||" ");break}for(t=0,n=Se.length;t<n;t++)if(Se[t][1].exec(o)){e._f+=Se[t][0];break}o.match(Z)&&(e._f+="Z"),Ae(e)}else e._isValid=!1}function _e(e){var t=new Date(Date.UTC.apply(null,arguments));return e<1970&&t.setUTCFullYear(e),t}function He(e){return ke(e)?366:365}function ke(e){return e%4==0&&e%100!=0||e%400==0}h.createFromInputFallback=ye("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),W(0,["YY",2],0,function(){return this.year()%100}),W(0,["YYYY",4],0,"year"),W(0,["YYYYY",5],0,"year"),W(0,["YYYYYY",6,!0],0,"year"),_("year","y"),ee("Y",q),ee("YY",U,F),ee("YYYY",X,G),ee("YYYYY",K,z),ee("YYYYYY",K,z),oe(["YYYY","YYYYY","YYYYYY"],ie),oe("YY",function(e,t){t[ie]=h.parseTwoDigitYear(e)});var Me=M("FullYear",!(h.parseTwoDigitYear=function(e){return v(e)+(68<v(e)?1900:2e3)}));function Oe(e,t,n){var o,r=n-t,i=n-e.day();return r<i&&(i-=7),i<r-7&&(i+=7),o=Le(e).add(i,"d"),{week:Math.ceil(o.dayOfYear()/7),year:o.year()}}W("w",["ww",2],"wo","week"),W("W",["WW",2],"Wo","isoWeek"),_("week","w"),_("isoWeek","W"),ee("w",U),ee("ww",U,F),ee("W",U),ee("WW",U,F),re(["w","ww","W","WW"],function(e,t,n,o){t[o.substr(0,1)]=v(e)});function De(e,t,n){return null!=e?e:null!=t?t:n}function xe(e){var t,n,o,r,i,s,a=[];if(!e._d){for(i=e,s=new Date,o=i._useUTC?[s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()]:[s.getFullYear(),s.getMonth(),s.getDate()],e._w&&null==e._a[ae]&&null==e._a[se]&&function(e){var t,n,o,r,i,s,a;null!=(t=e._w).GG||null!=t.W||null!=t.E?(i=1,s=4,n=De(t.GG,e._a[ie],Oe(Le(),1,4).year),o=De(t.W,1),r=De(t.E,1)):(i=e._locale._week.dow,s=e._locale._week.doy,n=De(t.gg,e._a[ie],Oe(Le(),i,s).year),o=De(t.w,1),null!=t.d?(r=t.d)<i&&++o:r=null!=t.e?t.e+i:i);a=function(e,t,n,o,r){var i,s=_e(e,0,1).getUTCDay();return{year:0<(i=7*(t-1)+((n=null!=n?n:r)-r)+(r-(s=0===s?7:s)+(o<s?7:0)-(s<r?7:0))+1)?e:e-1,dayOfYear:0<i?i:He(e-1)+i}}(n,o,r,s,i),e._a[ie]=a.year,e._dayOfYear=a.dayOfYear}(e),e._dayOfYear&&(r=De(e._a[ie],o[ie]),e._dayOfYear>He(r)&&(p(e)._overflowDayOfYear=!0),n=_e(r,0,e._dayOfYear),e._a[se]=n.getUTCMonth(),e._a[ae]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=a[t]=o[t];for(;t<7;t++)e._a[t]=a[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[le]&&0===e._a[ue]&&0===e._a[de]&&0===e._a[ce]&&(e._nextDay=!0,e._a[le]=0),e._d=(e._useUTC?_e:function(e,t,n,o,r,i,s){var a=new Date(e,t,n,o,r,i,s);return e<1970&&a.setFullYear(e),a}).apply(null,a),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[le]=24)}}function Ae(e){if(e._f!==h.ISO_8601){e._a=[],p(e).empty=!0;for(var t,n,o,r,i,s,a=""+e._i,l=a.length,u=0,d=B(e._f,e._locale).match(j)||[],c=0;c<d.length;c++)n=d[c],(t=(a.match(te(n,e))||[])[0])&&(0<(o=a.substr(0,a.indexOf(t))).length&&p(e).unusedInput.push(o),a=a.slice(a.indexOf(t)+t.length),u+=t.length),N[n]?(t?p(e).empty=!1:p(e).unusedTokens.push(n),r=n,s=e,null!=(i=t)&&f(ne,r)&&ne[r](i,s._a,s,r)):e._strict&&!t&&p(e).unusedTokens.push(n);p(e).charsLeftOver=l-u,0<a.length&&p(e).unusedInput.push(a),!0===p(e).bigHour&&e._a[le]<=12&&0<e._a[le]&&(p(e).bigHour=void 0),e._a[le]=function(e,t,n){var o;if(null==n)return t;return null!=e.meridiemHour?e.meridiemHour(t,n):(null!=e.isPM&&((o=e.isPM(n))&&t<12&&(t+=12),o||12!==t||(t=0)),t)}(e._locale,e._a[le],e._meridiem),xe(e),we(e)}else Te(e)}function je(e){var t,n,o,r=e._i,i=e._f;return e._locale=e._locale||E(e._l),null===r||void 0===i&&""===r?c({nullInput:!0}):("string"==typeof r&&(e._i=r=e._locale.preparse(r)),w(r)?new m(we(r)):(s(i)?function(e){var t,n,o,r,i;if(0===e._f.length)return p(e).invalidFormat=!0,e._d=new Date(NaN);for(r=0;r<e._f.length;r++)i=0,t=g({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[r],Ae(t),d(t)&&(i+=p(t).charsLeftOver,i+=10*p(t).unusedTokens.length,p(t).score=i,(null==o||i<o)&&(o=i,n=t));l(e,n||t)}(e):i?Ae(e):a(r)?e._d=r:void 0===(o=(n=e)._i)?n._d=new Date:a(o)?n._d=new Date(+o):"string"==typeof o?function(e){var t=Ee.exec(e._i);null===t?(Te(e),!1===e._isValid&&(delete e._isValid,h.createFromInputFallback(e))):e._d=new Date(+t[1])}(n):s(o)?(n._a=function(e,t){for(var n=[],o=0;o<e.length;++o)n.push(t(e[o],o));return n}(o.slice(0),function(e){return parseInt(e,10)}),xe(n)):"object"==typeof o?function(e){var t;e._d||(t=k(e._i),e._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],xe(e))}(n):"number"==typeof o?n._d=new Date(o):h.createFromInputFallback(n),(t=new m(we(e)))._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t))}function Pe(e,t,n,o,r){var i={};return"boolean"==typeof n&&(o=n,n=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=r,i._l=n,i._i=e,i._f=t,i._strict=o,je(i)}function Le(e,t,n,o){return Pe(e,t,n,o,!1)}W("DDD",["DDDD",3],"DDDo","dayOfYear"),_("dayOfYear","DDD"),ee("DDD",$),ee("DDDD",Y),oe(["DDD","DDDD"],function(e,t,n){n._dayOfYear=v(e)}),h.ISO_8601=function(){};var Ne=ye("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var e=Le.apply(null,arguments);return e<this?this:e}),We=ye("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var e=Le.apply(null,arguments);return this<e?this:e});function Ie(e,t){var n,o;if(1===t.length&&s(t[0])&&(t=t[0]),!t.length)return Le();for(n=t[0],o=1;o<t.length;++o)t[o][e](n)&&(n=t[o]);return n}function Be(e){var t=k(e),n=t.year||0,o=t.quarter||0,r=t.month||0,i=t.week||0,s=t.day||0,a=t.hour||0,l=t.minute||0,u=t.second||0,d=t.millisecond||0;this._milliseconds=+d+1e3*u+6e4*l+36e5*a,this._days=+s+7*i,this._months=+r+3*o+12*n,this._data={},this._locale=E(),this._bubble()}function Ve(e){return e instanceof Be}function Fe(e,n){W(e,0,0,function(){var e=this.utcOffset(),t="+";return e<0&&(e=-e,t="-"),t+A(~~(e/60),2)+n+A(~~e%60,2)})}Fe("Z",":"),Fe("ZZ",""),ee("Z",Z),ee("ZZ",Z),oe(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Ge(e)});var Ye=/([\+\-]|\d\d)/gi;function Ge(e){var t=(e||"").match(Z)||[],n=((t[t.length-1]||[])+"").match(Ye)||["-",0,0],o=60*n[1]+v(n[2]);return"+"===n[0]?o:-o}function ze(e,t){var n,o;return t._isUTC?(n=t.clone(),o=(w(e)||a(e)?+e:+Le(e))-n,n._d.setTime(+n._d+o),h.updateOffset(n,!1),n):Le(e).local()}function Ue(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function $e(){return this._isUTC&&0===this._offset}h.updateOffset=function(){};var Xe=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Ke=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;function qe(e,t){var n,o,r,i=e,s=null;return Ve(e)?i={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(i={},t?i[t]=e:i.milliseconds=e):(s=Xe.exec(e))?(n="-"===s[1]?-1:1,i={y:0,d:v(s[ae])*n,h:v(s[le])*n,m:v(s[ue])*n,s:v(s[de])*n,ms:v(s[ce])*n}):(s=Ke.exec(e))?(n="-"===s[1]?-1:1,i={y:Ze(s[2],n),M:Ze(s[3],n),d:Ze(s[4],n),h:Ze(s[5],n),m:Ze(s[6],n),s:Ze(s[7],n),w:Ze(s[8],n)}):null==i?i={}:"object"==typeof i&&("from"in i||"to"in i)&&(r=function(e,t){var n;t=ze(t,e),e.isBefore(t)?n=Je(e,t):((n=Je(t,e)).milliseconds=-n.milliseconds,n.months=-n.months);return n}(Le(i.from),Le(i.to)),(i={}).ms=r.milliseconds,i.M=r.months),o=new Be(i),Ve(e)&&f(e,"_locale")&&(o._locale=e._locale),o}function Ze(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Je(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=t-e.clone().add(n.months,"M"),n}function Qe(i,s){return function(e,t){var n,o,r;return null===t||isNaN(+t)||(r="moment()."+(o=s)+"(period, number) is deprecated. Please use moment()."+s+"(number, period).",be[o]||(ve(r),be[o]=!0),n=e,e=t,t=n),et(this,qe(e="string"==typeof e?+e:e,t),i),this}}function et(e,t,n,o){var r=t._milliseconds,i=t._days,s=t._months;o=null==o||o,r&&e._d.setTime(+e._d+r*n),i&&D(e,"Date",O(e,"Date")+i*n),s&&ge(e,O(e,"Month")+s*n),o&&h.updateOffset(e,i||s)}qe.fn=Be.prototype;var tt=Qe(1,"add"),nt=Qe(-1,"subtract");function ot(e){return e<0?Math.ceil(e):Math.floor(e)}function rt(){var e=this.clone().utc();return 0<e.year()&&e.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():I(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):I(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function it(e){var t;return void 0===e?this._locale._abbr:(null!=(t=E(e))&&(this._locale=t),this)}h.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var st=ye("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});function at(){return this._locale}function lt(e,t){W(0,[e,e.length],0,t)}function ut(e,t,n){return Oe(Le([e,11,31+t-n]),t,n).week}W(0,["gg",2],0,function(){return this.weekYear()%100}),W(0,["GG",2],0,function(){return this.isoWeekYear()%100}),lt("gggg","weekYear"),lt("ggggg","weekYear"),lt("GGGG","isoWeekYear"),lt("GGGGG","isoWeekYear"),_("weekYear","gg"),_("isoWeekYear","GG"),ee("G",q),ee("g",q),ee("GG",U,F),ee("gg",U,F),ee("GGGG",X,G),ee("gggg",X,G),ee("GGGGG",K,z),ee("ggggg",K,z),re(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,o){t[o.substr(0,2)]=v(e)}),re(["gg","GG"],function(e,t,n,o){t[o]=h.parseTwoDigitYear(e)}),W("Q",0,0,"quarter"),_("quarter","Q"),ee("Q",V),oe("Q",function(e,t){t[se]=3*(v(e)-1)}),W("D",["DD",2],"Do","date"),_("date","D"),ee("D",U),ee("DD",U,F),ee("Do",function(e,t){return e?t._ordinalParse:t._ordinalParseLenient}),oe(["D","DD"],ae),oe("Do",function(e,t){t[ae]=v(e.match(U)[0])});var dt=M("Date",!0);W("d",0,"do","day"),W("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),W("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),W("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),W("e",0,0,"weekday"),W("E",0,0,"isoWeekday"),_("day","d"),_("weekday","e"),_("isoWeekday","E"),ee("d",U),ee("e",U),ee("E",U),ee("dd",J),ee("ddd",J),ee("dddd",J),re(["dd","ddd","dddd"],function(e,t,n){var o=n._locale.weekdaysParse(e);null!=o?t.d=o:p(n).invalidWeekday=e}),re(["d","e","E"],function(e,t,n,o){t[o]=v(e)});var ct="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");var ht="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");var ft="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function pt(e,t){W(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function gt(e,t){return t._meridiemParse}W("H",["HH",2],0,"hour"),W("h",["hh",2],0,function(){return this.hours()%12||12}),pt("a",!0),pt("A",!1),_("hour","h"),ee("a",gt),ee("A",gt),ee("H",U),ee("h",U),ee("HH",U,F),ee("hh",U,F),oe(["H","HH"],le),oe(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),oe(["h","hh"],function(e,t,n){t[le]=v(e),p(n).bigHour=!0});var mt=M("Hours",!0);W("m",["mm",2],0,"minute"),_("minute","m"),ee("m",U),ee("mm",U,F),oe(["m","mm"],ue);var wt=M("Minutes",!1);W("s",["ss",2],0,"second"),_("second","s"),ee("s",U),ee("ss",U,F),oe(["s","ss"],de);var vt=M("Seconds",!1);function yt(e){W(0,[e,3],0,"millisecond")}W("S",0,0,function(){return~~(this.millisecond()/100)}),W(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),yt("SSS"),yt("SSSS"),_("millisecond","ms"),ee("S",$,V),ee("SS",$,F),ee("SSS",$,Y),ee("SSSS",/\d+/),oe(["S","SS","SSS","SSSS"],function(e,t){t[ce]=v(1e3*("0."+e))});var bt=M("Milliseconds",!1);W("z",0,0,"zoneAbbr"),W("zz",0,0,"zoneName");var Ct=m.prototype;Ct.add=tt,Ct.calendar=function(e){var t=e||Le(),n=ze(t,this).startOf("day"),o=this.diff(n,"days",!0),r=o<-6?"sameElse":o<-1?"lastWeek":o<0?"lastDay":o<1?"sameDay":o<2?"nextDay":o<7?"nextWeek":"sameElse";return this.format(this.localeData().calendar(r,this,Le(t)))},Ct.clone=function(){return new m(this)},Ct.diff=function(e,t,n){var o,r,i=ze(e,this),s=6e4*(i.utcOffset()-this.utcOffset());return"year"===(t=H(t))||"month"===t||"quarter"===t?(r=function(e,t){var n,o,r=12*(t.year()-e.year())+(t.month()-e.month()),i=e.clone().add(r,"months");o=t-i<0?(n=e.clone().add(r-1,"months"),(t-i)/(i-n)):(n=e.clone().add(1+r,"months"),(t-i)/(n-i));return-(r+o)}(this,i),"quarter"===t?r/=3:"year"===t&&(r/=12)):(o=this-i,r="second"===t?o/1e3:"minute"===t?o/6e4:"hour"===t?o/36e5:"day"===t?(o-s)/864e5:"week"===t?(o-s)/6048e5:o),n?r:ot(r)},Ct.endOf=function(e){return void 0===(e=H(e))||"millisecond"===e?this:this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")},Ct.format=function(e){var t=I(this,e||h.defaultFormat);return this.localeData().postformat(t)},Ct.from=function(e,t){return this.isValid()?qe({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},Ct.fromNow=function(e){return this.from(Le(),e)},Ct.to=function(e,t){return this.isValid()?qe({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},Ct.toNow=function(e){return this.to(Le(),e)},Ct.get=x,Ct.invalidAt=function(){return p(this).overflow},Ct.isAfter=function(e,t){return"millisecond"===(t=H(void 0!==t?t:"millisecond"))?+(e=w(e)?e:Le(e))<+this:(w(e)?+e:+Le(e))<+this.clone().startOf(t)},Ct.isBefore=function(e,t){var n;return"millisecond"===(t=H(void 0!==t?t:"millisecond"))?+this<+(e=w(e)?e:Le(e)):(n=w(e)?+e:+Le(e),+this.clone().endOf(t)<n)},Ct.isBetween=function(e,t,n){return this.isAfter(e,n)&&this.isBefore(t,n)},Ct.isSame=function(e,t){var n;return"millisecond"===(t=H(t||"millisecond"))?+this==+(e=w(e)?e:Le(e)):(n=+Le(e),+this.clone().startOf(t)<=n&&n<=+this.clone().endOf(t))},Ct.isValid=function(){return d(this)},Ct.lang=st,Ct.locale=it,Ct.localeData=at,Ct.max=We,Ct.min=Ne,Ct.parsingFlags=function(){return l({},p(this))},Ct.set=x,Ct.startOf=function(e){switch(e=H(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},Ct.subtract=nt,Ct.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]},Ct.toDate=function(){return this._offset?new Date(+this):this._d},Ct.toISOString=rt,Ct.toJSON=rt,Ct.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},Ct.unix=function(){return Math.floor(this/1e3)},Ct.valueOf=function(){return this._d-6e4*(this._offset||0)},Ct.year=Me,Ct.isLeapYear=function(){return ke(this.year())},Ct.weekYear=function(e){var t=Oe(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==e?t:this.add(e-t,"y")},Ct.isoWeekYear=function(e){var t=Oe(this,1,4).year;return null==e?t:this.add(e-t,"y")},Ct.quarter=Ct.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},Ct.month=me,Ct.daysInMonth=function(){return he(this.year(),this.month())},Ct.week=Ct.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},Ct.isoWeek=Ct.isoWeeks=function(e){var t=Oe(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},Ct.weeksInYear=function(){var e=this.localeData()._week;return ut(this.year(),e.dow,e.doy)},Ct.isoWeeksInYear=function(){return ut(this.year(),1,4)},Ct.date=dt,Ct.day=Ct.days=function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=function(e,t){if("string"==typeof e)if(isNaN(e)){if("number"!=typeof(e=t.weekdaysParse(e)))return null}else e=parseInt(e,10);return e}(e,this.localeData()),this.add(e-t,"d")):t},Ct.weekday=function(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},Ct.isoWeekday=function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},Ct.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},Ct.hour=Ct.hours=mt,Ct.minute=Ct.minutes=wt,Ct.second=Ct.seconds=vt,Ct.millisecond=Ct.milliseconds=bt,Ct.utcOffset=function(e,t){var n,o=this._offset||0;return null!=e?("string"==typeof e&&(e=Ge(e)),Math.abs(e)<16&&(e*=60),!this._isUTC&&t&&(n=Ue(this)),this._offset=e,this._isUTC=!0,null!=n&&this.add(n,"m"),o!==e&&(!t||this._changeInProgress?et(this,qe(e-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,h.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?o:Ue(this)},Ct.utc=function(e){return this.utcOffset(0,e)},Ct.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ue(this),"m")),this},Ct.parseZone=function(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Ge(this._i)),this},Ct.hasAlignedHourOffset=function(e){return e=e?Le(e).utcOffset():0,(this.utcOffset()-e)%60==0},Ct.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},Ct.isDSTShifted=function(){if(this._a){var e=(this._isUTC?u:Le)(this._a);return this.isValid()&&0<y(this._a,e.toArray())}return!1},Ct.isLocal=function(){return!this._isUTC},Ct.isUtcOffset=function(){return this._isUTC},Ct.isUtc=$e,Ct.isUTC=$e,Ct.zoneAbbr=function(){return this._isUTC?"UTC":""},Ct.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},Ct.dates=ye("dates accessor is deprecated. Use date instead.",dt),Ct.months=ye("months accessor is deprecated. Use month instead",me),Ct.years=ye("years accessor is deprecated. Use year instead",Me),Ct.zone=ye("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()});var Rt=Ct;function St(e){return e}var Et=n.prototype;function Tt(e,t,n,o){var r=E(),i=u().set(o,t);return r[n](i,e)}function _t(e,t,n,o,r){if("number"==typeof e&&(t=e,e=void 0),e=e||"",null!=t)return Tt(e,t,n,r);for(var i=[],s=0;s<o;s++)i[s]=Tt(e,s,n,r);return i}Et._calendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Et.calendar=function(e,t,n){var o=this._calendar[e];return"function"==typeof o?o.call(t,n):o},Et._longDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},Et.longDateFormat=function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},Et._invalidDate="Invalid date",Et.invalidDate=function(){return this._invalidDate},Et._ordinal="%d",Et.ordinal=function(e){return this._ordinal.replace("%d",e)},Et._ordinalParse=/\d{1,2}/,Et.preparse=St,Et.postformat=St,Et._relativeTime={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Et.relativeTime=function(e,t,n,o){var r=this._relativeTime[n];return"function"==typeof r?r(e,t,n,o):r.replace(/%d/i,e)},Et.pastFuture=function(e,t){var n=this._relativeTime[0<e?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},Et.set=function(e){var t,n;for(n in e)"function"==typeof(t=e[n])?this[n]=t:this["_"+n]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},Et.months=function(e){return this._months[e.month()]},Et._months=fe,Et.monthsShort=function(e){return this._monthsShort[e.month()]},Et._monthsShort=pe,Et.monthsParse=function(e,t,n){var o,r,i;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),o=0;o<12;o++){if(r=u([2e3,o]),n&&!this._longMonthsParse[o]&&(this._longMonthsParse[o]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[o]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),n||this._monthsParse[o]||(i="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[o]=new RegExp(i.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[o].test(e))return o;if(n&&"MMM"===t&&this._shortMonthsParse[o].test(e))return o;if(!n&&this._monthsParse[o].test(e))return o}},Et.week=function(e){return Oe(e,this._week.dow,this._week.doy).week},Et._week={dow:0,doy:6},Et.firstDayOfYear=function(){return this._week.doy},Et.firstDayOfWeek=function(){return this._week.dow},Et.weekdays=function(e){return this._weekdays[e.day()]},Et._weekdays=ct,Et.weekdaysMin=function(e){return this._weekdaysMin[e.day()]},Et._weekdaysMin=ft,Et.weekdaysShort=function(e){return this._weekdaysShort[e.day()]},Et._weekdaysShort=ht,Et.weekdaysParse=function(e){var t,n,o;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;t<7;t++)if(this._weekdaysParse[t]||(n=Le([2e3,1]).day(t),o="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(o.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},Et.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},Et._meridiemParse=/[ap]\.?m?\.?/i,Et.meridiem=function(e,t,n){return 11<e?n?"pm":"PM":n?"am":"AM"},R("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===v(e%100/10)?"th":1==t?"st":2==t?"nd":3==t?"rd":"th")}}),h.lang=ye("moment.lang is deprecated. Use moment.locale instead.",R),h.langData=ye("moment.langData is deprecated. Use moment.localeData instead.",E);var Ht=Math.abs;function kt(e,t,n,o){var r=qe(t,n);return e._milliseconds+=o*r._milliseconds,e._days+=o*r._days,e._months+=o*r._months,e._bubble()}function Mt(e){return 400*e/146097}function Ot(e){return 146097*e/400}function Dt(e){return function(){return this.as(e)}}var xt=Dt("ms"),At=Dt("s"),jt=Dt("m"),Pt=Dt("h"),Lt=Dt("d"),Nt=Dt("w"),Wt=Dt("M"),It=Dt("y");function Bt(e){return function(){return this._data[e]}}var Vt=Bt("milliseconds"),Ft=Bt("seconds"),Yt=Bt("minutes"),Gt=Bt("hours"),zt=Bt("days"),Ut=Bt("months"),$t=Bt("years");var Xt=Math.round,Kt={s:45,m:45,h:22,d:26,M:11};function qt(e,t,n){var o=qe(e).abs(),r=Xt(o.as("s")),i=Xt(o.as("m")),s=Xt(o.as("h")),a=Xt(o.as("d")),l=Xt(o.as("M")),u=Xt(o.as("y")),d=(r<Kt.s?["s",r]:1===i&&["m"])||i<Kt.m&&["mm",i]||1===s&&["h"]||s<Kt.h&&["hh",s]||1===a&&["d"]||a<Kt.d&&["dd",a]||1===l&&["M"]||l<Kt.M&&["MM",l]||1===u&&["y"]||["yy",u];return d[2]=t,d[3]=0<+e,d[4]=n,function(e,t,n,o,r){return r.relativeTime(t||1,!!n,e,o)}.apply(null,d)}var Zt=Math.abs;function Jt(){var e=Zt(this.years()),t=Zt(this.months()),n=Zt(this.days()),o=Zt(this.hours()),r=Zt(this.minutes()),i=Zt(this.seconds()+this.milliseconds()/1e3),s=this.asSeconds();return s?(s<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(n?n+"D":"")+(o||r||i?"T":"")+(o?o+"H":"")+(r?r+"M":"")+(i?i+"S":""):"P0D"}var Qt=Be.prototype;return Qt.abs=function(){var e=this._data;return this._milliseconds=Ht(this._milliseconds),this._days=Ht(this._days),this._months=Ht(this._months),e.milliseconds=Ht(e.milliseconds),e.seconds=Ht(e.seconds),e.minutes=Ht(e.minutes),e.hours=Ht(e.hours),e.months=Ht(e.months),e.years=Ht(e.years),this},Qt.add=function(e,t){return kt(this,e,t,1)},Qt.subtract=function(e,t){return kt(this,e,t,-1)},Qt.as=function(e){var t,n,o=this._milliseconds;if("month"===(e=H(e))||"year"===e)return t=this._days+o/864e5,n=this._months+12*Mt(t),"month"===e?n:n/12;switch(t=this._days+Math.round(Ot(this._months/12)),e){case"week":return t/7+o/6048e5;case"day":return t+o/864e5;case"hour":return 24*t+o/36e5;case"minute":return 1440*t+o/6e4;case"second":return 86400*t+o/1e3;case"millisecond":return Math.floor(864e5*t)+o;default:throw new Error("Unknown unit "+e)}},Qt.asMilliseconds=xt,Qt.asSeconds=At,Qt.asMinutes=jt,Qt.asHours=Pt,Qt.asDays=Lt,Qt.asWeeks=Nt,Qt.asMonths=Wt,Qt.asYears=It,Qt.valueOf=function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*v(this._months/12)},Qt._bubble=function(){var e,t,n,o=this._milliseconds,r=this._days,i=this._months,s=this._data,a=0;return s.milliseconds=o%1e3,e=ot(o/1e3),s.seconds=e%60,t=ot(e/60),s.minutes=t%60,n=ot(t/60),s.hours=n%24,r+=ot(n/24),a=ot(Mt(r)),r-=ot(Ot(a)),i+=ot(r/30),r%=30,a+=ot(i/12),i%=12,s.days=r,s.months=i,s.years=a,this},Qt.get=function(e){return this[(e=H(e))+"s"]()},Qt.milliseconds=Vt,Qt.seconds=Ft,Qt.minutes=Yt,Qt.hours=Gt,Qt.days=zt,Qt.weeks=function(){return ot(this.days()/7)},Qt.months=Ut,Qt.years=$t,Qt.humanize=function(e){var t=this.localeData(),n=qt(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)},Qt.toISOString=Jt,Qt.toString=Jt,Qt.toJSON=Jt,Qt.locale=it,Qt.localeData=at,Qt.toIsoString=ye("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Jt),Qt.lang=st,W("X",0,0,"unix"),W("x",0,0,"valueOf"),ee("x",q),ee("X",/[+-]?\d+(\.\d{1,3})?/),oe("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),oe("x",function(e,t,n){n._d=new Date(v(e))}),h.version="2.10.3",e=Le,h.fn=Rt,h.min=function(){return Ie("isBefore",[].slice.call(arguments,0))},h.max=function(){return Ie("isAfter",[].slice.call(arguments,0))},h.utc=u,h.unix=function(e){return Le(1e3*e)},h.months=function(e,t){return _t(e,t,"months",12,"month")},h.isDate=a,h.locale=R,h.invalid=c,h.duration=qe,h.isMoment=w,h.weekdays=function(e,t){return _t(e,t,"weekdays",7,"day")},h.parseZone=function(){return Le.apply(null,arguments).parseZone()},h.localeData=E,h.isDuration=Ve,h.monthsShort=function(e,t){return _t(e,t,"monthsShort",12,"month")},h.weekdaysMin=function(e,t){return _t(e,t,"weekdaysMin",7,"day")},h.defineLocale=S,h.weekdaysShort=function(e,t){return _t(e,t,"weekdaysShort",7,"day")},h.normalizeUnits=H,h.relativeTimeThreshold=function(e,t){return void 0!==Kt[e]&&(void 0===t?Kt[e]:(Kt[e]=t,!0))},h},"object"==typeof e&&void 0!==tn?tn.exports=n():t.moment=n()},{}],numeral:[function(e,a,t){"use strict";(function(){var d,E={},T="en",_=null,n="0,0",e=void 0!==a&&a.exports;function t(e){this._value=e}function H(e,t,n,o){var r,i=Math.pow(10,t),s=(n(e*i)/i).toFixed(t);return o&&(r=new RegExp("0{1,"+o+"}$"),s=s.replace(r,"")),s}function o(e,t,n){var o,r,i,s,a=-1<t.indexOf("$")?function(e,t,n){var o,r,i=t.indexOf("$"),s=t.indexOf("("),a=t.indexOf("-"),l="";t=-1<t.indexOf(" $")?(l=" ",t.replace(" $","")):-1<t.indexOf("$ ")?(l=" ",t.replace("$ ","")):t.replace("$","");r=u(e._value,t,n),r=i<=1?-1<r.indexOf("(")||-1<r.indexOf("-")?(r=r.split(""),o=i<s||i<a?0:1,r.splice(o,0,E[T].currency.symbol+l),r.join("")):E[T].currency.symbol+l+r:-1<r.indexOf(")")?((r=r.split("")).splice(-1,0,l+E[T].currency.symbol),r.join("")):r+l+E[T].currency.symbol;return r}(e,t,n):-1<t.indexOf("%")?function(e,t,n){var o,r="",i=100*e._value;t=-1<t.indexOf(" %")?(r=" ",t.replace(" %","")):t.replace("%","");o=-1<(o=u(i,t,n)).indexOf(")")?((o=o.split("")).splice(-1,0,r+"%"),o.join("")):o+r+"%";return o}(e,t,n):-1<t.indexOf(":")?(o=e,r=Math.floor(o._value/60/60),i=Math.floor((o._value-60*r*60)/60),s=Math.round(o._value-60*r*60-60*i),r+":"+(i<10?"0"+i:i)+":"+(s<10?"0"+s:s)):u(e._value,t,n);return a}function r(e,t){var n,o,r,i,s,a=t,l=["KB","MB","GB","TB","PB","EB","ZB","YB"],u=!1;if(-1<t.indexOf(":"))e._value=function(e){var t=e.split(":"),n=0;3===t.length?(n+=60*Number(t[0])*60,n+=60*Number(t[1]),n+=Number(t[2])):2===t.length&&(n+=60*Number(t[0]),n+=Number(t[1]));return Number(n)}(t);else if(t===_)e._value=0;else{for("."!==E[T].delimiters.decimal&&(t=t.replace(/\./g,"").replace(E[T].delimiters.decimal,".")),n=new RegExp("[^a-zA-Z]"+E[T].abbreviations.thousand+"(?:\\)|(\\"+E[T].currency.symbol+")?(?:\\))?)?$"),o=new RegExp("[^a-zA-Z]"+E[T].abbreviations.million+"(?:\\)|(\\"+E[T].currency.symbol+")?(?:\\))?)?$"),r=new RegExp("[^a-zA-Z]"+E[T].abbreviations.billion+"(?:\\)|(\\"+E[T].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+E[T].abbreviations.trillion+"(?:\\)|(\\"+E[T].currency.symbol+")?(?:\\))?)?$"),s=0;s<=l.length&&!(u=-1<t.indexOf(l[s])&&Math.pow(1024,s+1));s++);e._value=(u||1)*(a.match(n)?Math.pow(10,3):1)*(a.match(o)?Math.pow(10,6):1)*(a.match(r)?Math.pow(10,9):1)*(a.match(i)?Math.pow(10,12):1)*(-1<t.indexOf("%")?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(t.replace(/[^0-9\.]+/g,"")),e._value=u?Math.ceil(e._value):e._value}return e._value}function u(e,t,n){var o,r,i,s,a,l,u=!1,d=!1,c=!1,h="",f=!1,p=!1,g=!1,m=!1,w=!1,v="",y="",b=Math.abs(e),C=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],R="",S=!1;if(0===e&&null!==_)return _;if(-1<t.indexOf("(")?(u=!0,t=t.slice(1,-1)):-1<t.indexOf("+")&&(d=!0,t=t.replace(/\+/g,"")),-1<t.indexOf("a")&&(f=0<=t.indexOf("aK"),p=0<=t.indexOf("aM"),g=0<=t.indexOf("aB"),m=0<=t.indexOf("aT"),w=f||p||g||m,t=-1<t.indexOf(" a")?(h=" ",t.replace(" a","")):t.replace("a",""),b>=Math.pow(10,12)&&!w||m?(h+=E[T].abbreviations.trillion,e/=Math.pow(10,12)):b<Math.pow(10,12)&&b>=Math.pow(10,9)&&!w||g?(h+=E[T].abbreviations.billion,e/=Math.pow(10,9)):b<Math.pow(10,9)&&b>=Math.pow(10,6)&&!w||p?(h+=E[T].abbreviations.million,e/=Math.pow(10,6)):(b<Math.pow(10,6)&&b>=Math.pow(10,3)&&!w||f)&&(h+=E[T].abbreviations.thousand,e/=Math.pow(10,3))),-1<t.indexOf("b"))for(t=-1<t.indexOf(" b")?(v=" ",t.replace(" b","")):t.replace("b",""),i=0;i<=C.length;i++)if(o=Math.pow(1024,i),r=Math.pow(1024,i+1),o<=e&&e<r){v+=C[i],0<o&&(e/=o);break}return-1<t.indexOf("o")&&(t=-1<t.indexOf(" o")?(y=" ",t.replace(" o","")):t.replace("o",""),y+=E[T].ordinal(e)),-1<t.indexOf("[.]")&&(c=!0,t=t.replace("[.]",".")),s=e.toString().split(".")[0],a=t.split(".")[1],l=t.indexOf(","),a?(s=(R=-1<a.indexOf("[")?H(e,(a=(a=a.replace("]","")).split("["))[0].length+a[1].length,n,a[1].length):H(e,a.length,n)).split(".")[0],R=R.split(".")[1].length?E[T].delimiters.decimal+R.split(".")[1]:"",c&&0===Number(R.slice(1))&&(R="")):s=H(e,null,n),-1<s.indexOf("-")&&(s=s.slice(1),S=!0),-1<l&&(s=s.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+E[T].delimiters.thousands)),0===t.indexOf(".")&&(s=""),(u&&S?"(":"")+(!u&&S?"-":"")+(!S&&d?"+":"")+s+R+(y||"")+(h||"")+(v||"")+(u&&S?")":"")}function i(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function s(){return Array.prototype.slice.call(arguments).reduce(function(e,t){var n=i(e),o=i(t);return o<n?n:o},-1/0)}(d=function(e){return d.isNumeral(e)?e=e.value():0===e||void 0===e?e=0:Number(e)||(e=d.fn.unformat(e)),new t(Number(e))}).version="1.5.3",d.isNumeral=function(e){return e instanceof t},d.language=function(e,t){if(!e)return T;if(e&&!t){if(!E[e])throw new Error("Unknown language : "+e);T=e}var n;return!t&&E[e]||(n=t,E[e]=n),d},d.languageData=function(e){if(!e)return E[T];if(!E[e])throw new Error("Unknown language : "+e);return E[e]},d.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1==t?"st":2==t?"nd":3==t?"rd":"th"},currency:{symbol:"$"}}),d.zeroFormat=function(e){_="string"==typeof e?e:null},d.defaultFormat=function(e){n="string"==typeof e?e:"0.0"},d.validate=function(e,t){var n,o,r,i,s,a,l,u;if("string"!=typeof e&&(e+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",e)),""===(e=e.trim()))return!1;e=e.replace(/^[+-]?/,"");try{l=d.languageData(t)}catch(e){l=d.languageData(d.language())}return r=l.currency.symbol,s=l.abbreviations,n=l.delimiters.decimal,o="."===l.delimiters.thousands?"\\.":l.delimiters.thousands,(null===(u=e.match(/^[^\d\.\,]+/))||(e=e.substr(1),u[0]===r))&&((null===(u=e.match(/[^\d]+$/))||(e=e.slice(0,-1),u[0]===s.thousand||u[0]===s.million||u[0]===s.billion||u[0]===s.trillion))&&(!!e.match(/^\d+$/)||(a=new RegExp(o+"{2}"),!e.match(/[^\d.,]/g)&&(!(2<(i=e.split(n)).length)&&(i.length<2?!!i[0].match(/^\d+.*\d$/)&&!i[0].match(a):""===i[0]?!i[0].match(a)&&!!i[1].match(/^\d+$/):1===i[0].length?!!i[0].match(/^\d+$/)&&!i[0].match(a)&&!!i[1].match(/^\d+$/):!!i[0].match(/^\d+.*\d$/)&&!i[0].match(a)&&!!i[1].match(/^\d+$/))))))},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(e,t){if(null==this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var n,o,r=this.length>>>0,i=!1;for(1<arguments.length&&(o=t,i=!0),n=0;n<r;++n)this.hasOwnProperty(n)&&(i?o=e(o,this[n],n,this):(o=this[n],i=!0));if(!i)throw new TypeError("Reduce of empty array with no initial value");return o}),d.fn=t.prototype={clone:function(){return d(this)},format:function(e,t){return o(this,e||n,void 0!==t?t:Math.round)},unformat:function(e){return"[object Number]"===Object.prototype.toString.call(e)?e:r(this,e||n)},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){return this._value=Number(e),this},add:function(e){var r=s.call(null,this._value,e);return this._value=[this._value,e].reduce(function(e,t,n,o){return e+r*t},0)/r,this},subtract:function(e){var r=s.call(null,this._value,e);return this._value=[e].reduce(function(e,t,n,o){return e-r*t},this._value*r)/r,this},multiply:function(e){return this._value=[this._value,e].reduce(function(e,t,n,o){var r=s(e,t);return e*r*(t*r)/(r*r)},1),this},divide:function(e){return this._value=[this._value,e].reduce(function(e,t,n,o){var r=s(e,t);return e*r/(t*r)}),this},difference:function(e){return Math.abs(d(this._value).subtract(e).value())}},e&&(a.exports=d),"undefined"==typeof ender&&(this.numeral=d)}).call(window)},{}],pikaday:[function(o,r,i){!function(e,t){"use strict";var n;if("object"==typeof i){try{n=o("moment")}catch(e){}r.exports=t(n)}else e.Pikaday=t(e.moment)}(this,function(n){"use strict";function i(e,t,n,o){u?e.addEventListener(t,n,!!o):e.attachEvent("on"+t,n)}function o(e,t,n,o){u?e.removeEventListener(t,n,!!o):e.detachEvent("on"+t,n)}function r(e,t,n){var o;d.createEvent?((o=d.createEvent("HTMLEvents")).initEvent(t,!0,!1),o=h(o,n),e.dispatchEvent(o)):d.createEventObject&&(o=d.createEventObject(),o=h(o,n),e.fireEvent("on"+t,o))}function s(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")}function m(e){return/Array/.test(Object.prototype.toString.call(e))}function E(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())}function T(e){E(e)&&e.setHours(0,0,0,0)}function _(e,t){return e.getTime()===t.getTime()}function t(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),11<e.month&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e}function a(e,t,n){for(t+=e.firstDay;7<=t;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]}function H(e,t){return'<table cellpadding="0" cellspacing="0" class="pika-table">'+function(e){var t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;t<7;t++)n.push('<th scope="col"><abbr title="'+a(e,t)+'">'+a(e,t,!0)+"</abbr></th>");return"<thead>"+(e.isRTL?n.reverse():n).join("")+"</thead>"}(e)+("<tbody>"+t.join("")+"</tbody>")+"</table>"}function e(e){var o=this,r=o.config(e);o._onMouseDown=function(e){if(o._v){var t=(e=e||window.event).target||e.srcElement;if(t){if(!s(t,"is-disabled")){if(s(t,"pika-button")&&!s(t,"is-empty"))return o.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),void(r.bound&&c(function(){o.hide(),r.field&&r.field.blur()},100));s(t,"pika-prev")?o.prevMonth():s(t,"pika-next")&&o.nextMonth()}if(s(t,"pika-select"))o._c=!0;else{if(!e.preventDefault)return e.returnValue=!1;e.preventDefault()}}}},o._onChange=function(e){var t=(e=e||window.event).target||e.srcElement;t&&(s(t,"pika-select-month")?o.gotoMonth(t.value):s(t,"pika-select-year")&&o.gotoYear(t.value))},o._onInputChange=function(e){var t;e.firedBy!==o&&(t=l?(t=n(r.field.value,r.format))&&t.isValid()?t.toDate():null:new Date(Date.parse(r.field.value)),o.setDate(E(t)?t:null),o._v||o.show())},o._onInputFocus=function(){o.show()},o._onInputClick=function(){o.show()},o._onInputBlur=function(){var e=d.activeElement;do{if(s(e,"pika-single"))return}while(e=e.parentNode);o._c||(o._b=c(function(){o.hide()},50)),o._c=!1},o._onClick=function(e){var t=(e=e||window.event).target||e.srcElement,n=t;if(t){!u&&s(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),i(t,"change",o._onChange)));do{if(s(n,"pika-single")||n===r.trigger)return}while(n=n.parentNode);o._v&&t!==r.trigger&&n!==r.trigger&&o.hide()}},o.el=d.createElement("div"),o.el.className="pika-single"+(r.isRTL?" is-rtl":""),i(o.el,"mousedown",o._onMouseDown,!0),i(o.el,"change",o._onChange),r.field&&(r.container?r.container.appendChild(o.el):r.bound?d.body.appendChild(o.el):r.field.parentNode.insertBefore(o.el,r.field.nextSibling),i(r.field,"change",o._onInputChange),r.defaultDate||(l&&r.field.value?r.defaultDate=n(r.field.value,r.format).toDate():r.defaultDate=new Date(Date.parse(r.field.value)),r.setDefaultDate=!0));var t=r.defaultDate;E(t)?r.setDefaultDate?o.setDate(t,!0):o.gotoDate(t):o.gotoDate(new Date),r.bound?(this.hide(),o.el.className+=" is-bound",i(r.trigger,"click",o._onInputClick),i(r.trigger,"focus",o._onInputFocus),i(r.trigger,"blur",o._onInputBlur)):this.show()}var l="function"==typeof n,u=!!window.addEventListener,d=window.document,c=window.setTimeout,h=function(e,t,n){var o,r;for(o in t)(r=void 0!==e[o])&&"object"==typeof t[o]&&null!==t[o]&&void 0===t[o].nodeName?E(t[o])?n&&(e[o]=new Date(t[o].getTime())):m(t[o])?n&&(e[o]=t[o].slice(0)):e[o]=h({},t[o],n):!n&&r||(e[o]=t[o]);return e},f={field:null,bound:void 0,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},onSelect:null,onOpen:null,onClose:null,onDraw:null};return e.prototype={config:function(e){this._o||(this._o=h({},f,!0));var t=h(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"==typeof t.disableDayFn?t.disableDayFn:null;var n,o=parseInt(t.numberOfMonths,10)||1;return t.numberOfMonths=4<o?4:o,E(t.minDate)||(t.minDate=!1),E(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&(T(t.minDate),t.minYear=t.minDate.getFullYear(),t.minMonth=t.minDate.getMonth()),t.maxDate&&(T(t.maxDate),t.maxYear=t.maxDate.getFullYear(),t.maxMonth=t.maxDate.getMonth()),m(t.yearRange)?(n=(new Date).getFullYear()-10,t.yearRange[0]=parseInt(t.yearRange[0],10)||n,t.yearRange[1]=parseInt(t.yearRange[1],10)||n):(t.yearRange=Math.abs(parseInt(t.yearRange,10))||f.yearRange,100<t.yearRange&&(t.yearRange=100)),t},toString:function(e){return E(this._d)?l?n(this._d).format(e||this._o.format):this._d.toDateString():""},getMoment:function(){return l?n(this._d):null},setMoment:function(e,t){l&&n.isMoment(e)&&this.setDate(e.toDate(),t)},getDate:function(){return E(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",r(this._o.field,"change",{firedBy:this})),this.draw();var n,o;"string"==typeof e&&(e=new Date(Date.parse(e))),E(e)&&(n=this._o.minDate,o=this._o.maxDate,E(n)&&e<n?e=n:E(o)&&o<e&&(e=o),this._d=new Date(e.getTime()),T(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),r(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate()))},gotoDate:function(e){var t,n,o,r=!0;E(e)&&(this.calendars&&(t=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=e.getTime(),n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1),r=o<t.getTime()||n.getTime()<o),r&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars())},adjustCalendars:function(){this.calendars[0]=t(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=t({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){this._o.minDate=e},setMaxDate:function(e){this._o.maxDate=e},draw:function(e){if(this._v||e){var t=this._o,n=t.minYear,o=t.maxYear,r=t.minMonth,i=t.maxMonth,s="";this._y<=n&&(this._y=n,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=o&&(this._y=o,!isNaN(i)&&this._m>i&&(this._m=i));for(var a,l=0;l<t.numberOfMonths;l++)s+='<div class="pika-lendar">'+function(e,t,n,o,r){for(var i,s,a,l=e._o,u=n===l.minYear,d=n===l.maxYear,c='<div class="pika-title">',h=!0,f=!0,p=[],g=0;g<12;g++)p.push('<option value="'+(n===r?g-t:12+g-t)+'"'+(g===o?" selected":"")+(u&&g<l.minMonth||d&&g>l.maxMonth?"disabled":"")+">"+l.i18n.months[g]+"</option>");for(s='<div class="pika-label">'+l.i18n.months[o]+'<select class="pika-select pika-select-month">'+p.join("")+"</select></div>",i=m(l.yearRange)?(g=l.yearRange[0],l.yearRange[1]+1):(g=n-l.yearRange,1+n+l.yearRange),p=[];g<i&&g<=l.maxYear;g++)g>=l.minYear&&p.push('<option value="'+g+'"'+(g===n?" selected":"")+">"+g+"</option>");return a='<div class="pika-label">'+n+l.yearSuffix+'<select class="pika-select pika-select-year">'+p.join("")+"</select></div>",l.showMonthAfterYear?c+=a+s:c+=s+a,u&&(0===o||l.minMonth>=o)&&(h=!1),d&&(11===o||l.maxMonth<=o)&&(f=!1),0===t&&(c+='<button class="pika-prev'+(h?"":" is-disabled")+'" type="button">'+l.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(c+='<button class="pika-next'+(f?"":" is-disabled")+'" type="button">'+l.i18n.nextMonth+"</button>"),c+"</div>"}(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year)+this.render(this.calendars[l].year,this.calendars[l].month)+"</div>";this.el.innerHTML=s,t.bound&&"hidden"!==t.field.type&&c(function(){t.trigger.focus()},1),"function"==typeof this._o.onDraw&&(a=this,c(function(){a._o.onDraw.call(a)},0))}},adjustPosition:function(){if(!this._o.container){var e,t,n,o=this._o.trigger,r=o,i=this.el.offsetWidth,s=this.el.offsetHeight,a=window.innerWidth||d.documentElement.clientWidth,l=window.innerHeight||d.documentElement.clientHeight,u=window.pageYOffset||d.body.scrollTop||d.documentElement.scrollTop;if("function"==typeof o.getBoundingClientRect)e=(n=o.getBoundingClientRect()).left+window.pageXOffset,t=n.bottom+window.pageYOffset;else for(e=r.offsetLeft,t=r.offsetTop+r.offsetHeight;r=r.offsetParent;)e+=r.offsetLeft,t+=r.offsetTop;(this._o.reposition&&a<e+i||-1<this._o.position.indexOf("right")&&0<e-i+o.offsetWidth)&&(e=e-i+o.offsetWidth),(this._o.reposition&&l+u<t+s||-1<this._o.position.indexOf("top")&&0<t-s-o.offsetHeight)&&(t=t-s-o.offsetHeight),this.el.style.cssText=["position: absolute","left: "+e+"px","top: "+t+"px"].join(";")}},render:function(e,t){var n,o=this._o,r=new Date,i=[31,(n=e)%4==0&&n%100!=0||n%400==0?29:28,31,30,31,30,31,31,30,31,30,31][t],s=new Date(e,t,1).getDay(),a=[],l=[];T(r),0<o.firstDay&&(s-=o.firstDay)<0&&(s+=7);for(var u=i+s,d=u;7<d;)d-=7;u+=7-d;for(var c,h,f,p,g,m,w=0,v=0;w<u;w++){var y=new Date(e,t,w-s+1),b=!!E(this._d)&&_(y,this._d),C=_(y,r),R=w<s||i+s<=w,S=o.minDate&&y<o.minDate||o.maxDate&&y>o.maxDate||o.disableWeekends&&(0===(m=y.getDay())||6===m)||o.disableDayFn&&o.disableDayFn(y);l.push(function(e,t,n,o,r,i,s){if(s)return'<td class="is-empty"></td>';var a=[];return i&&a.push("is-disabled"),r&&a.push("is-today"),o&&a.push("is-selected"),'<td data-day="'+e+'" class="'+a.join(" ")+'"><button class="pika-button pika-day" type="button" data-pika-year="'+n+'" data-pika-month="'+t+'" data-pika-day="'+e+'">'+e+"</button></td>"}(w-s+1,t,e,b,C,S,R)),7==++v&&(o.showWeekNumber&&l.unshift((h=w-s,f=t,p=e,g=void 0,g=new Date(p,0,1),'<td class="pika-week">'+Math.ceil(((new Date(p,f,h)-g)/864e5+g.getDay()+1)/7)+"</td>")),a.push((c=l,"<tr>"+(o.isRTL?c.reverse():c).join("")+"</tr>")),l=[],v=0)}return H(o,a)},isVisible:function(){return this._v},show:function(){var e,t,n;this._v||(e=this.el,t="is-hidden",e.className=(n=(" "+e.className+" ").replace(" "+t+" "," ")).trim?n.trim():n.replace(/^\s+|\s+$/g,""),this._v=!0,this.draw(),this._o.bound&&(i(d,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e,t,n=this._v;!1!==n&&(this._o.bound&&o(d,"click",this._onClick),this.el.style.cssText="",e=this.el,s(e,t="is-hidden")||(e.className=""===e.className?t:e.className+" "+t),this._v=!1,void 0!==n&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){this.hide(),o(this.el,"mousedown",this._onMouseDown,!0),o(this.el,"change",this._onChange),this._o.field&&(o(this._o.field,"change",this._onInputChange),this._o.bound&&(o(this._o.trigger,"click",this._onInputClick),o(this._o.trigger,"focus",this._onInputFocus),o(this._o.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},e})},{moment:"moment"}],zeroclipboard:[function(e,Ae,t){!function(s,w){"use strict";function a(e){return D.call(e,0)}function v(){for(var e,t,n,o=a(arguments),r=o[0]||{},i=1,s=o.length;i<s;i++)if(null!=(e=o[i]))for(t in e)O.call(e,t)&&(r[t],r!==(n=e[t])&&n!==w&&(r[t]=n));return r}function d(e,t){if(e&&1===e.nodeType&&e.ownerDocument&&t&&(1===t.nodeType&&t.ownerDocument&&t.ownerDocument===e.ownerDocument||9===t.nodeType&&!t.ownerDocument&&t===e.ownerDocument))do{if(e===t)return 1;e=e.parentNode}while(e)}function r(e){var t;return"string"==typeof e&&e&&(t=e.split("#")[0].split("?")[0],t=e.slice(0,e.lastIndexOf("/")+1)),t}function e(){var e,t,n;if(b.currentScript&&(e=b.currentScript.src))return e;if(1===(t=b.getElementsByTagName("script")).length)return t[0].src||w;if("readyState"in t[0])for(n=t.length;n--;)if("interactive"===t[n].readyState&&(e=t[n].src))return e;return"loading"===b.readyState&&(e=t[t.length-1].src)||(e=function(){var e,t,n,o,r;try{throw new S}catch(e){t=e}return t&&(e=t.sourceURL||t.fileName||("string"==typeof(n=t.stack)&&n&&((r=n.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/))&&r[1]||(r=n.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/))&&r[1])&&(o=r[1]),o)),e}())?e:w}function t(e){void 0===e?(function(e){if(e)for(var t in e)O.call(e,t)&&delete e[t]}(N),W=null):"string"==typeof e&&O.call(N,e)&&delete N[e]}function c(e){var t=e&&"string"==typeof e.type&&e.type||"";return!/^(?:(?:before)?copy|destroy)$/.test(t)}function h(e,t,n,o){o?i(function(){e.apply(t,n)},0):e.apply(t,n)}var f,p,g,y=s,b=y.document,u=y.navigator,i=y.setTimeout,n=y.clearTimeout,m=y.setInterval,o=y.clearInterval,l=y.getComputedStyle,C=y.encodeURIComponent,R=y.ActiveXObject,S=y.Error,E=y.Number.parseInt||y.parseInt,T=y.Number.parseFloat||y.parseFloat,_=y.Number.isNaN||y.isNaN,H=y.Date.now,k=y.Object.keys,M=y.Object.defineProperty,O=y.Object.prototype.hasOwnProperty,D=y.Array.prototype.slice,x=function(){var e=function(e){return e};if("function"==typeof y.wrap&&"function"==typeof y.unwrap)try{var t=b.createElement("div"),n=y.unwrap(t);1===t.nodeType&&n&&1===n.nodeType&&(e=y.unwrap)}catch(e){}return e}(),A=function(e){var t,n,o,r;if("object"!=typeof e||null==e||"number"==typeof e.nodeType)t=e;else if("number"==typeof e.length)for(t=[],n=0,o=e.length;n<o;n++)O.call(e,n)&&(t[n]=A(e[n]));else for(r in t={},e)O.call(e,r)&&(t[r]=A(e[r]));return t},j=null==s.opener&&(!!s.top&&s!=s.top||!!s.parent&&s!=s.parent),P={bridge:null,version:"0.0.0",pluginType:"unknown",disabled:null,outdated:null,sandboxed:null,unavailable:null,degraded:null,deactivated:null,overdue:null,ready:null},L={},N={},W=null,I=0,B=0,V={ready:"Flash communication is established",error:{"flash-disabled":"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-sandboxed":"Attempting to run Flash in a sandboxed iframe, which is impossible","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-degraded":"Flash is unable to preserve data fidelity when communicating with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-overdue":"Flash communication was established but NOT within the acceptable time limit","version-mismatch":"ZeroClipboard JS version number does not match ZeroClipboard SWF version number","clipboard-error":"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard","config-mismatch":"ZeroClipboard configuration does not match Flash's reality","swf-not-found":"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity"}},F=["flash-unavailable","flash-degraded","flash-overdue","version-mismatch","config-mismatch","clipboard-error"],Y=["flash-disabled","flash-outdated","flash-sandboxed","flash-unavailable","flash-degraded","flash-deactivated","flash-overdue"],G=new RegExp("^flash-("+Y.map(function(e){return e.replace(/^flash-/,"")}).join("|")+")$"),z=new RegExp("^flash-("+Y.slice(1).map(function(e){return e.replace(/^flash-/,"")}).join("|")+")$"),U={swfPath:(r(e())||function(){for(var e,t,n=b.getElementsByTagName("script"),o=n.length;o--;){if(!(t=n[o].src)){e=null;break}if(t=r(t),null==e)e=t;else if(e!==t){e=null;break}}return e||w}()||"")+"ZeroClipboard.swf",trustedDomains:s.location.host?[s.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},$=function(e){return"string"==typeof e&&e&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(e)},X=function(e){var t;if("string"==typeof e&&e?(t=e,e={}):"object"==typeof e&&e&&"string"==typeof e.type&&e.type&&(t=e.type),t){t=t.toLowerCase(),!e.target&&(/^(copy|aftercopy|_click)$/.test(t)||"error"===t&&"clipboard-error"===e.name)&&(e.target=g),v(e,{type:t,target:e.target||p||null,relatedTarget:e.relatedTarget||null,currentTarget:P&&P.bridge||null,timeStamp:e.timeStamp||H()||null});var n=V[e.type];return"error"===e.type&&e.name&&n&&(n=n[e.name]),n&&(e.message=n),"ready"===e.type&&v(e,{target:null,version:P.version}),"error"===e.type&&(G.test(e.name)&&v(e,{target:null,minimumVersion:"11.0.0"}),z.test(e.name)&&v(e,{version:P.version})),"copy"===e.type&&(e.clipboardData={setData:Re.setData,clearData:Re.clearData}),"aftercopy"===e.type&&(e=ie(e,W)),e.target&&!e.relatedTarget&&(e.relatedTarget=K(e.target)),q(e)}},K=function(e){var t=e&&e.getAttribute&&e.getAttribute("data-clipboard-target");return t?b.getElementById(t):null},q=function(e){var t,n,o,r,i,s,a,l,u,d,c,h,f,p,g,m;return e&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)&&(t=e.target,n="_mouseover"===e.type&&e.relatedTarget?e.relatedTarget:w,o="_mouseout"===e.type&&e.relatedTarget?e.relatedTarget:w,r=pe(t),i=y.screenLeft||y.screenX||0,s=y.screenTop||y.screenY||0,a=b.body.scrollLeft+b.documentElement.scrollLeft,l=b.body.scrollTop+b.documentElement.scrollTop,f=i+(c=(u=r.left+("number"==typeof e._stageX?e._stageX:0))-a),p=s+(h=(d=r.top+("number"==typeof e._stageY?e._stageY:0))-l),g="number"==typeof e.movementX?e.movementX:0,m="number"==typeof e.movementY?e.movementY:0,delete e._stageX,delete e._stageY,v(e,{srcElement:t,fromElement:n,toElement:o,screenX:f,screenY:p,pageX:u,pageY:d,clientX:c,clientY:h,x:c,y:h,movementX:g,movementY:m,offsetX:0,offsetY:0,layerX:0,layerY:0})),e},Z=function(e){if("object"==typeof e&&e&&e.type){var t=c(e),n=L["*"]||[],o=L[e.type]||[],r=n.concat(o);if(r&&r.length)for(var i,s,a,l=0,u=r.length;l<u;l++)s=this,"string"==typeof(i=r[l])&&"function"==typeof y[i]&&(i=y[i]),"object"==typeof i&&i&&"function"==typeof i.handleEvent&&(i=(s=i).handleEvent),"function"==typeof i&&(a=v({},e),h(i,s,[a],t));return this}},J=function(e){var t,n,o=e.target||p||null,r="swf"===e._source;switch(delete e._source,e.type){case"error":var i="flash-sandboxed"===e.name||(t=e,n=null,(0==j||t&&"error"===t.type&&t.name&&-1!==F.indexOf(t.name))&&(n=!1),n);"boolean"==typeof i&&(P.sandboxed=i),-1!==Y.indexOf(e.name)?v(P,{disabled:"flash-disabled"===e.name,outdated:"flash-outdated"===e.name,unavailable:"flash-unavailable"===e.name,degraded:"flash-degraded"===e.name,deactivated:"flash-deactivated"===e.name,overdue:"flash-overdue"===e.name,ready:!1}):"version-mismatch"===e.name&&(f=e.swfVersion,v(P,{disabled:!1,outdated:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1})),me();break;case"ready":f=e.swfVersion;var s=!0===P.deactivated;v(P,{disabled:!1,outdated:!1,sandboxed:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:s,ready:!s}),me();break;case"beforecopy":g=o;break;case"copy":var a,l,u=e.relatedTarget;!N["text/html"]&&!N["text/plain"]&&u&&(l=u.value||u.outerHTML||u.innerHTML)&&(a=u.value||u.textContent||u.innerText)?(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",a),l!==a&&e.clipboardData.setData("text/html",l)):!N["text/plain"]&&e.target&&(a=e.target.getAttribute("data-clipboard-text"))&&(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",a));break;case"aftercopy":Q(e),Re.clearData(),o&&o!==de()&&o.focus&&o.focus();break;case"_mouseover":Re.focus(o),!0===U.bubbleEvents&&r&&(o&&o!==e.relatedTarget&&!d(e.relatedTarget,o)&&ee(v({},e,{type:"mouseenter",bubbles:!1,cancelable:!1})),ee(v({},e,{type:"mouseover"})));break;case"_mouseout":Re.blur(),!0===U.bubbleEvents&&r&&(o&&o!==e.relatedTarget&&!d(e.relatedTarget,o)&&ee(v({},e,{type:"mouseleave",bubbles:!1,cancelable:!1})),ee(v({},e,{type:"mouseout"})));break;case"_mousedown":ce(o,U.activeClass),!0===U.bubbleEvents&&r&&ee(v({},e,{type:e.type.slice(1)}));break;case"_mouseup":he(o,U.activeClass),!0===U.bubbleEvents&&r&&ee(v({},e,{type:e.type.slice(1)}));break;case"_click":!(g=null)===U.bubbleEvents&&r&&ee(v({},e,{type:e.type.slice(1)}));break;case"_mousemove":!0===U.bubbleEvents&&r&&ee(v({},e,{type:e.type.slice(1)}))}if(/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type))return!0},Q=function(e){var t;e.errors&&0<e.errors.length&&(t=A(e),v(t,{type:"error",name:"clipboard-error"}),delete t.success,i(function(){Re.emit(t)},0))},ee=function(e){var t,n,o,r,i;e&&"string"==typeof e.type&&e&&(r={view:(o=(n=e.target||null)&&n.ownerDocument||b).defaultView||y,canBubble:!0,cancelable:!0,detail:"click"===e.type?1:0,button:"number"==typeof e.which?e.which-1:"number"==typeof e.button?e.button:o.createEvent?0:1},i=v(r,e),n&&o.createEvent&&n.dispatchEvent&&(i=[i.type,i.canBubble,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget],(t=o.createEvent("MouseEvents")).initMouseEvent&&(t.initMouseEvent.apply(t,i),t._source="js",n.dispatchEvent(t))))},te=function(e){for(var t=e&&e.parentNode;t&&"OBJECT"===t.nodeName&&t.parentNode;)t=t.parentNode;return t||null},ne=function(){var e,t,n,o,r,i,s,a,l,u,d,c,h=P.bridge,f=te(h);return h||(n="never"===(t=ue(y.location.host,U))?"none":"all",o=ae(v({jsVersion:Re.version},U)),r=U.swfPath+se(U.swfPath,U),(c=b.createElement("div")).id=U.containerId,c.className=U.containerClass,c.style.position="absolute",c.style.left="0px",c.style.top="-9999px",c.style.width="1px",c.style.height="1px",c.style.zIndex=""+ye(U.zIndex),f=c,i=b.createElement("div"),f.appendChild(i),b.body.appendChild(f),s=b.createElement("div"),a="activex"===P.pluginType,s.innerHTML='<object id="'+U.swfObjectId+'" name="'+U.swfObjectId+'" width="100%" height="100%" '+(a?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+r+'"')+">"+(a?'<param name="movie" value="'+r+'"/>':"")+'<param name="allowScriptAccess" value="'+t+'"/><param name="allowNetworking" value="'+n+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+o+'"/><div id="'+U.swfObjectId+'_fallbackContent">&nbsp;</div></object>',h=s.firstChild,s=null,x(h).ZeroClipboard=Re,f.replaceChild(h,i),"number"==typeof(d=U.flashLoadTimeout)&&0<=d&&(l=Math.min(1e3,d/10),u=U.swfObjectId+"_fallbackContent",B=m(function(){var e=b.getElementById(u);ge(e)&&(me(),P.deactivated=null,Re.emit({type:"error",name:"swf-not-found"}))},l))),h||((h=b[U.swfObjectId])&&(e=h.length)&&(h=h[e-1]),!h&&f&&(h=f.firstChild)),P.bridge=h||null,h},oe=function(){var n,o=P.bridge;o&&((n=te(o))&&("activex"===P.pluginType&&"readyState"in o?(o.style.display="none",function e(){if(4===o.readyState){for(var t in o)"function"==typeof o[t]&&(o[t]=null);o.parentNode&&o.parentNode.removeChild(o),n.parentNode&&n.parentNode.removeChild(n)}else i(e,10)}()):(o.parentNode&&o.parentNode.removeChild(o),n.parentNode&&n.parentNode.removeChild(n))),me(),P.ready=null,P.bridge=null,P.deactivated=null,f=w)},re=function(e){var t={},n={};if("object"==typeof e&&e){for(var o in e)if(o&&O.call(e,o)&&"string"==typeof e[o]&&e[o])switch(o.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":t.text=e[o],n.text=o;break;case"text/html":case"html":case"air:html":case"flash:html":t.html=e[o],n.html=o;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":t.rtf=e[o],n.rtf=o}return{data:t,formatMap:n}}},ie=function(e,t){if("object"!=typeof e||!e||"object"!=typeof t||!t)return e;var n={};for(var o in e)if(O.call(e,o))if("errors"===o){n[o]=e[o]?e[o].slice():[];for(var r=0,i=n[o].length;r<i;r++)n[o][r].format=t[n[o][r].format]}else if("success"!==o&&"data"!==o)n[o]=e[o];else{n[o]={};var s=e[o];for(var a in s)a&&O.call(s,a)&&O.call(t,a)&&(n[o][t[a]]=s[a])}return n},se=function(e,t){return null==t||t&&!0===t.cacheBust?(-1===e.indexOf("?")?"?":"&")+"noCache="+H():""},ae=function(e){var t,n,o,r,i="",s=[];if(e.trustedDomains&&("string"==typeof e.trustedDomains?r=[e.trustedDomains]:"object"==typeof e.trustedDomains&&"length"in e.trustedDomains&&(r=e.trustedDomains)),r&&r.length)for(t=0,n=r.length;t<n;t++)if(O.call(r,t)&&r[t]&&"string"==typeof r[t]){if(!(o=le(r[t])))continue;if("*"===o){s.length=0,s.push(o);break}s.push.apply(s,[o,"//"+o,y.location.protocol+"//"+o])}return s.length&&(i+="trustedOrigins="+C(s.join(","))),!0===e.forceEnhancedClipboard&&(i+=(i?"&":"")+"forceEnhancedClipboard=true"),"string"==typeof e.swfObjectId&&e.swfObjectId&&(i+=(i?"&":"")+"swfObjectId="+C(e.swfObjectId)),"string"==typeof e.jsVersion&&e.jsVersion&&(i+=(i?"&":"")+"jsVersion="+C(e.jsVersion)),i},le=function(e){if(null==e||""===e)return null;if(""===(e=e.replace(/^\s+|\s+$/g,"")))return null;var t=e.indexOf("//"),n=(e=-1===t?e:e.slice(t+2)).indexOf("/");return(!(e=-1===n?e:-1===t||0===n?null:e.slice(0,n))||".swf"!==e.slice(-4).toLowerCase())&&e||null},ue=function(e,t){var n=le(t.swfPath);null===n&&(n=e);var o=function(e){var t,n,o,r=[];if("string"==typeof e&&(e=[e]),"object"!=typeof e||!e||"number"!=typeof e.length)return r;for(t=0,n=e.length;t<n;t++)if(O.call(e,t)&&(o=le(e[t]))){if("*"===o){r.length=0,r.push("*");break}-1===r.indexOf(o)&&r.push(o)}return r}(t.trustedDomains),r=o.length;if(0<r){if(1===r&&"*"===o[0])return"always";if(-1!==o.indexOf(e))return 1===r&&e===n?"sameDomain":"always"}return"never"},de=function(){try{return b.activeElement}catch(e){return null}},ce=function(e,t){var n,o,r,i=[];if("string"==typeof t&&t&&(i=t.split(/\s+/)),e&&1===e.nodeType&&0<i.length)if(e.classList)for(n=0,o=i.length;n<o;n++)e.classList.add(i[n]);else if(e.hasOwnProperty("className")){for(r=" "+e.className+" ",n=0,o=i.length;n<o;n++)-1===r.indexOf(" "+i[n]+" ")&&(r+=i[n]+" ");e.className=r.replace(/^\s+|\s+$/g,"")}return e},he=function(e,t){var n,o,r,i=[];if("string"==typeof t&&t&&(i=t.split(/\s+/)),e&&1===e.nodeType&&0<i.length)if(e.classList&&0<e.classList.length)for(n=0,o=i.length;n<o;n++)e.classList.remove(i[n]);else if(e.className){for(r=(" "+e.className+" ").replace(/[\r\n\t]/g," "),n=0,o=i.length;n<o;n++)r=r.replace(" "+i[n]+" "," ");e.className=r.replace(/^\s+|\s+$/g,"")}return e},fe=function(e,t){var n=l(e,null).getPropertyValue(t);return"cursor"!==t||n&&"auto"!==n||"A"!==e.nodeName?n:"pointer"},pe=function(e){var t,n,o,r,i,s,a,l,u,d={left:0,top:0,width:0,height:0};return e.getBoundingClientRect&&(t=e.getBoundingClientRect(),n=y.pageXOffset,o=y.pageYOffset,r=b.documentElement.clientLeft||0,i=b.documentElement.clientTop||0,u=l=0,"relative"===fe(b.body,"position")&&(s=b.body.getBoundingClientRect(),a=b.documentElement.getBoundingClientRect(),l=s.left-a.left||0,u=s.top-a.top||0),d.left=t.left+n-r-l,d.top=t.top+o-i-u,d.width="width"in t?t.width:t.right-t.left,d.height="height"in t?t.height:t.bottom-t.top),d},ge=function(e){if(!e)return!1;var t=l(e,null),n=0<T(t.height),o=0<T(t.width),r=0<=T(t.top),i=0<=T(t.left),s=n&&o&&r&&i,a=s?null:pe(e);return"none"!==t.display&&"collapse"!==t.visibility&&(s||!!a&&(n||0<a.height)&&(o||0<a.width)&&(r||0<=a.top)&&(i||0<=a.left))},me=function(){n(I),I=0,o(B),B=0},we=function(){var e,t;p&&(e=te(P.bridge))&&(t=pe(p),v(e.style,{width:t.width+"px",height:t.height+"px",top:t.top+"px",left:t.left+"px",zIndex:""+ye(U.zIndex)}))},ve=function(e){!0===P.ready&&(P.bridge&&"function"==typeof P.bridge.setHandCursor?P.bridge.setHandCursor(e):P.ready=!1)},ye=function(e){return/^(?:auto|inherit)$/.test(e)?e:("number"!=typeof e||_(e)?"string"==typeof e&&(t=ye(E(e,10))):t=e,"number"==typeof t?t:"auto");var t},be=function(e){var t,n,o,r=P.sandboxed,i=null;if(e=!0===e,!1==j)i=!1;else{try{n=s.frameElement||null}catch(e){o={name:e.name,message:e.message}}if(n&&1===n.nodeType&&"IFRAME"===n.nodeName)try{i=n.hasAttribute("sandbox")}catch(e){i=null}else{try{t=document.domain||null}catch(e){t=null}(null===t||o&&"SecurityError"===o.name&&/(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(o.message.toLowerCase()))&&(i=!0)}}return r===(P.sandboxed=i)||e||Ce(R),i},Ce=function(t){var n,e,o=!1,r=!1,i=!1,s="";function a(e){var t=e.match(/[\d]+/g);return t.length=3,t.join(".")}function l(e){var t;e&&(o=!0,e.version&&(s=a(e.version)),!s&&e.description&&(s=a(e.description)),e.filename&&(t=e.filename,i=!!t&&(t=t.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(t)||"chrome.plugin"===t.slice(-13))))}if(u.plugins&&u.plugins.length)l(u.plugins["Shockwave Flash"]),u.plugins["Shockwave Flash 2.0"]&&(o=!0,s="2.0.0.11");else if(u.mimeTypes&&u.mimeTypes.length)l((e=u.mimeTypes["application/x-shockwave-flash"])&&e.enabledPlugin);else if(void 0!==t){r=!0;try{n=new t("ShockwaveFlash.ShockwaveFlash.7"),o=!0,s=a(n.GetVariable("$version"))}catch(e){try{n=new t("ShockwaveFlash.ShockwaveFlash.6"),o=!0,s="6.0.21"}catch(e){try{n=new t("ShockwaveFlash.ShockwaveFlash"),o=!0,s=a(n.GetVariable("$version"))}catch(e){r=!1}}}}P.disabled=!0!==o,P.outdated=s&&T(s)<T("11.0.0"),P.version=s||"0.0.0",P.pluginType=i?"pepper":r?"activex":o?"netscape":"unknown"};Ce(R),be(!0);var Re=function(){if(!(this instanceof Re))return new Re;"function"==typeof Re._createClient&&Re._createClient.apply(this,a(arguments))};M(Re,"version",{value:"2.2.0",writable:!1,configurable:!0,enumerable:!0}),Re.config=function(){return function(e){if("object"==typeof e&&null!==e)for(var t in e)if(O.call(e,t))if(/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(t))U[t]=e[t];else if(null==P.bridge)if("containerId"===t||"swfObjectId"===t){if(!$(e[t]))throw new Error("The specified `"+t+"` value is not valid as an HTML4 Element ID");U[t]=e[t]}else U[t]=e[t];return"string"==typeof e&&e?O.call(U,e)?U[e]:void 0:A(U)}.apply(this,a(arguments))},Re.state=function(){return function(){return be(),{browser:function(e,t){for(var n={},o=0,r=t.length;o<r;o++)t[o]in e&&(n[t[o]]=e[t[o]]);return n}(u,["userAgent","platform","appName"]),flash:function(e,t){var n={};for(var o in e)-1===t.indexOf(o)&&(n[o]=e[o]);return n}(P,["bridge"]),zeroclipboard:{version:Re.version,config:Re.config()}}}.apply(this,a(arguments))},Re.isFlashUnusable=function(){return function(){return!!(P.disabled||P.outdated||P.sandboxed||P.unavailable||P.degraded||P.deactivated)}.apply(this,a(arguments))},Re.on=function(){return function(e,t){var n,o,r,i={};if("string"==typeof e&&e)r=e.toLowerCase().split(/\s+/);else if("object"==typeof e&&e&&void 0===t)for(n in e)O.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&Re.on(n,e[n]);if(r&&r.length){for(n=0,o=r.length;n<o;n++)i[e=r[n].replace(/^on/,"")]=!0,L[e]||(L[e]=[]),L[e].push(t);if(i.ready&&P.ready&&Re.emit({type:"ready"}),i.error){for(n=0,o=Y.length;n<o;n++)if(!0===P[Y[n].replace(/^flash-/,"")]){Re.emit({type:"error",name:Y[n]});break}f!==w&&Re.version!==f&&Re.emit({type:"error",name:"version-mismatch",jsVersion:Re.version,swfVersion:f})}}return Re}.apply(this,a(arguments))},Re.off=function(){return function(e,t){var n,o,r,i,s;if(0===arguments.length)i=k(L);else if("string"==typeof e&&e)i=e.split(/\s+/);else if("object"==typeof e&&e&&void 0===t)for(n in e)O.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&Re.off(n,e[n]);if(i&&i.length)for(n=0,o=i.length;n<o;n++)if(e=i[n].toLowerCase().replace(/^on/,""),(s=L[e])&&s.length)if(t)for(r=s.indexOf(t);-1!==r;)s.splice(r,1),r=s.indexOf(t,r);else s.length=0;return Re}.apply(this,a(arguments))},Re.handlers=function(){return function(e){var t="string"==typeof e&&e?A(L[e])||null:A(L);return t}.apply(this,a(arguments))},Re.emit=function(){return function(e){var t,n,o;if((e=X(e))&&!J(e))return"ready"===e.type&&!0===P.overdue?Re.emit({type:"error",name:"flash-overdue"}):(t=v({},e),Z.call(this,t),"copy"===e.type&&(n=(o=re(N)).data,W=o.formatMap),n)}.apply(this,a(arguments))},Re.create=function(){return function(){var e,t=P.sandboxed;be(),"boolean"!=typeof P.ready&&(P.ready=!1),P.sandboxed!==t&&!0===P.sandboxed?(P.ready=!1,Re.emit({type:"error",name:"flash-sandboxed"})):Re.isFlashUnusable()||null!==P.bridge||("number"==typeof(e=U.flashLoadTimeout)&&0<=e&&(I=i(function(){"boolean"!=typeof P.deactivated&&(P.deactivated=!0),!0===P.deactivated&&Re.emit({type:"error",name:"flash-deactivated"})},e)),P.overdue=!1,ne())}.apply(this,a(arguments))},Re.destroy=function(){return function(){Re.clearData(),Re.blur(),Re.emit("destroy"),oe(),Re.off()}.apply(this,a(arguments))},Re.setData=function(){return function(e,t){var n;if("object"==typeof e&&e&&void 0===t)n=e,Re.clearData();else{if("string"!=typeof e||!e)return;(n={})[e]=t}for(var o in n)"string"==typeof o&&o&&O.call(n,o)&&"string"==typeof n[o]&&n[o]&&(N[o]=n[o])}.apply(this,a(arguments))},Re.clearData=function(){return t.apply(this,a(arguments))},Re.getData=function(){return function(e){return void 0===e?A(N):"string"==typeof e&&O.call(N,e)?N[e]:void 0}.apply(this,a(arguments))},Re.focus=Re.activate=function(){return function(e){var t,n,o;e&&1===e.nodeType&&(p&&(he(p,U.activeClass),p!==e&&he(p,U.hoverClass)),ce(p=e,U.hoverClass),"string"!=typeof(t=e.getAttribute("title")||U.title)||!t||(n=te(P.bridge))&&n.setAttribute("title",t),o=!0===U.forceHandCursor||"pointer"===fe(e,"cursor"),ve(o),we())}.apply(this,a(arguments))},Re.blur=Re.deactivate=function(){return function(){var e=te(P.bridge);e&&(e.removeAttribute("title"),e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.height="1px"),p&&(he(p,U.hoverClass),he(p,U.activeClass),p=null)}.apply(this,a(arguments))},Re.activeElement=function(){return function(){return p||null}.apply(this,a(arguments))};var Se=0,Ee={},Te=0,_e={},He={};v(U,{autoActivate:!0});var ke=function(e){if(!e||!e.type)return!1;if(e.client&&e.client!==this)return!1;var t=Ee[this.id],n=t&&t.elements,o=!!n&&0<n.length,r=!e.target||o&&-1!==n.indexOf(e.target),i=e.relatedTarget&&o&&-1!==n.indexOf(e.relatedTarget),s=e.client&&e.client===this;return!(!t||!(r||i||s))},Me=function(e){var t=Ee[this.id];if("object"==typeof e&&e&&e.type&&t){var n=c(e),o=t&&t.handlers["*"]||[],r=t&&t.handlers[e.type]||[],i=o.concat(r);if(i&&i.length)for(var s,a,l,u=0,d=i.length;u<d;u++)a=this,"string"==typeof(s=i[u])&&"function"==typeof y[s]&&(s=y[s]),"object"==typeof s&&s&&"function"==typeof s.handleEvent&&(s=(a=s).handleEvent),"function"==typeof s&&(l=v({},e),h(s,a,[l],n))}},Oe=function(e){return"string"==typeof e&&(e=[]),"number"!=typeof e.length?[e]:e},De=function(t){var n,e;t&&1===t.nodeType&&(n=function(e){(e=e||y.event)&&("js"!==e._source&&(e.stopImmediatePropagation(),e.preventDefault()),delete e._source)},e=function(e){(e=e||y.event)&&(n(e),Re.focus(t))},t.addEventListener("mouseover",e,!1),t.addEventListener("mouseout",n,!1),t.addEventListener("mouseenter",n,!1),t.addEventListener("mouseleave",n,!1),t.addEventListener("mousemove",n,!1),He[t.zcClippingId]={mouseover:e,mouseout:n,mouseenter:n,mouseleave:n,mousemove:n})},xe=function(e){if(e&&1===e.nodeType){var t=He[e.zcClippingId];if("object"==typeof t&&t){for(var n,o,r=["move","leave","enter","out","over"],i=0,s=r.length;i<s;i++)"function"==typeof(o=t[n="mouse"+r[i]])&&e.removeEventListener(n,o,!1);delete He[e.zcClippingId]}}};Re._createClient=function(){(function(e){var t=this;t.id=""+Se++,Ee[t.id]={instance:t,elements:[],handlers:{}},e&&t.clip(e),Re.on("*",function(e){return t.emit(e)}),Re.on("destroy",function(){t.destroy()}),Re.create()}).apply(this,a(arguments))},Re.prototype.on=function(){return function(e,t){var n,o,r,i={},s=Ee[this.id],a=s&&s.handlers;if(!s)throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");if("string"==typeof e&&e)r=e.toLowerCase().split(/\s+/);else if("object"==typeof e&&e&&void 0===t)for(n in e)O.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.on(n,e[n]);if(r&&r.length){for(n=0,o=r.length;n<o;n++)i[e=r[n].replace(/^on/,"")]=!0,a[e]||(a[e]=[]),a[e].push(t);if(i.ready&&P.ready&&this.emit({type:"ready",client:this}),i.error){for(n=0,o=Y.length;n<o;n++)if(P[Y[n].replace(/^flash-/,"")]){this.emit({type:"error",name:Y[n],client:this});break}f!==w&&Re.version!==f&&this.emit({type:"error",name:"version-mismatch",jsVersion:Re.version,swfVersion:f})}}return this}.apply(this,a(arguments))},Re.prototype.off=function(){return function(e,t){var n,o,r,i,s,a=Ee[this.id],l=a&&a.handlers;if(!l)return this;if(0===arguments.length)i=k(l);else if("string"==typeof e&&e)i=e.split(/\s+/);else if("object"==typeof e&&e&&void 0===t)for(n in e)O.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.off(n,e[n]);if(i&&i.length)for(n=0,o=i.length;n<o;n++)if((s=l[e=i[n].toLowerCase().replace(/^on/,"")])&&s.length)if(t)for(r=s.indexOf(t);-1!==r;)s.splice(r,1),r=s.indexOf(t,r);else s.length=0;return this}.apply(this,a(arguments))},Re.prototype.handlers=function(){return function(e){var t=null,n=Ee[this.id]&&Ee[this.id].handlers;return n&&(t="string"==typeof e&&e?n[e]?n[e].slice(0):[]:A(n)),t}.apply(this,a(arguments))},Re.prototype.emit=function(){return function(e){var t;return ke.call(this,e)&&("object"==typeof e&&e&&"string"==typeof e.type&&e.type&&(e=v({},e)),t=v({},X(e),{client:this}),Me.call(this,t)),this}.apply(this,a(arguments))},Re.prototype.clip=function(){return function(e){if(!Ee[this.id])throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");e=Oe(e);for(var t,n=0;n<e.length;n++){O.call(e,n)&&e[n]&&1===e[n].nodeType&&(e[n].zcClippingId?-1===_e[e[n].zcClippingId].indexOf(this.id)&&_e[e[n].zcClippingId].push(this.id):(e[n].zcClippingId="zcClippingId_"+Te++,_e[e[n].zcClippingId]=[this.id],!0===U.autoActivate&&De(e[n])),-1===(t=Ee[this.id]&&Ee[this.id].elements).indexOf(e[n])&&t.push(e[n]))}return this}.apply(this,a(arguments))},Re.prototype.unclip=function(){return function(e){var t=Ee[this.id];if(!t)return this;for(var n,o=t.elements,r=(e=void 0===e?o.slice(0):Oe(e)).length;r--;)if(O.call(e,r)&&e[r]&&1===e[r].nodeType){for(n=0;-1!==(n=o.indexOf(e[r],n));)o.splice(n,1);var i=_e[e[r].zcClippingId];if(i){for(n=0;-1!==(n=i.indexOf(this.id,n));)i.splice(n,1);0===i.length&&(!0===U.autoActivate&&xe(e[r]),delete e[r].zcClippingId)}}return this}.apply(this,a(arguments))},Re.prototype.elements=function(){return function(){var e=Ee[this.id];return e&&e.elements?e.elements.slice(0):[]}.apply(this,a(arguments))},Re.prototype.destroy=function(){return function(){Ee[this.id]&&(this.unclip(),this.off(),delete Ee[this.id])}.apply(this,a(arguments))},Re.prototype.setText=function(e){if(!Ee[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Re.setData("text/plain",e),this},Re.prototype.setHtml=function(e){if(!Ee[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Re.setData("text/html",e),this},Re.prototype.setRichText=function(e){if(!Ee[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Re.setData("application/rtf",e),this},Re.prototype.setData=function(){if(!Ee[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Re.setData.apply(this,a(arguments)),this},Re.prototype.clearData=function(){if(!Ee[this.id])throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");return Re.clearData.apply(this,a(arguments)),this},Re.prototype.getData=function(){if(!Ee[this.id])throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");return Re.getData.apply(this,a(arguments))},"object"==typeof Ae&&Ae&&"object"==typeof Ae.exports&&Ae.exports?Ae.exports=Re:s.ZeroClipboard=Re}(function(){return this||window}())},{}]},{},[23,47,48,49,65,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,66,67,68,69,86,87,88,72,73,74,75,76,77,31,35,32,33,40,34,36,37,38,39]),Handsontable});